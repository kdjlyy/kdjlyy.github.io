[{"content":"","permalink":"https://kdjlyy.cn/posts/site/hugo_shortcodes/","summary":"","title":"Hugoåšå®¢shortcodesä½¿ç”¨"},{"content":"å‡†å¤‡å·¥ä½œ ","permalink":"https://kdjlyy.cn/posts/site/ecs_deploy/","summary":"å‡†å¤‡å·¥ä½œ","title":"Hugoåšå®¢éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨"},{"content":"é…ç½®æ ‡ç­¾é¡µé¢ PaperMod ä¸»é¢˜æ˜¯æ”¯æŒå¤šè¯­è¨€çš„ï¼Œä½†æ˜¯æ ‡ç­¾é¡µä¸æ”¯æŒï¼Œéœ€è¦ä¿®æ”¹å¯¹åº”çš„ html æ¨¡æ¿ã€‚\nä¸»é¢˜æä¾›çš„è¯­è¨€æ”¯æŒæ–‡ä»¶åœ¨themes/PaperMod/il8né‡Œé¢ï¼Œå…¶ä¸­zh.yamlå³ç®€ä½“ä¸­æ–‡ã€‚\nä¸ºäº†é˜²æ­¢æ›´æ–°ä¸»é¢˜æ—¶è¿˜åŸä¿®æ”¹è¿‡çš„æ–‡ä»¶ï¼Œéœ€è¦åœ¨ç½‘ç«™æ ¹ç›®å½•è¿›è¡Œä¿®æ”¹ï¼Œè¿™æ ·å¯ä»¥è¦†ç›–ä¸»é¢˜åŸæœ‰æ–‡ä»¶çš„æ•ˆæœã€‚åœ¨ç½‘ç«™æ ¹ç›®å½•æ–°å»ºi18n/æ–‡ä»¶å¤¹ï¼Œå¤åˆ¶themes/PaperMod/i18n/zh.yamlåˆ°i18n/zh.yamlï¼Œå¹¶æŒ‰éœ€è®¾ç½®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 - id: prev_page translation: \u0026#34;ä¸Šä¸€é¡µ\u0026#34; - id: next_page translation: \u0026#34;ä¸‹ä¸€é¡µ\u0026#34; - id: read_time translation: one : \u0026#34;1 åˆ†é’Ÿ\u0026#34; other: \u0026#34;{{ .Count }} åˆ†é’Ÿ\u0026#34; - id: words translation: one: \u0026#34;å­—\u0026#34; other: \u0026#34;{{ .Count }} å­—\u0026#34; - id: toc translation: \u0026#34;ç›®å½•\u0026#34; - id: translations translation: \u0026#34;è¯­è¨€\u0026#34; - id: home translation: \u0026#34;ä¸»é¡µ\u0026#34; - id: edit_post translation: \u0026#34;ç¼–è¾‘\u0026#34; - id: code_copy translation: \u0026#34;Copy\u0026#34; - id: code_copied translation: \u0026#34;Done\u0026#34; æ·»åŠ MathJax åˆ›å»ºthemes/PaperMod/layouts/partials/mathjax.htmlï¼Œè¾“å…¥ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 \u0026lt;script type=\u0026#34;text/javascript\u0026#34; async src=\u0026#34;https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML\u0026#34;\u0026gt; MathJax.Hub.Config({ tex2jax: { inlineMath: [[\u0026#39;$\u0026#39;, \u0026#39;$\u0026#39;], [\u0026#39;\\\\(\u0026#39;, \u0026#39;\\\\)\u0026#39;]], displayMath: [[\u0026#39;$$\u0026#39;, \u0026#39;$$\u0026#39;], [\u0026#39;\\[\\[\u0026#39;, \u0026#39;\\]\\]\u0026#39;]], processEscapes: true, processEnvironments: true, skipTags: [\u0026#39;script\u0026#39;, \u0026#39;noscript\u0026#39;, \u0026#39;style\u0026#39;, \u0026#39;textarea\u0026#39;, \u0026#39;pre\u0026#39;], TeX: { equationNumbers: { autoNumber: \u0026#34;AMS\u0026#34; }, extensions: [\u0026#34;AMSmath.js\u0026#34;, \u0026#34;AMSsymbols.js\u0026#34;] } }, \u0026#34;HTML-CSS\u0026#34;: { availableFonts: [\u0026#34;Arial\u0026#34;, \u0026#34;TeX\u0026#34;], preferredFont: \u0026#34;TeX\u0026#34;, webFont: \u0026#34;TeX\u0026#34; } }); MathJax.Hub.Queue(function () { // Fix \u0026lt;code\u0026gt; tags after MathJax finishes running. This is a // hack to overcome a shortcoming of Markdown. Discussion at // https://github.com/mojombo/jekyll/issues/199 var all = MathJax.Hub.getAllJax(), i; for (i = 0; i \u0026lt; all.length; i += 1) { all[i].SourceElement().parentNode.className += \u0026#39; has-jax\u0026#39;; } }); \u0026lt;/script\u0026gt; \u0026lt;style\u0026gt; code.has-jax { font: inherit; font-size: 100%; background: inherit; border: inherit; color: #515151; } \u0026lt;/style\u0026gt; æ‰“å¼€themes/PaperMod/layouts/partials/extend_head.htmlæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š\n1 2 \u0026lt;!-- MathJax Support --\u0026gt; {{ partial \u0026#34;mathjax.html\u0026#34; . }} ä¸‹é¢æ˜¯ä¸€ä¸ªæ³°å‹’çº§æ•°å±•å¼€çš„ä¾‹å­ï¼š\n$$f(x) = f(a) + f\u0026rsquo;(a)(x-a) + \\frac{f\u0026rsquo;\u0026rsquo;(a)}{2!}(x-a)^2 + \\cdots + \\frac{f^{(n)}(a)}{n!}(x-a)^n + R_n(x)$$\nå…¶ä¸­ï¼Œ$f(a)$è¡¨ç¤ºåœ¨ç‚¹$a$å¤„çš„å‡½æ•°å€¼ï¼Œ$f\u0026rsquo;(a)$è¡¨ç¤ºåœ¨ç‚¹$a$å¤„çš„å¯¼æ•°å€¼ï¼Œ$f\u0026rsquo;\u0026rsquo;(a)$è¡¨ç¤ºåœ¨ç‚¹$a$å¤„çš„äºŒé˜¶å¯¼æ•°å€¼ï¼Œä»¥æ­¤ç±»æ¨ï¼Œ$R_n(x)$ä¸ºä½™é¡¹ï¼š$$R_n(x) = \\frac{f^{(n+1)}(c)}{(n+1)!}(x-a)^{n+1}$$\nè‡ªå®šä¹‰å¤´éƒ¨ Hugo æä¾›äº†ä¸€ä¸ªé»˜è®¤çš„æ–‡ç« ä½¿ç”¨æ¨¡æ¿ï¼Œä½äºarchetypes/default.mdï¼Œé‡Œé¢åŒ…æ‹¬ä¸€äº›åŸºæœ¬å†…å®¹æ ‡é¢˜ã€æ—¥æœŸä»¥åŠæ˜¯å¦ä¸ºè‰ç¨¿ã€‚\nä¸ºæ–¹ä¾¿å†™ä½œï¼Œåœ¨æ–‡ä»¶å¤¹ archetypes ä¸­åˆ›å»ºpost.md æ–‡ä»¶ï¼Œå¹¶å†™å…¥ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 --- title: \u0026#34;{{ replace .Name \u0026#34;-\u0026#34; \u0026#34; \u0026#34; | title }}\u0026#34; date: {{ .Date }} lastmod: {{ .Date }} author: [\u0026#34;kdjlyy\u0026#34;] summary: \u0026#34;\u0026#34; # ç®€å•æè¿°ï¼Œä¼šå±•ç¤ºåœ¨ä¸»é¡µï¼Œå¯è¢«æœç´¢ weight: # è¾“å…¥1å¯ä»¥é¡¶ç½®æ–‡ç«  draft: false # æ˜¯å¦ä¸ºè‰ç¨¿ comments: true # æ˜¯å¦å¼€å¯è¯„è®º showToc: true # æ˜¾ç¤ºç›®å½• TocOpen: true # è‡ªåŠ¨å±•å¼€ç›®å½• autonumbering: true # ç›®å½•è‡ªåŠ¨ç¼–å· hidemeta: false # æ˜¯å¦éšè—æ–‡ç« çš„å…ƒä¿¡æ¯ï¼Œå¦‚å‘å¸ƒæ—¥æœŸã€ä½œè€…ç­‰ disableShare: true # åº•éƒ¨ä¸æ˜¾ç¤ºåˆ†äº«æ  searchHidden: false # è¯¥é¡µé¢ä¸èƒ½è¢«æœç´¢åˆ° showbreadcrumbs: true # é¡¶éƒ¨æ˜¾ç¤ºå½“å‰è·¯å¾„ mermaid: true # æ˜¯å¦å¼€å¯mermaid cover: image: \u0026#34;\u0026#34; # å°é¢å›¾ç‰‡ hidden: true # æ–‡ç« é¡µé¢éšè—å°é¢å›¾ç‰‡ tags: - tag 1 - tag 2 --- æ ¹æ®å®šä¹‰å¥½çš„æ¨¡æ¿ï¼Œåœ¨æ­¤åˆ©ç”¨è¯¥æ¨¡æ¿ç”Ÿæˆå…³äºé¡µé¢ï¼Œæ ¹ç›®å½•æ‰§è¡Œæ‰§è¡Œå‘½ä»¤ï¼š\n1 hugo new --kind post content/posts/tech/xx.md è‡ªå®šä¹‰å­—ä½“ æœ¬åšå®¢ä½¿ç”¨è½éœå­¤é¹œç³»åˆ—å­—ä½“ï¼Œæ­£æ–‡ä½¿ç”¨ LXGW WenKai Lite å­—ä½“ï¼Œä»£ç å—è‹±æ–‡ä½¿ç”¨ JetBrains Mono å­—ä½“ï¼Œä¸­æ–‡ä½¿ç”¨ LXGW WenKai Screen å­—ä½“ï¼Œå…¬å¼ä½¿ç”¨ Arial å­—ä½“ã€‚\næ‰“å¼€themes/PaperMod/layouts/partials/extend_head.htmlæ–‡ä»¶ï¼Œè¿™ä¸ªæ˜¯ä¼šæ’å…¥åˆ° \u0026lt;head\u0026gt;\u0026lt;/head\u0026gt; ä¸­é—´çš„å†…å®¹ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026lt;!-- æ–‡ç« å­—ä½“è®¾ç½® --\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdn.jsdelivr.net/npm/jetbrains-mono@1.0.6/css/jetbrains-mono.min.css\u0026#34; /\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdn.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css\u0026#34; /\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.6.0/style.css\u0026#34; /\u0026gt; \u0026lt;style\u0026gt; body { font-family: \u0026#34;LXGW WenKai Lite\u0026#34;, sans-serif; font-family: \u0026#34;LXGW WenKai Screen\u0026#34;, sans-serif; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;/html\u0026gt; è¯¦ç»†å†…å®¹å‚è€ƒï¼šhttps://github.com/lxgw/LxgwWenKai/issues/24\næ‰“å¼€themes/PaperMod/assets/css/extended/blank.css ï¼Œè¿™ä¸ªæ˜¯å¯ä»¥è‡ªå®šä¹‰æ ·å¼çš„åœ°æ–¹ï¼Œæ·»åŠ ï¼š\n1 2 3 4 5 6 7 8 9 /* ========== æ­£æ–‡å­—ä½“ï¼šè½éœå­¤é¹œ ========== */ body { font-family: \u0026#34;LXGW WenKai Lite\u0026#34;, sans-serif !important; } /* ========== ä»£ç å­—ä½“ï¼šJetBrains Mono ========== */ code { font-family: \u0026#34;JetBrains Mono\u0026#34;, \u0026#34;LXGW WenKai Screen\u0026#34;, \u0026#34;LXGW WenKai Lite\u0026#34;, sans-serif; } ä¸ºäº†è®© MathJax å…¬å¼æ›´åŠ ç¾è§‚ï¼Œéœ€è¦åœ¨themes/PaperMod/layouts/partials/mathjax.htmlæ–‡ä»¶çš„MathJax.Hub.Configé…ç½®ä¸­æ·»åŠ ï¼š\n1 2 3 4 5 \u0026#34;HTML-CSS\u0026#34;: { availableFonts: [\u0026#34;Arial\u0026#34;, \u0026#34;TeX\u0026#34;], preferredFont: \u0026#34;TeX\u0026#34;, webFont: \u0026#34;TeX\u0026#34; } â€‹\tç¤ºä¾‹ï¼š$\\sum_{i=0}^N\\int_{a}^{b}g(t,i)\\text{d}t$\næ·»åŠ busuanzi busuanzi æ’ä»¶å¯ä»¥æä¾›ç«™ç‚¹è®¿é—®é‡å’Œæ–‡ç« é˜…è¯»æ•°çš„è®¡æ•°æœåŠ¡ï¼Œå› ä¸ºæ‰“å¼€è¯¥åŠŸèƒ½ä¼šç•¥å¾®é™ä½ç½‘ç«™åŠ è½½é€Ÿåº¦ï¼Œæ‰€ä»¥é»˜è®¤å…³é—­è¯¥åŠŸèƒ½ã€‚\næ‰“å¼€themes/PaperMod/layouts/partials/head.htmlï¼Œåœ¨{{- /* Styles */}}è¿™ä¸€è¡Œå‰é¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š\n1 2 3 4 5 \u0026lt;!-- busuanzi --\u0026gt; {{- if site.Params.busuanzi.enable -}} \u0026lt;script async src=\u0026#34;//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;meta name=\u0026#34;referrer\u0026#34; content=\u0026#34;no-referrer-when-downgrade\u0026#34;\u0026gt; {{- end }} åœ¨ç«™ç‚¹åº•éƒ¨æ˜¾ç¤ºæ€»è®¿é—®é‡ä¸è®¿å®¢æ•°ï¼Œæ‰“å¼€footer.htmlä¸€èˆ¬å’Œhead.htmlåŒç›®å½•ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œæ³¨æ„æ·»åŠ åœ¨\u0026lt;footer\u0026gt;ä»£ç å—é‡Œï¼š\n1 2 3 4 5 6 7 8 9 10 11 \u0026lt;!-- busuanzi --\u0026gt; {{ if .Site.Params.busuanzi.enable -}} \u0026lt;div class=\u0026#34;busuanzi-footer\u0026#34;\u0026gt; \u0026lt;span id=\u0026#34;busuanzi_container_site_pv\u0026#34;\u0026gt; æœ¬ç«™æ€»è®¿é—®é‡\u0026lt;span id=\u0026#34;busuanzi_value_site_pv\u0026#34;\u0026gt;\u0026lt;/span\u0026gt;æ¬¡ \u0026lt;/span\u0026gt; \u0026lt;span id=\u0026#34;busuanzi_container_site_uv\u0026#34;\u0026gt; æœ¬ç«™è®¿å®¢æ•°\u0026lt;span id=\u0026#34;busuanzi_value_site_uv\u0026#34;\u0026gt;\u0026lt;/span\u0026gt;äººæ¬¡ \u0026lt;/span\u0026gt; \u0026lt;/div\u0026gt; {{- end -}} ç”¨äºæ˜¾ç¤ºæ¯ç¯‡æ–‡ç« é˜…è¯»é‡ï¼Œåœ¨themes/PaperMod/layouts/_default/single.htmlï¼Œä¸€æ ·æ³¨æ„åŠ åœ¨\u0026lt;header\u0026gt;ä»£ç å—å†…ï¼š\n1 2 3 4 5 6 \u0026lt;!-- busuanzi --\u0026gt; {{ if .Site.Params.busuanzi.enable -}} \u0026lt;div class=\u0026#34;meta-item\u0026#34;\u0026gt;\u0026amp;nbspÂ·\u0026amp;nbsp \u0026lt;span id=\u0026#34;busuanzi_container_page_pv\u0026#34;\u0026gt;æœ¬æ–‡é˜…è¯»é‡\u0026lt;span id=\u0026#34;busuanzi_value_page_pv\u0026#34;\u0026gt;\u0026lt;/span\u0026gt;æ¬¡\u0026lt;/span\u0026gt; \u0026lt;/div\u0026gt; {{- end }} å›åˆ°æ ¹ç›®å½•æ”¹config.ymlï¼Œåœ¨paramsé‡ŒåŠ ä¸Šä¸¤è¡Œï¼š\n1 2 3 params: busuanzi: enable: true ä¿®æ”¹post_metaå¤´éƒ¨ä¿¡æ¯ post_meta æ ·å¼ å®šä½åˆ°æ–‡ä»¶ï¼šthemes/PaperMod/layouts/partials/post_meta.htmlï¼Œæ›¿æ¢å¦‚ä¸‹ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 {{- $scratch := newScratch }} \u0026lt;!-- åˆ›å»ºæ—¶é—´ --\u0026gt; {{- if not .Date.IsZero -}} {{- $scratch.Add \u0026#34;meta\u0026#34; (slice (printf \u0026#34;åˆ›å»º:\u0026amp;nbsp;\u0026lt;span title=\u0026#39;%s\u0026#39;\u0026gt;%s\u0026lt;/span\u0026gt;\u0026#34; (.Date) (.Date.Format (default \u0026#34;January 2, 2006\u0026#34; .Site.Params.DateFormat)))) }} {{- end }} \u0026lt;!-- æ›´æ–°æ—¶é—´ --\u0026gt; {{- if (.Param \u0026#34;ShowLastMod\u0026#34;) -}} {{- $scratch.Add \u0026#34;meta\u0026#34; (slice (printf \u0026#34;æ›´æ–°:\u0026amp;nbsp;%s\u0026#34; (.Lastmod.Format (.Site.Params.dateFormat | default \u0026#34;2006-01-02\u0026#34;)))) }} {{- end }} \u0026lt;!-- ç»Ÿè®¡å­—æ•° --\u0026gt; {{- if (.Param \u0026#34;ShowWordCounts\u0026#34;) -}} {{- $scratch.Add \u0026#34;meta\u0026#34; (slice (default (printf \u0026#34;å­—æ•°:\u0026amp;nbsp;%då­—\u0026#34; .WordCount))) }} {{- end }} \u0026lt;!-- å¤§æ¦‚éœ€è¦èŠ±è´¹çš„é˜…è¯»æ—¶é—´ --\u0026gt; {{- if (.Param \u0026#34;ShowReadingTime\u0026#34;) -}} {{- $scratch.Add \u0026#34;meta\u0026#34; (slice (default (printf \u0026#34;æ—¶é•¿: %dåˆ†é’Ÿ\u0026#34; .ReadingTime))) }} {{- end }} \u0026lt;!-- ä½œè€… --\u0026gt; {{- with (partial \u0026#34;author.html\u0026#34; .) }} {{- $scratch.Add \u0026#34;meta\u0026#34; (slice .) }} {{- end }} \u0026lt;!-- åˆ†éš”æ–¹å¼ --\u0026gt; {{- with ($scratch.Get \u0026#34;meta\u0026#34;) }} {{- delimit . \u0026#34;\u0026amp;nbsp;|\u0026amp;nbsp;\u0026#34; -}} {{- end -}} ä½œè€…çš„ä¸­æ–‡æ˜¾ç¤ºè¦æ‰¾themes/PaperMod/layouts/partials/author.htmlï¼Œè®¾ç½®å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 {{- if or .Params.author site.Params.author }} ä½œè€…:\u0026amp;nbsp;{{- $author := (.Params.author | default site.Params.author) }} {{- $author_type := (printf \u0026#34;%T\u0026#34; $author) }} {{- if (or (eq $author_type \u0026#34;[]string\u0026#34;) (eq $author_type \u0026#34;[]interface {}\u0026#34;)) }} {{- (delimit $author \u0026#34;, \u0026#34; ) }} {{- else }} {{- $author }} {{- end }} {{- end -}} å› ä¸ºæœ‰äº›å­—æ®µæ˜¯è‡ªå·±åŠ çš„ï¼Œæ‰€ä»¥è¿˜è¦åœ¨config.ymlæ–‡ä»¶çš„paramså­—æ®µä¸‹åŠ ä¸Šè¿™äº›å­—æ®µï¼š\n1 2 3 4 5 params: DateFormat: \u0026#34;2006-01-02\u0026#34; ShowWordCounts: true ShowReadingTime: true ShowLastMod: true åœ¨æ¯ç¯‡æ–‡ç« å¼€å¤´è®°å¾—åŠ ä¸Šâ€œdateâ€ã€â€œlastmodâ€ã€â€œauthorâ€è¿™ä¸‰ä¸ªå­—æ®µï¼Œå·²ç»é›†æˆåœ¨ archetypes/post.md é‡Œé¢äº†ï¼Œè¿™æ ·æ¯æ¬¡åˆ›å»ºæ–‡ç« å°±ä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œç”Ÿæˆæ–‡ç« çš„å‘½ä»¤ï¼š\n1 hugo new --kind post content/posts/tech/xx.md å‚è€ƒï¼šHugoåšå®¢ä¿®æ”¹post_metaå¤´éƒ¨ä¿¡æ¯\næ·»åŠ èƒŒæ™¯å›¾ç‰‡ é€šè¿‡æµè§ˆå™¨å®šä½ html ä»£ç ï¼Œå‘ç°èƒŒæ™¯å›¾ç‰‡åœ¨ list æ ‡ç­¾ä¸‹ï¼Œæ‰€ä»¥éœ€è¦ï¼š\næ‰“å¼€themes/PaperMod/assets/css/extended/blank.cssï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 /* ä¸»é¡µèƒŒæ™¯å›¾ç‰‡ */ .list { /* æ·»åŠ !importantè¡¨ç¤ºè¦†ç›–é»˜è®¤çš„è®¾ç½® */ background-image: url(\u0026#34;../../img/white_mountains.jpg\u0026#34;) !important; /* ç…§ç‰‡ä¸é‡å¤å‡ºç° */ background-repeat: no-repeat; /* ç…§ç‰‡å¤§å° */ background-size: 100% 100%; /* å³ä¾§æ»šåŠ¨æ—¶ç…§ç‰‡å›ºå®šå¤§å° */ background-attachment: fixed; } .dark.list { /* æ·»åŠ !importantè¡¨ç¤ºè¦†ç›–é»˜è®¤çš„è®¾ç½® */ background-image: url(\u0026#34;../../img/white_mountains_dark.jpg\u0026#34;) !important; background-repeat: no-repeat; background-size: 100% 100%; background-attachment: fixed; } è¿™é‡Œæˆ‘æ˜¯å°†å›¾ç‰‡æºæ–‡ä»¶æ”¾åœ¨public/imgç›®å½•ä¸‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ URL çš„æ–¹å¼å¡«å†™ã€‚\næ–‡ç« è‡ªåŠ¨ç¼–å· ä¸ªäººåœ¨å†™ç”¨ markdown æ–‡ç« æ—¶ä¸€èˆ¬ç”¨äºŒçº§æ ‡é¢˜##å¼€å§‹ï¼Œå¸Œæœ›å†™æ–‡ç« æ—¶èƒ½æœ‰ç±»ä¼¼äº $LaTeX$ çš„ä½“éªŒï¼Œè¿™ä¸ªåœ¨ Typora ä¸­å¾ˆå®¹æ˜“å®ç°ï¼Œåªéœ€è¦æ·»åŠ å¯¹åº”çš„ css æ ·å¼å³å¯ï¼Œç½‘ç»œä¸Šå¾ˆå®¹æ˜“æ‰¾åˆ°å¯¹åº”çš„æ•™ç¨‹ã€‚\nåœ¨ Hugo çš„ PaperMod ä¸»é¢˜ä¸­ï¼Œä»¥ä¸‹æ“ä½œå¯ä»¥å®ç°ç›®å½•å’Œæ­£æ–‡çš„è‡ªåŠ¨ç¼–å·ï¼š\næ‰“å¼€themes/PaperMod/layouts/_default/single.htmlæ–‡ä»¶ï¼Œå°†\n1 \u0026lt;article class=\u0026#34;post-single\u0026#34;\u0026gt; æ›¿æ¢ä¸ºï¼š\n1 \u0026lt;article class=\u0026#34;post\u0026#34; {{- if .Param \u0026#34;autonumbering\u0026#34; }} autonumbering {{- end }}\u0026gt; æ‰“å¼€themes/PaperMod/assets/css/extended/blank.cssï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 /* ========= æ–‡ç« å’Œç›®å½•è‡ªåŠ¨ç¼–å·ï¼ˆä»äºŒçº§æ ‡é¢˜å¼€å§‹ï¼‰============ */ body { counter-reset: h2 } h2 { counter-reset: h3 } h3 { counter-reset: h4 } h4 { counter-reset: h5 } article[autonumbering] h2:before { counter-increment: h2; content: counter(h2) \u0026#34;. \u0026#34; } article[autonumbering] h3:before { counter-increment: h3; content: counter(h2) \u0026#34;.\u0026#34; counter(h3) \u0026#34; \u0026#34; } article[autonumbering] h4:before { counter-increment: h4; content: counter(h2) \u0026#34;.\u0026#34; counter(h3) \u0026#34;.\u0026#34; counter(h4) \u0026#34; \u0026#34; } article[autonumbering] .toc ul { counter-reset: item } article[autonumbering] .toc li a:before { content: counters(item, \u0026#34;.\u0026#34;) \u0026#34; \u0026#34;; counter-increment: item } åœ¨æ–‡ç« å¤´éƒ¨ä¿¡æ¯å‰é¢è®¾ç½®autonumbering: trueå³å¯å®Œæˆæ­£æ–‡å’Œç›®å½•çš„è‡ªåŠ¨ç¼–å·åŠŸèƒ½ã€‚\nå°é¢å›¾ç‰‡ç¼©å°å¹¶ç§»åˆ°ä¾§è¾¹ PaperMod ä¸»é¢˜ä¼šå› ä¸ºæ’å…¥äº†å°é¢å›¾ç‰‡å¯¼è‡´æ–‡ç« ç£è´´é«˜åº¦å˜å¤§ï¼Œè¾¾ä¸åˆ°ç¾è§‚ç»Ÿä¸€çš„è¦æ±‚ï¼Œä¸‹é¢æ“ä½œå¯ä»¥åšåˆ°å°†å°é¢å›¾ç‰‡ç¼©å°å¹¶ç§»åˆ°å³ä¾§ï¼Œæ•ˆæœå¦‚å›¾ï¼š\nå°é¢å›¾ç‰‡ç¼©å°å¹¶ç§»åˆ°ä¾§è¾¹ æ‰“å¼€themes/PaperMod/layouts/_default/list.htmlï¼Œæ·»åŠ ä¸€ä¸ª class æ ‡è¯†ï¼Œå‘½åä¸ºpost-infoï¼ŒæŠŠ entry-header å’Œ entry-content å’Œ entry-footer éƒ½åŒ…è£¹è¿›å»ï¼Œå…·ä½“ä¿®æ”¹å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \u0026lt;article class=\u0026#34;{{ $class }}\u0026#34;\u0026gt; \u0026lt;!-- {{- $isHidden := (site.Params.cover.hidden | default site.Params.cover.hiddenInList) }} {{- partial \u0026#34;cover.html\u0026#34; (dict \u0026#34;cxt\u0026#34; . \u0026#34;IsHome\u0026#34; true \u0026#34;isHidden\u0026#34; $isHidden) }} --\u0026gt; \u0026lt;div class=\u0026#34;post-info\u0026#34;\u0026gt; \u0026lt;header class=\u0026#34;entry-header\u0026#34;\u0026gt; \u0026lt;h2\u0026gt; {{- .Title }} {{- if .Draft }}\u0026lt;sup\u0026gt;\u0026lt;span class=\u0026#34;entry-isdraft\u0026#34;\u0026gt;\u0026amp;nbsp;\u0026amp;nbsp;[draft]\u0026lt;/span\u0026gt;\u0026lt;/sup\u0026gt; {{- end }} \u0026lt;/h2\u0026gt; \u0026lt;/header\u0026gt; {{- if (ne (.Param \u0026#34;hideSummary\u0026#34;) true) }} \u0026lt;div class=\u0026#34;entry-content\u0026#34;\u0026gt; \u0026lt;p\u0026gt;{{ .Summary | plainify | htmlUnescape }}{{ if .Truncated }}...{{ end }}\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; {{- end }} {{- if not (.Param \u0026#34;hideMeta\u0026#34;) }} \u0026lt;footer class=\u0026#34;entry-footer\u0026#34;\u0026gt; {{- partial \u0026#34;post_meta.html\u0026#34; . -}} \u0026lt;/footer\u0026gt; {{- end }} \u0026lt;/div\u0026gt; {{- $isHidden := (.Site.Params.cover.hidden | default .Site.Params.cover.hiddenInList) }} {{- partial \u0026#34;cover.html\u0026#34; (dict \u0026#34;cxt\u0026#34; . \u0026#34;IsHome\u0026#34; true \u0026#34;isHidden\u0026#34; $isHidden) }} \u0026lt;a class=\u0026#34;entry-link\u0026#34; aria-label=\u0026#34;post link to {{ .Title | plainify }}\u0026#34; href=\u0026#34;{{ .Permalink }}\u0026#34;\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;/article\u0026gt; æ‰“å¼€themes/PaperMod/assets/css/extended/blank.cssï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 /* å°é¢å›¾ç‰‡æ˜¾ç¤ºåˆ°å³è¾¹ */ .entry-cover1 { border-radius: 10px; display: flex; justify-content: center; } .post-entry { display: flex; flex-direction: row; align-items: center; } .entry-cover { border-radius: 10px; overflow: hidden; width: 50%; margin-bottom: unset; max-height: 150px; display: grid; align-content: center; } .post-info { display: inline-block; overflow: hidden; width: 100%; padding-right: 10px; } /* æ–‡ç« å†…ä½¿ç”¨çš„å°é¢å›¾ */ .entry-cover1 img { border-radius: var(--radius); pointer-events: none; width: 100%; height: auto; margin-bottom: 40px; } å› ä¸ºä¸Šé¢å¯¹æ–‡ç« å°é¢å›¾ç‰‡è¿›è¡Œäº†è°ƒæ•´ï¼Œä¼šå½±å“åˆ°æ–‡ç« é‡Œé¢é¡¶éƒ¨çš„å›¾ç‰‡å±•ç¤ºï¼Œæ‰€ä»¥éœ€è¦è§£å†³å†²çªï¼š\nå®šä½åˆ°ç›®å½•themes/PaperMod/layouts/partials/cover.htmlï¼Œåœ¨ç›¸åŒç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåå­—ä¸ºcover1.htmlçš„æ–‡ä»¶ï¼Œå¹¶æŠŠcover.htmlé‡Œçš„æ–‡ä»¶å¤åˆ¶ä¸€ä»½ä¸€æ ·çš„åˆ°cover1.htmlä¸‹ï¼›\næŠŠcover1.htmlæ–‡ä»¶é‡Œçš„\u0026lt;figure class=\u0026quot;entry-cover\u0026quot;\u0026gt;ä¿®æ”¹ä¸º\u0026lt;figure class=\u0026quot;entry-cover1\u0026quot;\u0026gt;ï¼›\nå®šä½åˆ°themes/PaperMod/layouts/_default/single.htmlï¼ŒæŠŠ{{- partial \u0026quot;cover.html\u0026quot; (dict \u0026quot;cxt\u0026quot; . \u0026quot;IsHome\u0026quot; false \u0026quot;isHidden\u0026quot; $isHidden) }}æ”¹ä¸º{{- partial \u0026quot;cover1.html\u0026quot; (dict \u0026quot;cxt\u0026quot; . \u0026quot;IsHome\u0026quot; false \u0026quot;isHidden\u0026quot; $isHidden) }}ï¼Œè¿™æ ·æ–‡ç« å°é¢è°ƒç”¨çš„æ˜¯ç»è¿‡ä¿®æ”¹çš„å›¾ç‰‡ï¼Œè€Œæ–‡ç« é‡Œé¢é¡¶éƒ¨çš„å›¾ç‰‡è°ƒç”¨çš„æ˜¯æœªç»ä¿®æ”¹çš„å›¾ç‰‡ã€‚\nå¦‚æœåªéœ€è¦å°é¢å›¾ç‰‡ï¼Œä½†æ˜¯ä¸éœ€è¦æ–‡ç« é¡¶éƒ¨çš„å›¾ç‰‡éœ€è¦åœ¨å†™ä½œæ—¶è®¾ç½®å¤´éƒ¨ï¼š\n1 2 3 cover: image: \u0026#34;\u0026#34; # å°é¢å›¾ç‰‡ hidden: true # æ–‡ç« é¡µé¢éšè—å°é¢å›¾ç‰‡ æ·»åŠ utterancesè¯„è®º utterances æ˜¯ä¸€æ¬¾åŸºäº GitHub issues çš„è¯„è®ºå·¥å…·ï¼Œä¼˜ç‚¹æ˜¯æå…¶è½»é‡ã€åŠ è½½éå¸¸å¿«ã€é…ç½®æ¯”è¾ƒç®€å•ã€‚\né¦–å…ˆåˆ›å»ºä¸€ä¸ª Github ä»“åº“ä¿å­˜ä¸ªäººåšå®¢çš„è¯„è®ºå†…å®¹ï¼Œä¾‹å¦‚ï¼šblog_commentsï¼›\nè¿›å…¥ utterances app å¯¹è‡ªå·±æ‰€è¦ä¿å­˜è¯„è®ºçš„ä»“åº“æˆæƒï¼›\nåˆ›å»ºthemes/PaperMod/layouts/partials/comments.htmlï¼Œè¾“å…¥ï¼š\n1 2 3 4 5 6 7 8 9 10 11 \u0026lt;!-- github comments --\u0026gt; \u0026lt;div\u0026gt; \u0026lt;div class=\u0026#34;pagination__title\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;pagination__title-h\u0026#34; style=\u0026#34;font-size: 20px;\u0026#34;\u0026gt;è¯„è®º\u0026lt;/span\u0026gt; \u0026lt;br /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div id=\u0026#34;tcomment\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script src=\u0026#34;https://utteranc.es/client.js\u0026#34; repo=\u0026#34;GitHubä»“åº“åç§°ï¼ˆå¦‚ï¼škdjlyy/blog_commentsï¼‰\u0026#34; issue-term=\u0026#34;title\u0026#34; theme=\u0026#34;github-light\u0026#34; crossorigin=\u0026#34;anonymous\u0026#34; async\u0026gt; \u0026lt;/script\u0026gt; \u0026lt;/div\u0026gt; åœ¨åšå®¢é…ç½®æ–‡ä»¶config.ymlä¸­çš„paramså­—æ®µæ·»åŠ é…ç½®ï¼š\n1 2 3 4 5 utteranc: enable: true repo: \u0026#34;kdjlyy/blog_comments\u0026#34; issueTerm: \u0026#34;title\u0026#34; theme: \u0026#34;github-light\u0026#34; ","permalink":"https://kdjlyy.cn/posts/site/hugo-papermod-optimization/","summary":"PaperMod, ä¸»é¢˜ä¼˜åŒ–, æ ‡ç­¾é¡µé¢, MathJax, è‡ªå®šä¹‰å¤´éƒ¨, è‡ªå®šä¹‰å­—ä½“, åœç®—å­, busuanzi, post_meta, èƒŒæ™¯å›¾ç‰‡, è‡ªåŠ¨ç¼–å·, utterances, è¯„è®º","title":"PaperModä¸»é¢˜ä¼˜åŒ–"},{"content":"æ–°å»ºGithubä»“åº“ æ–°å»ºä¸€ä¸ª GitHub Repositoryï¼Œåº“åä¸º username.github.ioï¼Œusername å³ä½ çš„ GitHub è´¦å· usernameã€‚\næ–°å»º Github ä»“åº“ é…ç½®æ–‡ä»¶ åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬åœ¨æœ¬åœ°å¿«é€Ÿå¯åŠ¨äº† Hugo åšå®¢ï¼š\nåŸºäºHugoæ­å»ºé™æ€åšå®¢ æ—¥æœŸ: 2023-05-30 \u0026nbsp; æ ‡ç­¾: #Hugo\u0026nbsp; #PaperMod\u0026nbsp; hugo, é™æ€åšå®¢, PaperMod, å¿«é€Ÿå¯åŠ¨ ...... å…¶ä¸­ç«™ç‚¹é…ç½®æ–‡ä»¶æ”¹æˆäº† .yml åç¼€çš„å†™æ³•ï¼Œå› ä¸ºè¿™æ ·æ¯”é»˜è®¤çš„ .toml å†™æ³•æ›´æ˜“ç”¨ï¼Œè¯¦ç»†å‚è€ƒï¼šConfigure Hugoã€‚\nä¸‹é¢æ˜¯æˆ‘çš„ config.yml é…ç½®ï¼Œæ³¨æ„ä¸åŒçš„ä¸»é¢˜é…ç½®æ–¹æ³•å¯èƒ½æœ‰å·®å¼‚ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ PaperMod ä¸»é¢˜ã€‚éƒ¨åˆ†ä¿¡æ¯æ ¹æ®éœ€è¦è‡ªè¡Œæ›´æ”¹ï¼Œä¾‹å¦‚æˆ‘ç»‘å®šäº†ä¸ªäººåŸŸåæ‰€ä»¥ baseURL è®¾ç½®çš„æ˜¯è‡ªå·±è´­ä¹°çš„åŸŸåï¼Œä¹Ÿå¯ä»¥é…ç½®ä½¿ç”¨ Github ä»“åº“çš„åŸŸåè®¿é—®åšå®¢ä¸»é¡µã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 baseURL: https://kdjlyy.cn # baseURL: https://kdjlyy.github.io languageCode: zh-cn title: å‘ç€æ‚ è¿œçš„è‹ç©¹ theme: PaperMod paginate: 10 # é¦–é¡µæ¯é¡µæ˜¾ç¤ºçš„æ–‡ç« æ•° hasCJKLanguage: true # è‡ªåŠ¨æ£€æµ‹æ˜¯å¦åŒ…å«ä¸­æ–‡æ—¥æ–‡éŸ©æ–‡,å¦‚æœæ–‡ç« ä¸­ä½¿ç”¨äº†å¾ˆå¤šä¸­æ–‡å¼•å·çš„è¯å¯ä»¥å¼€å¯ enableInlineShortcodes: true # å…è®¸å†…è”çŸ­ç  enableEmoji: true # å…è®¸ä½¿ç”¨ Emoji è¡¨æƒ…ï¼Œå»ºè®® true enableRobotsTXT: true # å…è®¸çˆ¬è™«æŠ“å–åˆ°æœç´¢å¼•æ“ï¼Œå»ºè®® true summaryLength: 90 # æ–‡ç« å†…é“¾å¡ç‰‡è·å–çš„æ–‡ç« é•¿åº¦é»˜è®¤æ˜¯70 buildDrafts: false buildFuture: false buildExpired: false # pygmentsUseClasses: true # googleAnalytics: UA-123-45 minify: disableXML: true # minifyOutput: true permalinks: # æµè§ˆå™¨é“¾æ¥æ˜¾ç¤ºæ–¹å¼ post: \u0026#34;/:title/\u0026#34; # post: \u0026#34;/:year/:month/:day/:title/\u0026#34; defaultContentLanguage: zh # æœ€é¡¶éƒ¨é¦–å…ˆå±•ç¤ºçš„è¯­è¨€é¡µé¢ defaultContentLanguageInSubdir: true languages: zh: languageName: \u0026#34;Chinese\u0026#34; # contentDir: content/english weight: 1 profileMode: enabled: true title: # ä¸»é¡µæ ‡é¢˜ subtitle: # ä¸»é¡µå‰¯æ ‡é¢˜ imageUrl: \u0026#34;img/logo.ico\u0026#34; # å¤´åƒ imageTitle: imageWidth: 150 imageHeight: 150 buttons: - name: ğŸ‘¨ğŸ»â€ğŸ’»æŠ€æœ¯ url: posts/tech - name: ğŸ“‹å»ºç«™ url: posts/site - name: ğŸ“•é˜…è¯» url: posts/read - name: ğŸ–ç”Ÿæ´» url: posts/life menu: main: - identifier: search name: ğŸ”æœç´¢ url: search weight: 1 - identifier: home name: ğŸ ä¸»é¡µ url: / weight: 2 - identifier: posts name: ğŸ“šæ–‡ç«  url: /posts weight: 3 - identifier: archives name: â±ï¸æ—¶é—´è½´ url: /archives weight: 20 # - identifier: categories # name: ğŸ§©åˆ†ç±» # url: /categories # weight: 30 - identifier: tags name: ğŸ”–æ ‡ç­¾ url: /tags weight: 40 - identifier: about name: ğŸ™‹ğŸ»â€â™‚ï¸å…³äº url: /about weight: 50 # - identifier: links # name: ğŸ¤å‹é“¾ # url: links # weight: 60 outputs: home: - HTML - RSS - JSON params: env: production # to enable google analytics, opengraph, twitter-cards and schema. description: \u0026#34;å‘ç€æ‚ è¿œçš„è‹ç©¹, kdjlyy\u0026#39;s Blog\u0026#34; author: kdjlyy # author: [\u0026#34;Me\u0026#34;, \u0026#34;You\u0026#34;] defaultTheme: light # defaultTheme: light or dark disableThemeToggle: false DateFormat: \u0026#34;2006-01-02\u0026#34; # ShowShareButtons: true ShowReadingTime: false # disableSpecialistPost: true displayFullLangName: true ShowPostNavLinks: true ShowBreadCrumbs: true ShowCodeCopyButtons: true hideFooter: false # éšè—é¡µè„š ShowWordCounts: true VisitCount: true ShowLastMod: true #æ˜¾ç¤ºæ–‡ç« æ›´æ–°æ—¶é—´ ShowToc: true # æ˜¾ç¤ºç›®å½• TocOpen: true # è‡ªåŠ¨å±•å¼€ç›®å½• comments: true busuanzi: enable: false # è®¿é—®é‡ç»Ÿè®¡ï¼Œå¼€å¯ä¼šé™ä½åŠ è½½é€Ÿåº¦ socialIcons: - name: github url: \u0026#34;https://github.com/kdjlyy\u0026#34; - name: bilibili url: \u0026#34;https://space.bilibili.com/279296780\u0026#34; - name: QQ url: \u0026#34;img/qq.jpg\u0026#34; - name: email url: \u0026#34;kdjlyy@qq.com\u0026#34; # - name: RSS # url: \u0026#34;index.xml\u0026#34; # - name: QQ # url: \u0026#34;img/qq.png\u0026#34; # - name: Phone # url: \u0026#34;img/phone.png\u0026#34; # editPost: # URL: \u0026#34;https://github.com/adityatelange/hugo-PaperMod/tree/exampleSite/content\u0026#34; # Text: \u0026#34;Suggest Changes\u0026#34; # edit text # appendFilePath: true # to append file path to Edit link # label: # text: \u0026#34;Home\u0026#34; # icon: icon.png # iconHeight: 35 assets: favicon: \u0026#34;img/logo.ico\u0026#34; favicon16x16: \u0026#34;img/logo.ico\u0026#34; favicon32x32: \u0026#34;img/logo.ico\u0026#34; apple_touch_icon: \u0026#34;logo.ico\u0026#34; safari_pinned_tab: \u0026#34;logo.ico\u0026#34; # cover: # hidden: true # hide everywhere but not in structured data # hiddenInList: true # hide on list pages and home # hiddenInSingle: true # hide on single page fuseOpts: isCaseSensitive: false shouldSort: true location: 0 distance: 1000 threshold: 1 minMatchCharLength: 0 keys: [\u0026#34;title\u0026#34;, \u0026#34;permalink\u0026#34;, \u0026#34;summary\u0026#34;] # twikoo: # version: 1.4.11 # è¯„è®º utteranc: enable: true repo: \u0026#34;kdjlyy/blog_comments\u0026#34; issueTerm: \u0026#34;title\u0026#34; theme: \u0026#34;github-light\u0026#34; taxonomies: category: categories tag: tags series: series markup: goldmark: renderer: unsafe: true # HUGO é»˜è®¤è½¬ä¹‰ Markdown æ–‡ä»¶ä¸­çš„ HTML ä»£ç ï¼Œå¦‚éœ€å¼€å¯çš„è¯ highlight: # anchorLineNos: true # ä»£ç è¡Œå·ä¸‹åŠ ä¸‹åˆ’çº¿ codeFences: true # ä»£ç å›´æ åŠŸèƒ½ï¼Œè¿™ä¸ªåŠŸèƒ½ä¸€èˆ¬éƒ½è¦è®¾ä¸ºtrueï¼Œä¸ç„¶å¾ˆéš¾çœ‹ guessSyntax: true # çŒœæµ‹è¯­æ³•ï¼Œè¿™ä¸ªåŠŸèƒ½å»ºè®®è®¾ç½®ä¸ºtrue, å¦‚æœä½ æ²¡æœ‰è®¾ç½®è¦æ˜¾ç¤ºçš„è¯­è¨€åˆ™ä¼šè‡ªåŠ¨åŒ¹é… lineNos: true # ä»£ç è¡Œå· style: nord # monokai, darcula, solarized-dark, nord lineNumbersInTable: true # ä½¿ç”¨è¡¨æ¥æ ¼å¼åŒ–è¡Œå·å’Œä»£ç ,è€Œä¸æ˜¯æ ‡ç­¾ã€‚è¿™ä¸ªå±æ€§ä¸€èˆ¬è®¾ç½®ä¸º true # hl_Linesï¼šé«˜äº®çš„è¡Œå·ï¼Œä¸€èˆ¬è¿™ä¸ªä¸è®¾ç½®ï¼Œå› ä¸ºæ¯ä¸ªä»£ç å—æˆ‘ä»¬å¯èƒ½å¸Œæœ›è®©é«˜äº®çš„åœ°æ–¹ä¸ä¸€æ · # lineNoStartï¼šè¡Œå·ä»ç¼–å·å‡ å¼€å§‹ï¼Œä¸€èˆ¬ä» 1 å¼€å§‹ # lineNosï¼šæ˜¯å¦æ˜¾ç¤ºè¡Œå·ï¼Œæˆ‘æ¯”è¾ƒå–œæ¬¢æ˜¾ç¤ºï¼Œæ‰€ä»¥æˆ‘è®¾ç½®çš„ä¸º true # noClasses: true # ä½¿ç”¨ class æ ‡ç­¾ï¼Œè€Œä¸æ˜¯å†…åµŒçš„å†…è”æ ·å¼ privacy: vimeo: disabled: false simple: true twitter: disabled: false enableDNT: true simple: true instagram: disabled: false simple: true youtube: disabled: false privacyEnhanced: true services: instagram: disableInlineCSS: true twitter: disableInlineCSS: true ç›®å½•ç»“æ„ ä¸ªäººçš„ç›®å½•é…ç½®å¦‚ä¸‹ï¼Œæ­é…ä¸Šé¢çš„é…ç½®æ–‡ä»¶ä½¿ç”¨ã€‚\næ–‡ç« ç›®å½•ç»“æ„ åšå®¢æ–‡ç« éƒ½æ˜¯å­˜æ”¾åœ¨contentç›®å½•ä¸‹çš„ï¼Œå…·ä½“çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 content/ â”œâ”€â”€ posts/ â”‚\tâ”œâ”€â”€ life/ â”‚\tâ”‚\tâ””â”€â”€ _index.md â”‚\tâ”œâ”€â”€ read/ â”‚\tâ”‚\tâ””â”€â”€ _index.md â”‚\tâ”œâ”€â”€ site/ â”‚\tâ”‚\tâ”œâ”€â”€ xxx.md â”‚\tâ”‚\tâ””â”€â”€ _index.md â”‚\tâ”œâ”€â”€ tech/ â”‚\tâ”‚\tâ””â”€â”€ _index.md â”‚\tâ””â”€â”€ _index.md â”œâ”€â”€ about.md â”œâ”€â”€ archive.md â””â”€â”€ search.md about.mdã€archive.mdã€search.md åˆ†åˆ«å¯¹åº”å³ä¸Šè§’å…³äºã€æ—¶é—´è½´ã€æœç´¢ä¸‰ä¸ªé¡µé¢ã€‚\nlifeã€readã€siteã€tech å¯¹åº”é¦–é¡µçš„å››ä¸ªæŒ‰é’®ï¼Œcontent é‡Œæ¯ä¸ªæ–‡ä»¶å¤¹å†…éƒ½è¦æ·»åŠ ä¸€ä¸ª _index.md æ–‡ä»¶ã€‚åœ¨å¯¹åº”çš„æ–‡ä»¶å¤¹ä¸‹åˆ›å»º markdown æ–‡ä»¶å³å¯å°†æ–‡ç« æ”¾å…¥å¯¹åº”çš„åˆ†ç±»ä¸­ã€‚\nabout.md 1 2 3 4 5 6 7 8 9 10 --- title: \u0026#34;å…³äº\u0026#34; layout: \u0026#34;about\u0026#34; url: \u0026#34;/about/\u0026#34; summary: about hidemeta: true # æ˜¯å¦éšè—æ–‡ç« çš„å…ƒä¿¡æ¯ï¼Œå¦‚å‘å¸ƒæ—¥æœŸã€ä½œè€…ç­‰ showbreadcrumbs: false #é¡¶éƒ¨æ˜¾ç¤ºå½“å‰è·¯å¾„ searchHidden: true showToc: false --- archive.md 1 2 3 4 5 6 --- title: \u0026#34;æ—¶é—´è½´\u0026#34; layout: \u0026#34;archives\u0026#34; url: \u0026#34;/archives/\u0026#34; summary: archives --- search.md 1 2 3 4 5 6 7 8 --- title: \u0026#34;æœç´¢\u0026#34; # in any language you want layout: \u0026#34;search\u0026#34; # is necessary url: \u0026#34;/search/\u0026#34; # description: \u0026#34;Description for Search\u0026#34; summary: \u0026#34;search\u0026#34; placeholder: \u0026#34;è¯·è¾“å…¥å…³é”®è¯\u0026#34; --- life/_index.md 1 2 3 4 5 --- title: \u0026#34;ğŸ– ç”Ÿæ´»\u0026#34; # description: \u0026#34;\u0026#34; hidemeta: true # æ˜¯å¦éšè—æ–‡ç« çš„å…ƒä¿¡æ¯ï¼Œå¦‚å‘å¸ƒæ—¥æœŸã€ä½œè€…ç­‰ --- read/_index.md 1 2 3 4 5 --- title: \u0026#34;ğŸ“• é˜…è¯»\u0026#34; # description: hidemeta: true # æ˜¯å¦éšè—æ–‡ç« çš„å…ƒä¿¡æ¯ï¼Œå¦‚å‘å¸ƒæ—¥æœŸã€ä½œè€…ç­‰ --- site/_index.md 1 2 3 4 5 --- title: \u0026#34;ğŸ“‹ å»ºç«™\u0026#34; # description: hidemeta: true # æ˜¯å¦éšè—æ–‡ç« çš„å…ƒä¿¡æ¯ï¼Œå¦‚å‘å¸ƒæ—¥æœŸã€ä½œè€…ç­‰ --- tech/_index.md 1 2 3 4 5 --- title: \u0026#34;ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯\u0026#34; # description: \u0026#34;\u0026#34; hidemeta: true # æ˜¯å¦éšè—æ–‡ç« çš„å…ƒä¿¡æ¯ï¼Œå¦‚å‘å¸ƒæ—¥æœŸã€ä½œè€…ç­‰ --- éƒ¨ç½²åˆ° Github å†™å®Œåšå®¢åæœ¬åœ°é¢„è§ˆï¼šhugo server -Dï¼Œæµè§ˆå™¨æ‰“å¼€ï¼šhttp://localhost:1313/ è®¿é—®ã€‚\nè¾“å…¥hugo -Dç”Ÿæˆpublicæ–‡ä»¶å¤¹ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹å¯ä»¥éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨æˆ–è€…æ‰˜ç®¡åˆ°githubä¸Šã€‚\nâš ï¸æ³¨æ„ï¼šè¿™ç§ç”Ÿæˆæ–¹å¼åªä¼šå¾€ public æ–‡ä»¶å¤¹é‡Œæ·»åŠ å†…å®¹ï¼Œä½†æ˜¯ä¸ä¼šåˆ é™¤å¤–éƒ¨å·²ç»ä¸å­˜åœ¨è€Œ public é‡Œé¢è¿˜å­˜åœ¨çš„æ–‡ä»¶ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç”¨hugo -F --cleanDestinationDirå‘½ä»¤ï¼Œè¡¨ç¤ºæ¯æ¬¡ç”Ÿæˆçš„publicéƒ½æ˜¯å…¨æ–°çš„ï¼Œä¼šè¦†ç›–åŸæ¥çš„ã€‚\nå°† public æ–‡ä»¶å¤¹ä¸Šä¼ åˆ°æ­¥éª¤1ä¸­çš„ username.github.io ä»“åº“ä¸­\n1 2 3 4 5 6 7 cd public git init git add . git commit -m \u0026#34;first commit\u0026#34; git branch -M main git remote add origin git@github.com:xxx/xxx.github.io.git git push -u origin main å‡ åç§’é’Ÿåï¼Œå³å¯é€šè¿‡ Github åŸŸåè®¿é—®ï¼Œä¾‹å¦‚æˆ‘çš„ Github åšå®¢åŸŸåä¸ºï¼šhttps://kdjlyy.github.io/\n","permalink":"https://kdjlyy.cn/posts/site/hugo-papermod-configure/","summary":"hugo, papermod, ä¸»é¢˜é…ç½®","title":"Hugoä¸»é¢˜é…ç½®åŠGithubéƒ¨ç½²"},{"content":"å‰è¨€ ä¸€ç›´æƒ³æ­å»ºä¸€ä¸ªè®°å½•è‡ªå·±å­¦ä¹ ä¸ç”Ÿæ´»çš„åšå®¢ï¼Œæ–­æ–­ç»­ç»­å°è¯•è¿‡å¾ˆå¤šç§æ–¹æ¡ˆï¼Œä¾‹å¦‚åŸºäº Typecho æˆ– Wordpress çš„åŠ¨æ€åšå®¢ï¼ŒåŸºäº Hexo + Coding çš„é™æ€åšå®¢ã€‚\nå…¶ä¸­åŸºäº Wordpress æ­å»ºåŠ¨æ€åšå®¢åœ¨äº’è”ç½‘ä¸Šçš„æ¯”ä¾‹å¾ˆå¤§ï¼Œæœ‰æµ·é‡çš„æ¨¡ç‰ˆå’Œä¸°å¯Œçš„æ•™ç¨‹ã€‚Typecho å’Œ Wordpress ç±»ä¼¼ï¼Œåªæ˜¯å‰è€…æ›´åŠ è½»é‡çº§ï¼Œç•Œé¢æ›´åŠ ç®€æ´ï¼Œç†è®ºä¸ŠåŠ è½½é€Ÿåº¦æ›´å¿«ã€‚Wordpress çš„åŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼Œå¯ä»¥ç”¨äºæ­å»ºè®ºå›ã€è´­ç‰©ç½‘ç«™ç­‰ï¼Œä¸ªäººè§‰å¾—åªç”¨æ¥å†™æŠ€æœ¯åšå®¢æœ‰ç‚¹å¤§æå°ç”¨äº†ã€‚å› ä¸ºä¸æƒ³èŠ±è´¹å¾ˆå¤šç²¾åŠ›åœ¨åšå®¢ç½‘ç«™çš„æ’ç‰ˆã€æ ·å¼ç­‰åŠŸèƒ½ä¸Šï¼Œæ›´æƒ³ä¸“æ³¨äºå†™æ–‡ç« æœ¬èº«ï¼Œæ‰€ä»¥ä¹‹å‰ä½¿ç”¨è¿‡è¾ƒé•¿æ—¶é—´çš„ Typecho åšå®¢ã€‚\nä½†æ˜¯åŠ¨æ€åšå®¢çš„ä¼˜ç‚¹å’Œç¼ºç‚¹éƒ½å¾ˆæ˜æ˜¾ï¼ŒåŠ¨æ€åšå®¢å¯ä»¥æä¾›è¯¸å¦‚åœ¨çº¿å‘å¸ƒã€æ•°æ®ç»Ÿè®¡ã€ç”¨æˆ·æ³¨å†Œç­‰ä¸€ç³»åˆ—åœ¨çº¿æœåŠ¡ï¼Œä½†æ˜¯éœ€è¦éƒ¨ç½²åœ¨äº‘æœåŠ¡å™¨ä¸Šï¼Œä¸€èˆ¬éœ€è¦æ­é…åŸŸåä½¿ç”¨ã€‚ç„¶è€Œä¸ªäººå¹¶ä¸å¸¸ç”¨ä»¥ä¸Šçš„åœ¨çº¿æœåŠ¡ï¼Œæ‰€ä»¥æ›´å€¾å‘ä½¿ç”¨é™æ€åšå®¢ã€‚Hexo å’Œ Hugo çš„åŒºåˆ«ä¸å¤§ï¼Œä½†æ˜¯ Hexo éœ€è¦ nodejs ç¯å¢ƒå¹¶ä¸”åŠ è½½é€Ÿåº¦æ²¡æœ‰ Hugo å¿«ï¼Œä¼˜ç‚¹æ˜¯ Hexo çš„ä¸»é¢˜æ›´å¤šã€‚\næœ€ç»ˆæƒè¡¡ä¸‹è¿˜æ˜¯ä½¿ç”¨ Hugo + PaperModä¸»é¢˜çš„æ–¹æ¡ˆæ­å»ºäº†é™æ€åšå®¢ã€‚\næŠ€æœ¯é€‰å‹ åšå®¢æ¡†æ¶ï¼šHugo\nåšå®¢ä¸»é¢˜ï¼šPaperMod\nåšå®¢å­—ä½“ï¼šLXGW WenKaiã€JetBrains Mono\næ‰˜ç®¡å·¥å…·ï¼šGithub æˆ–äº‘æœåŠ¡å™¨\nå†™ä½œå·¥å…·ï¼šTypora\nå…è´¹å›¾åºŠï¼šé‡è§å›¾åºŠ\nä¼˜ç‚¹ï¼š\nä¸éœ€è¦è´­ä¹°äº‘æœåŠ¡å™¨å’ŒåŸŸåï¼Œç½‘ç«™æ‰˜ç®¡åœ¨ Github ä¸Šï¼ˆä¹Ÿå¯ä»¥éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨ä¸Šï¼Œç»‘å®šåŸŸåï¼‰ï¼› ç½‘ç«™åŠŸèƒ½ç®€æ´ï¼ŒåŠ è½½é€Ÿåº¦å¿«ï¼Œä¸ç”¨èŠ±è´¹ç²¾åŠ›ç»´æŠ¤ï¼› ä½¿ç”¨æœ¬åœ° Typora å†™ä½œï¼Œæ‰€è§å³æ‰€å¾—ã€‚ å¿«é€Ÿå¯åŠ¨ æ­å»ºè¿‡ç¨‹ä¸­å‚è€ƒäº†å¦‚ä¸‹åšå®¢åŠæ•™ç¨‹ï¼šSulv\u0026rsquo;s Blogã€ ç”°å°‘æ™—çš„ä¸ªäººåšå®¢ã€Memory\nå®‰è£…Hugo å®‰è£…å‰éœ€è¦å‡†å¤‡ Go å’Œ Git ç¯å¢ƒï¼Œä»¥ä¸‹æ˜¯ä¸ªäººä½¿ç”¨çš„ç¯å¢ƒï¼Œåˆé€‚çš„ç‰ˆæœ¬å³å¯ã€‚\nåŸºç¡€ç¯å¢ƒ ç‰ˆæœ¬å· ç³»ç»Ÿ MacOS Ventura 13.0 (M1 Pro) Go go version go1.17.7 darwin/amd64 Git git version 2.37.1 (Apple Git-137.1) Mac ç”¨æˆ·è¾“å…¥ï¼š\n1 brew install hugo å®‰è£…å®Œæˆåè¾“å…¥hugo versionéªŒè¯ï¼Œè‹¥å‡ºç°ç‰ˆæœ¬ä¿¡æ¯åˆ™è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚\næ–°å»ºç«™ç‚¹ æ–°å»ºç«™ç‚¹ç›®å½•kdjlyy_blogï¼Œå¹¶å°†ç«™ç‚¹é…ç½®æ–‡ä»¶æ”¹ä¸º.ymlåç¼€å†™æ³•ï¼š\n1 hugo new site kdjlyy_blog -f yml ä¼šè‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹ç›®å½•ç»“æ„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 kdjlyy_blog/ â”œâ”€â”€ archetypes/ â”‚ â””â”€â”€ default.md â”œâ”€â”€ assets/ â”œâ”€â”€ content/ â”œâ”€â”€ data/ â”œâ”€â”€ layouts/ â”œâ”€â”€ public/ â”œâ”€â”€ static/ â”œâ”€â”€ themes/ â””â”€â”€ config.yml ç›®å½•ç»“æ„è¯¦ç»†ä»‹ç»å‚è€ƒï¼šhttps://gohugo.io/getting-started/directory-structure/\nä¸‹è½½ä¸»é¢˜ åœ¨ Hugo Themes å®˜ç½‘ä¸‹è½½å–œæ¬¢çš„ä¸»é¢˜åˆ°themesæ–‡ä»¶å¤¹ï¼Œä»¥ä¸ªäººä½¿ç”¨çš„ PaperMod ä¸»é¢˜ä¸ºä¾‹ï¼š\n1 2 cd themes git clone git@github.com:adityatelange/hugo-PaperMod.git â€‹\tæŠŠæ–‡ä»¶å¤¹åç§°ç”± hugo-PaperMod æ”¹ä¸º PaperModï¼Œæ–¹ä¾¿åç»­é…ç½®ã€‚\nåœ¨ç«™ç‚¹æ–‡ä»¶å¤¹ä¸‹çš„é…ç½®æ–‡ä»¶config.yamlé‡Œé…ç½®ä¸»é¢˜ï¼š\n1 2 3 4 baseURL: \u0026#34;/\u0026#34; languageCode: \u0026#39;en-us\u0026#39; title: \u0026#39;My Blog\u0026#39; theme: \u0026#34;PaperMod\u0026#34; æ–°å»ºæ–‡ç«  åœ¨ç«™ç‚¹ç›®å½•ä¸‹ï¼Œæ–°å»ºæ–‡ç« ï¼š\n1 hugo new posts/first-blog.md æ­¤æ—¶first-blog.mdå°†è‡ªåŠ¨ç”Ÿæˆåœ¨content/postsç›®å½•ä¸‹:\n1 2 3 4 5 --- title: \u0026#34;First Blog\u0026#34; date: 2023-05-30T17:17:15+08:00 draft: false --- åœ¨åé¢ä½¿ç”¨ markdown æ ¼å¼ä¹¦å†™å³å¯ã€‚\næœ¬åœ°è¿è¡Œ åœ¨ç«™ç‚¹ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤ï¼š\n1 hugo server -D è¿›å…¥ http://localhost:1313/ å³å¯è®¿é—®ä¸ªäººä¸»é¡µã€‚\n","permalink":"https://kdjlyy.cn/posts/site/site-init/","summary":"hugo, é™æ€åšå®¢, PaperMod, å¿«é€Ÿå¯åŠ¨","title":"åŸºäºHugoæ­å»ºé™æ€åšå®¢"},{"content":"å¤§æ•° å¤§æ•°åŠ æ³• aaaa\nå¤§æ•°ä¹˜æ³• äºŒè¿›åˆ¶ è´ŸäºŒè¿›åˆ¶è½¬æ¢ https://leetcode.cn/problems/convert-to-base-2/\nè´ŸäºŒè¿›åˆ¶æ•°ç›¸åŠ  https://leetcode.cn/problems/adding-two-negabinary-numbers/solutions/2273578/fu-er-jin-zhi-shu-xiang-jia-by-leetcode-nwktq/\n","permalink":"https://kdjlyy.cn/posts/tech/algorithm-simulation/","summary":"å¤§æ•° å¤§æ•°åŠ æ³• å¤§æ•°ä¹˜æ³•","title":"å¸¸è§ç®—æ³•-æ¨¡æ‹Ÿç¯‡"},{"content":"Linuxç”¨æˆ·ç©ºé—´å†…å­˜åˆ†å¸ƒ ç¨‹åºå†…å­˜åœ¨åœ°å€ç©ºé—´ä¸­çš„åˆ†å¸ƒæƒ…å†µç§°ä¸ºå†…å­˜æ¨¡å‹ã€‚\nå¯¹äº32ä½ç¯å¢ƒï¼Œç†è®ºä¸Šç¨‹åºå¯ä»¥æ‹¥æœ‰4GBçš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œè¦æ‹¿å‡ºä¸€éƒ¨åˆ†ç»™æ“ä½œç³»ç»Ÿå†…æ ¸ä½¿ç”¨ï¼Œåº”ç”¨ç¨‹åºæ— æ³•ç›´æ¥è®¿é—®è¿™ä¸€æ®µå†…å­˜ï¼Œè¿™ä¸€éƒ¨åˆ†å†…å­˜åœ°å€è¢«ç§°ä¸ºå†…æ ¸ç©ºé—´ã€‚\nLinuxé»˜è®¤å°†é«˜åœ°å€çš„1GBç©ºé—´åˆ†é…ç»™å†…æ ¸ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåº”ç”¨ç¨‹åºåªèƒ½ä½¿ç”¨å‰©ä¸‹3GBçš„åœ°å€ç©ºé—´ï¼Œç§°ä¸ºç”¨æˆ·ç©ºé—´ã€‚\nLinuxç”¨æˆ·ç©ºé—´å†…å­˜åˆ†å¸ƒ | å†…å­˜åˆ†åŒº | è¯´æ˜| | :--------| ------- | | textæ®µï¼ˆç¨‹åºä»£ç  åŒºï¼‰ | å­˜æ”¾å·²ç¼–è¯‘ç¨‹åºçš„æœºå™¨ä»£ç ï¼Œåªè¯»ã€‚| | rodataæ®µï¼ˆå¸¸é‡åŒºï¼‰ | å­˜æ”¾ä¸€èˆ¬çš„å¸¸é‡ã€å­—ç¬¦ä¸²å¸¸é‡ç­‰ã€‚è¿™å—å†…å­˜åªæœ‰è¯»å–æƒé™ï¼Œæ²¡æœ‰å†™å…¥æƒé™ï¼Œå› æ­¤å®ƒä»¬çš„å€¼åœ¨ç¨‹åºè¿è¡ŒæœŸé—´ä¸èƒ½æ”¹å˜ã€‚ | | dataæ®µï¼ˆå…¨å±€æ•°æ®åŒºçš„å·²åˆå§‹åŒ–éƒ¨åˆ†ï¼‰ | å­˜æ”¾å·²ç»åˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡ç­‰ï¼Œè¿™å—å†…å­˜æœ‰è¯»å†™æƒé™ï¼Œå› æ­¤å®ƒä»¬çš„å€¼åœ¨ç¨‹åºè¿è¡ŒæœŸé—´å¯ä»¥ä»»æ„æ”¹å˜ã€‚ | | bssæ®µï¼ˆå…¨å±€æ•°æ®åŒºçš„æœªåˆå§‹åŒ–éƒ¨åˆ†ï¼‰ | å­˜æ”¾æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡ç­‰ã€‚| | heapï¼ˆå †åŒºï¼‰| ä¸€èˆ¬ç”±ç¨‹åºå‘˜åˆ†é…å’Œé‡Šæ”¾ï¼Œè‹¥ç¨‹åºå‘˜ä¸é‡Šæ”¾ï¼Œç¨‹åºè¿è¡Œç»“æŸæ—¶ç”±æ“ä½œç³»ç»Ÿå›æ”¶ã€‚ä¸æ•°æ®ç»“æ„ä¸­çš„å †ä¸æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œå †åŒºçš„åˆ†é…æ–¹å¼å€’æ˜¯ç±»ä¼¼äºé“¾è¡¨ã€‚ | | æ–‡ä»¶/å†…å­˜æ˜ å°„åŒºï¼ˆåŠ¨æ€é“¾æ¥åº“ï¼‰ | ç”¨äºåœ¨ç¨‹åºè¿è¡ŒæœŸé—´åŠ è½½å’Œå¸è½½åŠ¨æ€é“¾æ¥åº“ã€‚ä¾‹å¦‚ä½¿ç”¨ *mmap()* åˆ›å»ºå†…å­˜æ˜ å°„åŒºæ—¶ï¼Œå°±æ˜¯åœ¨è¿™é‡Œç”³è¯·çš„å†…å­˜ç©ºé—´ã€‚ | | stackï¼ˆæ ˆåŒºï¼‰| å­˜æ”¾å‡½æ•°çš„å‚æ•°å€¼ã€å±€éƒ¨å˜é‡çš„å€¼ç­‰ï¼Œå…¶æ“ä½œæ–¹å¼ç±»ä¼¼äºæ•°æ®ç»“æ„ä¸­çš„æ ˆã€‚ | Linuxç¨‹åºå†…å­˜ç©ºé—´ Linux ä¸‹å†…å­˜èµ„æºæ˜¯é€šè¿‡è™šæ‹Ÿå†…å­˜ç®¡ç†çš„ï¼Œåœ¨åˆ†é…å†…å­˜æ—¶å¹¶ä¸æ˜¯åœ¨ç‰©ç†å†…å­˜å¼€è¾Ÿäº†ä¸€æ®µç©ºé—´ï¼Œè€Œæ˜¯åœ¨ä½¿ç”¨æ—¶æ‰åˆ†é…çš„ï¼Œå¹¶ä¸”æ˜¯é€šè¿‡æ®µé¡µå¼ç®¡ç†ã€‚linux ä¸‹å†…å­˜åˆ†é…æ˜¯ä»¥é¡µä¸ºå•ä½çš„ï¼Œè€Œé¡µæ˜¯é€šè¿‡æ®µç®¡ç†ã€‚å„ä¸ªæ®µä¹‹é—´æ˜¯ç‹¬ç«‹çš„ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚\nLinux ç¨‹åºæ‰§è¡Œæ—¶èƒ½å¤Ÿåˆ†ä¸ºä¸‹é¢å‡ ä¸ªå†…å­˜æ®µï¼štextã€rodataã€dataã€bssã€stackã€heapã€‚\ntext æ®µï¼ˆä»£ç æ®µï¼‰ï¼štext æ®µå­˜æ”¾ç¨‹åºä»£ç ï¼Œè¿è¡Œå‰å°±å·²ç»ç¡®å®šï¼ˆç¼–è¯‘æ—¶ç¡®å®šï¼‰ï¼Œé€šå¸¸ä¸ºåªè¯»ï¼› rodata æ®µï¼ˆå¸¸é‡åŒºï¼‰ï¼šrodata æ®µå­˜å‚¨å¸¸é‡æ•°æ®ï¼Œæ¯”å¦‚ç¨‹åºä¸­å®šä¹‰ä¸º const çš„å…¨å±€å˜é‡ï¼Œâ€œ#defineâ€å®šä¹‰çš„å¸¸é‡ï¼Œä»¥åŠè¯¸å¦‚â€œHello Worldâ€çš„å­—ç¬¦ä¸²å¸¸é‡ã€‚const ä¿®é¥°çš„å…¨å±€å˜é‡åœ¨å¸¸é‡åŒºï¼Œconst ä¿®é¥°çš„å±€éƒ¨å˜é‡åªæ˜¯ä¸ºäº†é˜²æ­¢ä¿®æ”¹ï¼Œæ²¡æœ‰æ”¾å…¥å¸¸é‡åŒºï¼ˆå­˜åœ¨æ ˆåŒºï¼‰ï¼› data æ®µï¼šdata å­˜å‚¨å·²ç»åˆå§‹åŒ–çš„å…¨å±€å˜é‡ï¼ˆé™æ€å˜é‡ï¼‰ï¼Œå±äºé™æ€å†…å­˜åˆ†é…ï¼Œéœ€è¦å ç”¨å¯æ‰§è¡Œæ–‡ä»¶ç©ºé—´ï¼ˆæ³¨æ„ï¼šåˆå§‹åŒ–ä¸º0çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡è¿˜æ˜¯è¢«ä¿å­˜åœ¨ bss æ®µï¼‰ï¼› bss æ®µï¼šbss æ®µå­˜å‚¨æ²¡æœ‰åˆå§‹åŒ–æˆ–åˆå§‹åŒ–ä¸º0çš„å…¨å±€å˜é‡ï¼ˆé™æ€å˜é‡ï¼‰ï¼Œå±äºé™æ€å†…å­˜åˆ†é…ã€‚bss ä¸å ç”¨å¯æ‰§è¡Œæ–‡ä»¶ç©ºé—´ï¼Œå…¶å†…å®¹ç”±æ“ä½œç³»ç»Ÿåˆå§‹åŒ–ï¼ˆæ¸…é›¶ï¼‰ï¼Œä½†å æ®ç¨‹åºè¿è¡Œæ—¶çš„å†…å­˜ç©ºé—´ï¼› stack æ®µï¼šstack æ®µå­˜å‚¨å‚æ•°å˜é‡å’Œå±€éƒ¨å˜é‡ï¼Œç”±ç³»ç»Ÿè¿›è¡Œç”³è¯·å’Œé‡Šæ”¾ï¼Œå±äºé™æ€å†…å­˜åˆ†é…ï¼› heap æ®µï¼šheap æ®µæ˜¯ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€åˆ†é…çš„å†…å­˜æ®µï¼Œç”±ç”¨æˆ·ç”³è¯·å’Œé‡Šæ”¾ï¼Œç¨‹åºä¸­ä¸é‡Šæ”¾ï¼Œåˆ™ç¨‹åºç»“æŸæ—¶ï¼Œç”± OS å›æ”¶ã€‚ æ‰§è¡Œæ–‡ä»¶ä¸­åŒ…å«äº† textã€rodataã€data æ®µçš„å†…å®¹ï¼Œä¸åŒ…å« bss æ®µå†…å®¹ï¼ˆä¸€å †0æ”¾å…¥æ‰§è¡Œæ–‡ä»¶æ²¡æœ‰æ„ä¹‰ï¼‰ã€‚ å †å’Œæ ˆçš„å†…å­˜å¢é•¿æ–¹å‘æ˜¯ç›¸åçš„ï¼šæ ˆæ˜¯ä»é«˜åœ°å€å‘ä½åœ°å€ç”Ÿé•¿ï¼Œå †æ˜¯ä»ä½åœ°å€å‘é«˜åœ°å€ç”Ÿé•¿ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 const int NUM = 10086; // å¸¸é‡åŒº(rodataæ®µ) int a = 10; // å…¨å±€åˆå§‹åŒ–åŒºï¼ˆdataï¼‰ char *p1; // å…¨å±€æœªåˆå§‹åŒ–åŒºï¼ˆbssï¼‰ int main() { int b; // æ ˆåŒº char s[] = \u0026#34;abc\u0026#34;; // æ ˆåŒº char *p; // æ ˆåŒº p1 = (char *)malloc(10); p2 = (char *)malloc(20); // åˆ†é…å¾—æ¥çš„10å’Œ20å­—èŠ‚çš„åŒºåŸŸå°±åœ¨å †åŒº static int c =0; // bssæ®µ const int d = 5; // stackæ®µ char *p3 = \u0026#34;123456\u0026#34;; // p3åœ¨æ ˆåŒºï¼Œ\u0026#34;123456\\0\u0026#34; åœ¨rodataæ®µ strcpy(p1, \u0026#34;123456\u0026#34;); // \u0026#34;123456\\0\u0026#34; æ”¾åœ¨rodataæ®µï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šå°†å®ƒä¸p3æ‰€æŒ‡å‘çš„\u0026#34;123456\u0026#34;ä¼˜åŒ–æˆä¸€ä¸ªåœ°æ–¹ã€‚ } è™šæ‹Ÿå†…å­˜ ç‰©ç†å†…å­˜æ˜¯å®é™…çš„ç‰©ç†ç©ºé—´ï¼Œå³ç›´æ¥æ˜ å°„åˆ°ç¡¬ä»¶ RAM çš„ç‰©ç†å†…å­˜èµ„æºã€‚\nè™šæ‹Ÿå†…å­˜æ˜¯é€»è¾‘ä¸Šçš„åœ°å€ç©ºé—´ï¼Œå®ƒé€šè¿‡å°†ç‰©ç†å†…å­˜å’Œç¡¬ç›˜ç©ºé—´ç»„åˆä½¿ç”¨ï¼Œä»é€»è¾‘ä¸Šæ‰©å±•äº†ç‰©ç†å†…å­˜çš„å¤§å°ï¼Œä»è€Œè®©ç¨‹åºè·å¾—æ›´å¤šçš„å¯ç”¨å†…å­˜ã€‚\nä¸ºäº†æ›´å¥½çš„ç®¡ç†å†…å­˜ï¼Œæ“ä½œç³»ç»Ÿå°†å†…å­˜æŠ½è±¡æˆåœ°å€ç©ºé—´ã€‚æ¯ä¸ªç¨‹åºæ‹¥æœ‰è‡ªå·±çš„åœ°å€ç©ºé—´ï¼Œè¿™ä¸ªåœ°å€ç©ºé—´è¢«åˆ†å‰²æˆå¤šä¸ªé¡µï¼ˆLinuxä¸‹é¡µå¤§å°ä¸º4KBï¼Œå³4096å­—èŠ‚ï¼‰ã€‚è€Œç‰©ç†å†…å­˜åˆ™è¢«åˆ†æˆç›¸åŒå¤§å°çš„é¡µé¢å¸§ï¼Œç¨‹åºçš„é¡µè¢«æ˜ å°„åˆ°ç‰©ç†å†…å­˜å¯¹åº”çš„å¸§ï¼ˆä½†ä¸éœ€è¦æ˜ å°„åˆ°è¿ç»­çš„ç‰©ç†å†…å­˜ï¼Œä¹Ÿä¸éœ€è¦æ‰€æœ‰é¡µéƒ½å¿…é¡»åœ¨ç‰©ç†å†…å­˜ä¸­ï¼‰ã€‚å½“ç¨‹åºè®¿é—®åˆ°ä¸åœ¨ç‰©ç†å†…å­˜ä¸­çš„é¡µæ—¶ï¼Œå‘ç”Ÿç¼ºé¡µä¸­æ–­ï¼Œå°†ç¼ºå¤±çš„é¡µè£…å…¥ç‰©ç†å†…å­˜å¹¶é‡æ–°æ‰§è¡Œå¤±è´¥çš„æŒ‡ä»¤ã€‚\nä»ä¸Šé¢çš„æè¿°ä¸­å¯ä»¥çœ‹å‡ºï¼Œè™šæ‹Ÿå†…å­˜å…è®¸ç¨‹åºä¸ç”¨å°†åœ°å€ç©ºé—´ä¸­çš„æ¯ä¸€é¡µéƒ½æ˜ å°„åˆ°ç‰©ç†å†…å­˜ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªç¨‹åºä¸éœ€è¦å…¨éƒ¨è°ƒå…¥å†…å­˜å°±å¯ä»¥è¿è¡Œï¼Œè¿™ä½¿å¾—æœ‰é™çš„å†…å­˜è¿è¡Œå¤§ç¨‹åºæˆä¸ºå¯èƒ½ã€‚ä¾‹å¦‚æœ‰ä¸€å°è®¡ç®—æœºå¯ä»¥äº§ç”Ÿ16ä½åœ°å€ï¼Œé‚£ä¹ˆä¸€ä¸ªç¨‹åºçš„åœ°å€ç©ºé—´èŒƒå›´æ˜¯0~64Kã€‚è¯¥è®¡ç®—æœºåªæœ‰32KBçš„ç‰©ç†å†…å­˜ï¼Œè™šæ‹Ÿå†…å­˜æŠ€æœ¯å…è®¸è¯¥è®¡ç®—æœºè¿è¡Œä¸€ä¸ª64Kå¤§å°çš„ç¨‹åºã€‚\nè™šæ‹Ÿå†…å­˜ new/delete å’Œ malloc/free new å’Œ delete æ˜¯ç”¨æˆ·è¿›è¡ŒåŠ¨æ€å†…å­˜ç”³è¯·å’Œé‡Šæ”¾çš„æ“ä½œç¬¦ï¼Œoperator new å’Œ operator delete æ˜¯ç³»ç»Ÿæä¾›çš„å…¨å±€å‡½æ•°ï¼Œnew åœ¨åº•å±‚è°ƒç”¨ operator new å…¨å±€å‡½æ•°æ¥ç”³è¯·ç©ºé—´ï¼Œdelete åœ¨åº•å±‚é€šè¿‡ operator delete å…¨å±€å‡½æ•°æ¥é‡Šæ”¾ç©ºé—´ã€‚\nnewçš„è¿‡ç¨‹\nè°ƒç”¨ operator new å‡½æ•°ç”³è¯·ç©ºé—´ï¼› åœ¨ç”³è¯·çš„ç©ºé—´ä¸Šæ‰§è¡Œæ„é€ å‡½æ•°ï¼Œå®Œæˆå¯¹è±¡çš„æ„é€ ã€‚ deleteçš„è¿‡ç¨‹\nåœ¨ç”³è¯·çš„ç©ºé—´ä¸Šæ‰§è¡Œææ„å‡½æ•°ï¼Œå®Œæˆå¯¹è±¡ä¸­èµ„æºçš„æ¸…ç†å·¥ä½œï¼› è°ƒç”¨ operator delete å‡½æ•°é‡Šæ”¾å¯¹è±¡çš„ç©ºé—´ã€‚ new T[N]çš„è¿‡ç¨‹\nè°ƒç”¨ operator new[] å‡½æ•°ï¼Œåœ¨ operator new[] ä¸­å®é™…è°ƒç”¨ operator new å‡½æ•°å®ŒæˆNä¸ªå¯¹è±¡ç©ºé—´çš„ç”³è¯·ï¼› åœ¨ç”³è¯·çš„ç©ºé—´ä¸Šæ‰§è¡ŒNæ¬¡æ„é€ å‡½æ•°ã€‚ delete[]çš„è¿‡ç¨‹\nåœ¨é‡Šæ”¾çš„å¯¹è±¡ç©ºé—´ä¸Šæ‰§è¡ŒNæ¬¡ææ„å‡½æ•°ï¼Œå®ŒæˆNä¸ªå¯¹è±¡ä¸­èµ„æºçš„æ¸…ç†ï¼› è°ƒç”¨ operator delete[] é‡Šæ”¾ç©ºé—´ï¼Œå®é™…åœ¨ operator delete[] ä¸­è°ƒç”¨ operator delete æ¥é‡Šæ”¾ç©ºé—´ã€‚ new/delete å’Œ malloc/freeçš„å¼‚åŒ ç›¸åŒç‚¹æ˜¯: éƒ½æ˜¯ä»å †ä¸Šç”³è¯·ç©ºé—´ï¼Œå¹¶ä¸”éœ€è¦ç”¨æˆ·æ‰‹åŠ¨é‡Šæ”¾ã€‚\nä¸åŒç‚¹æ˜¯:\nmalloc å’Œ free æ˜¯å‡½æ•°ï¼Œnew å’Œ delete æ˜¯æ“ä½œç¬¦ï¼› malloc ç”³è¯·çš„ç©ºé—´ä¸ä¼šåˆå§‹åŒ–ï¼Œnew å¯ä»¥åˆå§‹åŒ–ï¼› malloc ç”³è¯·ç©ºé—´æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨è®¡ç®—ç©ºé—´å¤§å°å¹¶ä¼ é€’ï¼Œnew åªéœ€åœ¨å…¶åè·Ÿä¸Šç©ºé—´çš„ç±»å‹å³å¯ï¼› malloc çš„è¿”å›å€¼ä¸º void*, åœ¨ä½¿ç”¨æ—¶å¿…é¡»å¼ºè½¬ï¼›new ä¸éœ€è¦ï¼Œå› ä¸º new åè·Ÿçš„æ˜¯ç©ºé—´çš„ç±»å‹ï¼› malloc ç”³è¯·ç©ºé—´å¤±è´¥æ—¶ï¼Œè¿”å›çš„æ˜¯ NULLï¼Œå› æ­¤ä½¿ç”¨æ—¶å¿…é¡»åˆ¤ç©ºï¼›new ä¸éœ€è¦ï¼Œä½†æ˜¯ new éœ€è¦æ•è·å¼‚å¸¸ï¼› ç”³è¯·è‡ªå®šä¹‰ç±»å‹å¯¹è±¡æ—¶ï¼Œmalloc/free åªä¼šå¼€è¾Ÿä¸é”€æ¯ç©ºé—´ï¼Œä¸ä¼šè°ƒç”¨æ„é€ å‡½æ•°ä¸ææ„å‡½æ•°ï¼›è€Œ new åœ¨ç”³è¯·ç©ºé—´åä¼šè°ƒç”¨æ„é€ å‡½æ•°å®Œæˆå¯¹è±¡çš„åˆå§‹åŒ–ï¼Œdelete åœ¨é‡Šæ”¾ç©ºé—´å‰ä¼šè°ƒç”¨ææ„å‡½æ•°å®Œæˆç©ºé—´ä¸­èµ„æºçš„æ¸…ç†ï¼› new/delete æ¯” malloc/free çš„æ•ˆç‡ç¨å¾®ä½ç‚¹ï¼Œå› ä¸º new/delete çš„åº•å±‚å°è£…äº† malloc/freeã€‚ free å¦‚ä½•çŸ¥é“è¦ free å¤šå¤§çš„ç©ºé—´ malloc å‡½æ•°çš„å®ç°æ˜¯ä»¥å—åˆ†é…å†…å­˜ï¼Œåœ¨è¢«åˆ†é…çš„å—ä¸­åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼š\nç¬¬ä¸€éƒ¨åˆ†ä¸­å­˜å‚¨å«æœ‰æŠ¥å¤´çš„å…ƒæ•°æ®ï¼Œå®ƒå…¶ä¸­åŒ…å«æœ‰åˆ†é…å—çš„å¤§å°ä¿¡æ¯ï¼Œæ˜¯ä¸€ä¸ªå¸¸é‡ï¼› ç¬¬äºŒéƒ¨åˆ†ä¸­å­˜å‚¨å®é™…ç”¨æˆ·æ•°æ®ã€‚è€Œä½¿ç”¨ malloc åˆ†é…å†…å­˜è¿”å›çš„æ˜¯ç¬¬äºŒéƒ¨åˆ†ç”¨æˆ·æ•°æ®çš„åœ°å€ã€‚ æ‰€ä»¥å†…å­˜é‡Šæ”¾æ—¶ä¸å†éœ€è¦å†æŒ‡å®šé‡Šæ”¾å¤šå¤§çš„å†…å­˜ç©ºé—´ï¼Œåªéœ€è¦æŒ‡å®šè¯¥å—å†…å­˜ç©ºé—´çš„é¦–åœ°å€å³å¯ã€‚\nnew ä¸€ä¸ªå¯¹è±¡æ—¶åŠ æ‹¬å·å’Œä¸åŠ æ‹¬å·çš„åŒºåˆ« å¯¹äºå†…ç½®ç±»å‹ï¼š\nint *a = new int; ä¸ä¼šå°†ç”³è¯·åˆ°çš„ int ç©ºé—´åˆå§‹åŒ–ï¼Œè€Œ int *a = new int(); åˆ™ä¼šå°†ç”³è¯·åˆ°çš„ int ç©ºé—´åˆå§‹åŒ–ä¸º0ã€‚\n1 2 int *a1 = new int[10]; // 10ä¸ªæœªåˆå§‹åŒ–int int *a2 = new int[10](); // 10ä¸ªå€¼åˆå§‹åŒ–ä¸º0çš„int å¯¹äºè‡ªå®šä¹‰ç±»ç±»å‹ï¼š\nå¦‚æœè¯¥ç±»æ˜¾å¼å®šä¹‰äº†é»˜è®¤æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆ class c = new class; å’Œ class c = new class(); ä¸€æ ·ï¼Œéƒ½ä¼šè°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°ã€‚\nå¦‚æœè¯¥ç±»æ²¡æœ‰æ˜¾å¼å®šä¹‰æ„é€ å‡½æ•°ï¼ˆç”±ç¼–è¯‘å™¨ç”Ÿæˆé»˜è®¤æ„é€ å‡½æ•°ï¼‰ä½†æœ‰è™šå‡½æ•°ï¼Œé‚£ä¹ˆ class c = new class; å’Œ class c = new class(); ä¸€æ ·ï¼Œéƒ½ä¼šè°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°ï¼›\nå¦‚æœè¯¥ç±»æ²¡æœ‰æ˜¾å¼å®šä¹‰æ„é€ å‡½æ•°ï¼ˆç”±ç¼–è¯‘å™¨ç”Ÿæˆé»˜è®¤æ„é€ å‡½æ•°ï¼‰ä¹Ÿæ²¡æœ‰è™šå‡½æ•°ï¼Œé‚£ä¹ˆ class c = new class å°†ä¸è°ƒç”¨åˆæˆçš„é»˜è®¤æ„é€ å‡½æ•°ï¼Œè€Œ class c = new class() åˆ™ä¼šè°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°ã€‚\nmalloc/free å®ç°åŸç† brk å’Œ mmap å‡½æ•° brk() å’Œ sbrk() å‡½æ•°ï¼šä½œç”¨æ˜¯æ‰©å±• heap çš„ä¸Šç•Œ brk\n1 2 3 4 5 // addrä¸ºæ–°çš„brkåœ°å€ï¼ŒæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1 int brk(const void *addr); // incrä¸ºéœ€è¦ç”³è¯·çš„å†…å­˜å¤§å°ï¼Œè¿”å›heapæ–°çš„ä¸Šç•Œbrkåœ°å€ã€‚è‹¥sbrkçš„å‚æ•°ä¸º0ï¼Œåˆ™è¿”å›åŸæ¥çš„brkåœ°å€ void* sbrk (intptr_t incr); mmap() å’Œ munmap() å‡½æ•°ï¼šæ˜ å°„ç£ç›˜æ–‡ä»¶åˆ°å†…å­˜ä¸­æˆ–åŒ¿åæ˜ å°„ï¼ˆå‘æ˜ å°„åŒºç”³è¯·ä¸€å—å†…å­˜ï¼‰\n1 2 3 4 5 6 7 // addrä¸ºæ˜ å°„åŒºçš„å¼€å§‹åœ°å€ï¼Œlengthä¸ºæ˜ å°„åŒºçš„é•¿åº¦ï¼Œprotä¸ºæœŸæœ›çš„å†…å­˜ä¿æŠ¤æ ‡å¿—ï¼Œ // flagsæŒ‡å®šæ˜ å°„å¯¹è±¡çš„ç±»å‹ï¼Œfdä¸ºæ–‡ä»¶æè¿°ç¬¦ï¼Œoffsetä¸ºæ–‡ä»¶æ˜ å°„çš„åç§»é‡ï¼Œé€šå¸¸è®¾ç½®ä¸º0ï¼Œ // ä»£è¡¨ä»æ–‡ä»¶æœ€å‰æ–¹å¼€å§‹å¯¹åº”ï¼Œoffsetå¿…é¡»æ˜¯åˆ†é¡µå¤§å°çš„æ•´æ•°å€ void *mmap(void *addr, size_t length, int prot, int flags, int fd, off_t offset); // munmapæ‰§è¡Œä¸mmapç›¸åçš„æ“ä½œï¼Œåˆ é™¤ç‰¹å®šåœ°å€åŒºåŸŸçš„å¯¹è±¡æ˜ å°„ int munmap(void *addr, size_t length); å®ç°åŸç† malloc ç”³è¯·å†…å­˜çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸¤ç§æ–¹å¼å‘æ“ä½œç³»ç»Ÿç”³è¯·å †å†…å­˜ã€‚\næ–¹å¼ä¸€ï¼šå¦‚æœç”¨æˆ·åˆ†é…çš„å†…å­˜ $\u0026lt;128 KB$ï¼Œåˆ™é€šè¿‡ brk() ç³»ç»Ÿè°ƒç”¨ä»å †åˆ†é…å†…å­˜ï¼›\næ–¹å¼äºŒï¼šå¦‚æœç”¨æˆ·åˆ†é…çš„å†…å­˜ $\\geq128 KB$ï¼Œåˆ™é€šè¿‡ mmap() ç³»ç»Ÿè°ƒç”¨åœ¨æ–‡ä»¶/å†…å­˜æ˜ å°„åŒºåŸŸåˆ†é…å†…å­˜ã€‚\nbrk æ˜¯å°† heap çš„ä¸Šç•ŒæŒ‡é’ˆ brk å¾€é«˜åœ°å€æ¨ï¼Œmmap æ˜¯åœ¨è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­ï¼ˆå †å’Œæ ˆä¸­é—´ï¼Œç§°ä¸ºå†…å­˜/æ–‡ä»¶æ˜ å°„åŒºåŸŸçš„åœ°æ–¹ï¼‰æ‰¾ä¸€å—ç©ºé—²çš„è™šæ‹Ÿå†…å­˜ã€‚ è¿™ä¸¤ç§æ–¹å¼åˆ†é…çš„éƒ½æ˜¯è™šæ‹Ÿå†…å­˜ï¼Œæ²¡æœ‰åˆ†é…ç‰©ç†å†…å­˜ã€‚åœ¨ç¬¬ä¸€æ¬¡è®¿é—®å·²åˆ†é…çš„è™šæ‹Ÿåœ°å€ç©ºé—´çš„æ—¶å€™ï¼Œå‘ç”Ÿç¼ºé¡µä¸­æ–­ï¼Œæ“ä½œç³»ç»Ÿè´Ÿè´£åˆ†é…ç‰©ç†å†…å­˜ï¼Œç„¶åå»ºç«‹è™šæ‹Ÿå†…å­˜å’Œç‰©ç†å†…å­˜ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚\nbrk åˆ†é…çš„å†…å­˜éœ€è¦ç­‰åˆ°é«˜åœ°å€å†…å­˜é‡Šæ”¾ä»¥åæ‰èƒ½é‡Šæ”¾ï¼ˆè¿™å°±æ˜¯å†…å­˜ç¢ç‰‡äº§ç”Ÿçš„åŸå› ï¼‰ï¼Œå½“æœ€é«˜åœ°å€ç©ºé—´çš„ç©ºé—²å†…å­˜è¶…è¿‡128Kï¼ˆå¯ç”± M_TRIM_THRESHOLD é€‰é¡¹è°ƒèŠ‚ï¼‰æ—¶ï¼Œæ‰§è¡Œå†…å­˜ç´§ç¼©æ“ä½œï¼ˆtrimï¼‰ã€‚ mmap åˆ†é…çš„å†…å­˜å¯ä»¥å•ç‹¬é‡Šæ”¾ã€‚\nbrkå’Œmmap è°ƒç”¨ free(A) å A å¯¹åº”çš„è™šæ‹Ÿå†…å­˜å’Œç‰©ç†å†…å­˜éƒ½æ²¡æœ‰é‡Šæ”¾ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ª brk æŒ‡é’ˆï¼Œå¦‚æœå¾€å›æ¨ï¼Œé‚£ä¹ˆ B è¿™å—å†…å­˜æ€ä¹ˆåŠå‘¢ï¼Ÿ å½“ç„¶ A è¿™å—å†…å­˜æ˜¯å¯ä»¥é‡ç”¨çš„ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™å†æ¥ä¸€ä¸ª 40KB çš„è¯·æ±‚ï¼Œé‚£ä¹ˆ malloc å¾ˆå¯èƒ½å°±ä½¿ç”¨ A è¿™å—å†…å­˜ã€‚ è¿›ç¨‹è°ƒç”¨ free(B) ä»¥åï¼ŒA å’Œ B è¿æ¥èµ·æ¥ï¼Œå˜æˆä¸€å— 150KB çš„ç©ºé—²å†…å­˜ï¼Œäºæ˜¯å†…å­˜ç´§ç¼©ã€‚\nmalloc é‡‡ç”¨äº†å†…å­˜æ± çš„å®ç°æ–¹å¼ï¼šå…ˆç”³è¯·ä¸€å¤§å—å†…å­˜ï¼Œç„¶åå°†å†…å­˜åˆ†æˆä¸åŒå¤§å°çš„å†…å­˜å—ï¼Œç”¨æˆ·ç”³è¯·å†…å­˜æ—¶ï¼Œç›´æ¥ä»å†…å­˜æ± ä¸­é€‰æ‹©ä¸€å—ç›¸è¿‘çš„å†…å­˜å—å³å¯ã€‚brk åˆ†é…å†…å­˜æ—¶ä¼˜å…ˆä»å†…å­˜æ± è·å–ï¼Œå¤±è´¥çš„è¯èµ° brk ç³»ç»Ÿè°ƒç”¨ã€‚ç»†èŠ‚å‚è€ƒï¼šç®€ä¹¦ï¼šglibcå†…å­˜ç®¡ç†é‚£äº›äº‹å„¿\næ—¢ç„¶å †å†…å†…å­˜ brk å’Œ sbrk ä¸èƒ½ç›´æ¥é‡Šæ”¾ï¼Œå¯¼è‡´ç–‘ä¼¼â€œå†…å­˜æ³„éœ²â€é—®é¢˜ï¼Œä¸ºä»€ä¹ˆä¸å…¨éƒ¨ä½¿ç”¨ mmap æ¥åˆ†é…ï¼Œmunmap ç›´æ¥é‡Šæ”¾ï¼Œè€Œæ˜¯ä»…ä»…å¯¹äºå¤§äº 128K çš„å¤§å—å†…å­˜æ‰ä½¿ç”¨ mmapï¼Ÿ\nå› ä¸º brk å’Œ mmap éƒ½æ˜¯ç³»ç»Ÿè°ƒç”¨ï¼Œé¢‘ç¹è°ƒç”¨ç³»ç»Ÿè°ƒç”¨éƒ½æ¯”è¾ƒæ¶ˆè€—ç³»ç»Ÿèµ„æºã€‚ä½¿ç”¨ mmap ç”³è¯·çš„ç©ºé—´ï¼Œç›´æ¥è°ƒç”¨ munmap æ˜¯å°†ç©ºé—´çœŸæ­£é‡Šæ”¾äº†ï¼Œè€Œ brk é‡Šæ”¾çš„ç©ºé—´ï¼Œå¹¶ä¸ä¸€å®šçœŸæ­£é‡Šæ”¾äº†ï¼Œé‚£äº›æ²¡æœ‰è¢«çœŸæ­£é‡Šæ”¾çš„å†…å­˜ç¢ç‰‡å¯ä»¥è¢«é‡å¤åˆ©ç”¨ï¼Œå†æ¬¡è®¿é—®è¯¥å†…å­˜å¯èƒ½ä¸éœ€äº§ç”Ÿä»»ä½•ç³»ç»Ÿè°ƒç”¨å’Œç¼ºé¡µä¸­æ–­ï¼Œè¿™å°†å¤§å¤§é™ä½ CPU çš„æ¶ˆè€—ã€‚\nmalloc å’Œ tcmalloc malloc å’Œ tcmalloc éƒ½æ˜¯å†…å­˜åˆ†é…åº“ï¼Œä¸»è¦çš„ä¸åŒåœ¨äºå®ç°æ–¹å¼å’Œæ•ˆç‡ã€‚\nmalloc æ˜¯Cæ ‡å‡†åº“ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯ç³»ç»Ÿæä¾›çš„å†…å­˜åˆ†é…å™¨ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ç®¡ç†è¿›ç¨‹è™šæ‹Ÿå†…å­˜ç©ºé—´ï¼Œè´Ÿè´£åˆ†é…å’Œé‡Šæ”¾å†…å­˜èµ„æºã€‚ä½†æ˜¯ï¼Œç”±äºå¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œæ—¶éœ€è¦åŠ é”ï¼Œæ‰€ä»¥å®ƒçš„æ€§èƒ½å¹¶ä¸æ˜¯æœ€ä¼˜çš„ã€‚ tcmalloc æ˜¯ Google å¼€å‘çš„ä¸€ä¸ªé«˜æ€§èƒ½ã€å¤šçº¿ç¨‹çš„å†…å­˜ç®¡ç†åº“ï¼Œæ˜¯ malloc çš„æ›¿ä»£å“ä¹‹ä¸€ã€‚tcmalloc é‡‡ç”¨çº¿ç¨‹æœ¬åœ°ç¼“å­˜æŠ€æœ¯ï¼ˆThread-Caching Mallocï¼ŒTCMallocï¼‰ï¼Œé¿å…äº†é”çš„ç«äº‰ï¼Œä»è€Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å…·æœ‰æ›´å¥½çš„æ€§èƒ½è¡¨ç°ã€‚æ­¤å¤–ï¼Œtcmalloc è¿˜ä¼šå°†æœªä½¿ç”¨çš„é¡µé¢è®¾ç½®ä¸ºâ€œdirtyâ€çŠ¶æ€ï¼Œæé«˜ç¼“å­˜å‘½ä¸­ç‡ï¼Œè¿›ä¸€æ­¥æå‡äº†å…¶æ•ˆç‡ã€‚ æ€»çš„æ¥è¯´ï¼Œtcmalloc æ¯” malloc å…·æœ‰æ›´é«˜çš„æ€§èƒ½å’Œæ›´å¥½çš„å¯æ‰©å±•æ€§ï¼Œåœ¨å¤§å‹é«˜å¹¶å‘çš„åº”ç”¨åœºæ™¯ä¸­ä½¿ç”¨æ›´ä¸ºé€‚åˆã€‚ä½†æ˜¯ï¼Œtcmalloc ä¹Ÿç›¸å¯¹è¾ƒå¤æ‚ï¼Œéœ€è¦ç»“åˆå®é™…æƒ…å†µè¿›è¡Œä½¿ç”¨å’Œä¼˜åŒ–ã€‚\nå‚è€ƒï¼šå†…å­˜ä¼˜åŒ–æ€»ç»“:ptmallocã€tcmallocå’Œjemallocã€ptmallocã€tcmallocä¸jemallocå¯¹æ¯”åˆ†æ\nå†…å­˜ç®¡ç†å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªå±‚æ¬¡ï¼Œè‡ªåº•å‘ä¸Šåˆ†åˆ«æ˜¯ï¼š\nå†…æ ¸å±‚ Cè¿è¡Œæ—¶åº“å±‚ï¼ˆglibc å±‚ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ç»´æŠ¤çš„å†…å­˜ç®¡ç†ç®—æ³•ï¼‰ åº”ç”¨ç¨‹åºå±‚ï¼ˆåº”ç”¨ç¨‹åºä» glibc åŠ¨æ€åˆ†é…å†…å­˜åï¼Œæ ¹æ®åº”ç”¨ç¨‹åºæœ¬èº«çš„ç¨‹åºç‰¹æ€§è¿›è¡Œä¼˜åŒ–ï¼Œæ¯”å¦‚ä½¿ç”¨å¼•ç”¨è®¡æ•° std::shared_ptrï¼Œå†…å­˜æ± æ–¹å¼ç­‰ï¼‰ ç°çŠ¶ ç›®å‰å¤§éƒ¨åˆ†æœåŠ¡ç«¯ç¨‹åºä½¿ç”¨ glibc æä¾›çš„ malloc/free ç³»åˆ—å‡½æ•°ï¼Œè€Œ glibc ä½¿ç”¨çš„ ptmalloc2 åœ¨æ€§èƒ½ä¸Šè¿œè¿œå¼±åäº google çš„ tcmalloc å’Œ facebook çš„ jemallocã€‚è€Œä¸”åä¸¤è€…åªéœ€è¦ä½¿ç”¨ LD_PRELOAD ç¯å¢ƒå˜é‡å¯åŠ¨ç¨‹åºå³å¯ï¼Œç”šè‡³å¹¶ä¸éœ€è¦é‡æ–°ç¼–è¯‘ã€‚\nptmalloc2 ptmalloc2 å³æ˜¯æˆ‘ä»¬å½“å‰ä½¿ç”¨çš„ glibc malloc ç‰ˆæœ¬ã€‚\nptmalloc2 æ“ä½œ heap æ—¶ï¼Œä¸€èˆ¬å¤§å†…å­˜é‡‡ç”¨ mmapï¼Œå°å†…å­˜ä½¿ç”¨ brkã€‚\nğŸ”° ä¸»åˆ†é…åŒºå’Œéä¸»åˆ†é…åŒº\nptmalloc çš„å†…å­˜åˆ†é…å™¨ä¸­ï¼Œä¸ºäº†è§£å†³å¤šçº¿ç¨‹é”äº‰å¤ºé—®é¢˜ï¼Œåˆ†ä¸ºä¸»åˆ†é…åŒºï¼ˆmain_areaï¼‰å’Œéä¸»åˆ†é…åŒºï¼ˆno_main_areaï¼‰ã€‚\næ¯ä¸ªè¿›ç¨‹æœ‰ä¸€ä¸ªä¸»åˆ†é…åŒºï¼Œä¹Ÿå¯ä»¥å…è®¸æœ‰å¤šä¸ªéä¸»åˆ†é…åŒºã€‚ ä¸»åˆ†é…åŒºå¯ä»¥ä½¿ç”¨ brk å’Œ mmap æ¥åˆ†é…å†…å­˜ï¼Œè€Œéä¸»åˆ†é…åŒºåªèƒ½ä½¿ç”¨ mmap æ¥æ˜ å°„å†…å­˜å—ï¼ˆæ‰¹å‘ç”³è¯· HEAP_MAX_SIZE å¤§å°çš„è™šæ‹Ÿå†…å­˜ï¼‰ã€‚å½“ç”¨æˆ·å‘éä¸»åˆ†é…åŒºè¯·æ±‚åˆ†é…å†…å­˜æ—¶å†åˆ‡å‰²æˆå°å—â€œé›¶å”®â€ å‡ºå»ï¼Œæ¯•ç«Ÿç³»ç»Ÿè°ƒç”¨æ˜¯ç›¸å¯¹ä½æ•ˆçš„ï¼Œç›´æ¥ä»ç”¨æˆ·ç©ºé—´åˆ†é…å†…å­˜å¿«å¤šäº†ã€‚æ‰€ä»¥ ptmalloc åœ¨å¿…è¦çš„æƒ…å†µä¸‹æ‰ä¼šè°ƒç”¨ mmap å‡½æ•°å‘æ“ä½œç³»ç»Ÿç”³è¯·è™šæ‹Ÿå†…å­˜ã€‚ éä¸»åˆ†é…åŒºçš„æ•°é‡ä¸€æ—¦å¢åŠ ï¼Œåˆ™ä¸ä¼šå‡å°‘ã€‚ ä¸»åˆ†é…åŒºå’Œéä¸»åˆ†é…åŒºå½¢æˆä¸€ä¸ªç¯å½¢é“¾è¡¨è¿›è¡Œç®¡ç†ã€‚ å½“æŸä¸€çº¿ç¨‹éœ€è¦è°ƒç”¨ malloc åˆ†é…å†…å­˜ç©ºé—´æ—¶ï¼Œè¯¥çº¿ç¨‹å…ˆæŸ¥çœ‹çº¿ç¨‹ç§æœ‰å˜é‡ä¸­æ˜¯å¦å·²ç»å­˜åœ¨ä¸€ä¸ªåˆ†é…åŒºï¼Œå¦‚æœå­˜åœ¨ï¼Œå°è¯•å¯¹è¯¥åˆ†é…åŒºåŠ é”ï¼Œå¦‚æœåŠ é”æˆåŠŸï¼Œä½¿ç”¨è¯¥åˆ†é…åŒºåˆ†é…å†…å­˜ï¼Œå¦‚æœå¤±è´¥ï¼Œè¯¥çº¿ç¨‹æœç´¢å¾ªç¯é“¾è¡¨è¯•å›¾è·å¾—ä¸€ä¸ªæ²¡æœ‰åŠ é”çš„åˆ†é…åŒºã€‚å¦‚æœæ‰€æœ‰çš„åˆ†é…åŒºéƒ½å·²ç»åŠ é”ï¼Œé‚£ä¹ˆ malloc ä¼šå¼€è¾Ÿä¸€ä¸ªæ–°çš„åˆ†é…åŒºï¼ŒæŠŠè¯¥åˆ†é…åŒºåŠ å…¥åˆ°å…¨å±€åˆ†é…åŒºå¾ªç¯é“¾è¡¨å¹¶åŠ é”ï¼Œç„¶åä½¿ç”¨è¯¥åˆ†é…åŒºè¿›è¡Œåˆ†é…å†…å­˜æ“ä½œã€‚\nåœ¨é‡Šæ”¾æ“ä½œä¸­ï¼Œçº¿ç¨‹åŒæ ·è¯•å›¾è·å¾—å¾…é‡Šæ”¾å†…å­˜å—æ‰€åœ¨åˆ†é…åŒºçš„é”ï¼Œå¦‚æœè¯¥åˆ†é…åŒºæ­£åœ¨è¢«åˆ«çš„çº¿ç¨‹ä½¿ç”¨ï¼Œåˆ™éœ€è¦ç­‰å¾…ç›´åˆ°å…¶ä»–çº¿ç¨‹é‡Šæ”¾è¯¥åˆ†é…åŒºçš„äº’æ–¥é”ä¹‹åæ‰å¯ä»¥è¿›è¡Œé‡Šæ”¾æ“ä½œã€‚\nğŸ”° chunk å†…å­˜å—çš„åŸºæœ¬ç»„ç»‡å•å…ƒ\nptmalloc é€šè¿‡ chunk çš„æ•°æ®ç»“æ„æ¥ç»„ç»‡æ¯ä¸ªå†…å­˜å•å…ƒã€‚å½“æˆ‘ä»¬ä½¿ç”¨ malloc åˆ†é…å¾—åˆ°ä¸€å—å†…å­˜çš„æ—¶å€™ï¼Œè¿™å—å†…å­˜å°±ä¼šé€šè¿‡ chunk çš„å½¢å¼è¢« glibc ç®¡ç†èµ·æ¥ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆè‡ªå·±å†™å†…å­˜æ± çš„æ—¶å€™çš„ä¸€ä¸ªå†…å­˜æ•°æ®ç»“æ„ã€‚chunk çš„ç»“æ„å¯ä»¥åˆ†ä¸ºä½¿ç”¨ä¸­çš„ chunk å’Œç©ºé—²çš„ chunkã€‚\nç©ºé—²çš„ chunk ä¼šè¢«æ”¾ç½®åˆ°ç©ºé—²çš„é“¾è¡¨ bins ä¸Šã€‚å½“ç”¨æˆ· malloc ç”³è¯·å†…å­˜çš„æ—¶å€™ï¼Œä¼šå…ˆå»æŸ¥æ‰¾ç©ºé—²é“¾è¡¨ binsä¸Šæ˜¯å¦æœ‰åˆé€‚çš„å†…å­˜ã€‚\nğŸ”° ç©ºé—²é“¾è¡¨ bins\nå½“ç”¨æˆ·ä½¿ç”¨ free å‡½æ•°é‡Šæ”¾æ‰çš„å†…å­˜ï¼Œptmalloc å¹¶ä¸ä¼šé©¬ä¸Šäº¤è¿˜ç»™æ“ä½œç³»ç»Ÿï¼Œè€Œæ˜¯è¢« ptmalloc æœ¬èº«çš„ç©ºé—²é“¾è¡¨ bins ç®¡ç†èµ·æ¥äº†ï¼Œè¿™æ ·å½“ä¸‹æ¬¡è¿›ç¨‹éœ€è¦ malloc ä¸€å—å†…å­˜çš„æ—¶å€™ï¼Œptmalloc å°±ä¼šä»ç©ºé—²çš„ bins ä¸Šå¯»æ‰¾ä¸€å—åˆé€‚å¤§å°çš„å†…å­˜å—åˆ†é…ç»™ç”¨æˆ·ä½¿ç”¨ã€‚è¿™æ ·çš„å¥½å¤„å¯ä»¥é¿å…é¢‘ç¹çš„ç³»ç»Ÿè°ƒç”¨ï¼Œé™ä½å†…å­˜åˆ†é…çš„å¼€é”€ã€‚\nptmalloc ptmalloc ä¸€å…±ç»´æŠ¤äº†128ä¸ª binã€‚æ¯ä¸ª bin éƒ½ç»´æŠ¤äº†å¤§å°ç›¸è¿‘çš„åŒå‘é“¾è¡¨çš„ chunkã€‚é€šè¿‡ä¸Šå›¾è¿™ä¸ª bins çš„åˆ—è¡¨å°±èƒ½çœ‹å‡ºï¼Œå½“ç”¨æˆ·è°ƒç”¨ malloc çš„æ—¶å€™ï¼Œèƒ½å¾ˆå¿«æ‰¾åˆ°ç”¨æˆ·éœ€è¦åˆ†é…çš„å†…å­˜å¤§å°æ˜¯å¦åœ¨ç»´æŠ¤çš„ bin ä¸Šï¼Œå¦‚æœåœ¨æŸä¸€ä¸ª bin ä¸Šï¼Œå°±å¯ä»¥é€šè¿‡åŒå‘é“¾è¡¨å»æŸ¥æ‰¾åˆé€‚çš„ chunk å†…å­˜å—ç»™ç”¨æˆ·ä½¿ç”¨ã€‚\nfast binsï¼šfast bins æ˜¯ bins çš„é«˜é€Ÿç¼“å†²åŒºï¼Œå¤§çº¦æœ‰10ä¸ªå®šé•¿é˜Ÿåˆ—ã€‚å½“ç”¨æˆ·é‡Šæ”¾ä¸€å—ä¸å¤§äº max_fastï¼ˆé»˜è®¤å€¼64Bï¼‰çš„ chunk çš„æ—¶å€™ï¼Œä¼šé»˜è®¤ä¼šè¢«æ”¾åˆ° fast bins ä¸Šã€‚å½“ç”¨æˆ·ä¸‹æ¬¡éœ€è¦ç”³è¯·å†…å­˜çš„æ—¶å€™é¦–å…ˆä¼šåˆ° fast bins ä¸Šå¯»æ‰¾æ˜¯å¦æœ‰åˆé€‚çš„ chunkã€‚ptmalloc ä¼šéå† fast binï¼Œçœ‹æ˜¯å¦æœ‰åˆé€‚çš„ chunk éœ€è¦åˆå¹¶åˆ° bins ä¸Šã€‚ unsorted binï¼šæ˜¯ bins çš„ä¸€ä¸ªç¼“å†²åŒºã€‚å½“ç”¨æˆ·é‡Šæ”¾çš„å†…å­˜å¤§äº max_fast æˆ–è€… fast bins åˆå¹¶åçš„ chunk éƒ½ä¼šè¿›å…¥ unsorted bin ä¸Šã€‚å½“ç”¨æˆ· malloc çš„æ—¶å€™ï¼Œå…ˆä¼šåˆ° unsorted bin ä¸ŠæŸ¥æ‰¾æ˜¯å¦æœ‰åˆé€‚çš„ binï¼Œå¦‚æœæ²¡æœ‰åˆé€‚çš„ binï¼Œptmalloc ä¼šå°† unsorted bin ä¸Šçš„ chunk æ”¾å…¥ bins ä¸Šï¼Œç„¶ååˆ° bins ä¸ŠæŸ¥æ‰¾åˆé€‚çš„ç©ºé—² chunkã€‚ small binsÂ å’Œ large binsï¼šsmall bins å’Œ large bins æ˜¯çœŸæ­£ç”¨æ¥æ”¾ç½® chunk åŒå‘é“¾è¡¨çš„ã€‚æ¯ä¸ª bin ä¹‹é—´ç›¸å·®8ä¸ªå­—èŠ‚ï¼Œå¹¶ä¸”é€šè¿‡ä¸Šé¢çš„è¿™ä¸ªåˆ—è¡¨ï¼Œå¯ä»¥å¿«é€Ÿå®šä½åˆ°åˆé€‚å¤§å°çš„ç©ºé—² chunkã€‚å‰64ä¸ªä¸º small bins å®šé•¿ï¼›å64ä¸ªä¸º large binsï¼Œéå®šé•¿ã€‚ Top chunkï¼šå¹¶ä¸æ˜¯æ‰€æœ‰çš„ chunk éƒ½ä¼šè¢«æ”¾åˆ° bins ä¸Šã€‚top chunk ç›¸å½“äºåˆ†é…åŒºçš„é¡¶éƒ¨ç©ºé—²å†…å­˜ï¼Œå½“ bins ä¸Šéƒ½ä¸èƒ½æ»¡è¶³å†…å­˜åˆ†é…è¦æ±‚çš„æ—¶å€™ï¼Œå°±ä¼šæ¥ top chunk ä¸Šåˆ†é…ã€‚ mmaped chunkï¼šå½“åˆ†é…çš„å†…å­˜éå¸¸å¤§ï¼ˆå¤§äºåˆ†é…é˜€å€¼ï¼Œé»˜è®¤128Kï¼‰çš„æ—¶å€™ï¼Œéœ€è¦è¢« mmap æ˜ å°„ï¼Œåˆ™ä¼šæ”¾åˆ° mmaped chunk ä¸Šï¼Œå½“é‡Šæ”¾ mmaped chunk ä¸Šçš„å†…å­˜çš„æ—¶å€™ä¼šç›´æ¥äº¤è¿˜ç»™æ“ä½œç³»ç»Ÿã€‚ âœï¸ å†…å­˜åˆ†é… malloc() çš„æµç¨‹\nmalloc()çš„æµç¨‹ è·å–åˆ†é…åŒºçš„é”ï¼Œé˜²æ­¢å¤šçº¿ç¨‹å†²çªï¼›\nè®¡ç®—å‡ºéœ€è¦åˆ†é…çš„å†…å­˜çš„ chunk å®é™…å¤§å°ï¼›\nåˆ¤æ–­chunkçš„å¤§å°ï¼Œå¦‚æœå°äº max_fastï¼ˆ64Bï¼‰ï¼Œåˆ™å– fast bins ä¸Šå»æŸ¥è¯¢æ˜¯å¦æœ‰é€‚åˆçš„ chunkï¼Œå¦‚æœæœ‰åˆ™åˆ†é…ç»“æŸï¼›\nchunk å¤§å°æ˜¯å¦å°äº512Bï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ä» small bins ä¸Šå»æŸ¥æ‰¾ chunkï¼Œå¦‚æœæœ‰åˆé€‚çš„ï¼Œåˆ™åˆ†é…ç»“æŸï¼›\nç»§ç»­ä» unsorted bins ä¸ŠæŸ¥æ‰¾ï¼š\nå¦‚æœ unsorted bins ä¸Šåªæœ‰ä¸€ä¸ª chunk å¹¶ä¸”å¤§äºå¾…åˆ†é…çš„ chunkï¼Œåˆ™è¿›è¡Œåˆ‡å‰²ï¼Œå¹¶ä¸”å‰©ä½™çš„ chunk ç»§ç»­æ‰”å› unsorted binsï¼›\nå¦‚æœ unsorted bins ä¸Šæœ‰å¤§å°å’Œå¾…åˆ†é… chunk ç›¸ç­‰çš„ï¼Œåˆ™è¿”å›ï¼Œå¹¶ä» unsorted bins åˆ é™¤ï¼›\nå¦‚æœ unsorted bins ä¸­çš„æŸä¸€ chunk å¤§å°å±äº small bins çš„èŒƒå›´ï¼Œåˆ™æ”¾å…¥ small bins çš„å¤´éƒ¨ï¼›\nå¦‚æœ unsorted bins ä¸­çš„æŸä¸€ chunk å¤§å°å±äº large bins çš„èŒƒå›´ï¼Œåˆ™æ‰¾åˆ°åˆé€‚çš„ä½ç½®æ”¾å…¥ï¼›\nä» large bins ä¸­æŸ¥æ‰¾ï¼Œæ‰¾åˆ°é“¾è¡¨å¤´åï¼Œåå‘éå†æ­¤é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§å°å¤§äºå¾…åˆ†é…çš„ chunkï¼Œç„¶åè¿›è¡Œåˆ‡å‰²ï¼Œå¦‚æœæœ‰ä½™ä¸‹çš„ï¼Œåˆ™æ”¾å…¥ unsorted bin ä¸­å»ï¼Œåˆ†é…åˆ™ç»“æŸï¼›\nå¦‚æœæœç´¢ fast bins å’Œå…¶ä»– bins éƒ½æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„ chunkï¼Œé‚£ä¹ˆå°±éœ€è¦æ“ä½œ top chunk æ¥è¿›è¡Œåˆ†é…äº†ï¼ˆtop chunk ç›¸å½“äºåˆ†é…åŒºçš„å‰©ä½™å†…å­˜ç©ºé—´ï¼‰ã€‚åˆ¤æ–­ top chunk å¤§å°æ˜¯å¦æ»¡è¶³æ‰€éœ€ chunk çš„å¤§å°ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ä» top chunk ä¸­åˆ†å‡ºä¸€å—æ¥ï¼›\nå¦‚æœ top chunk ä¹Ÿä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œåˆ™éœ€è¦æ‰©å¤§ top chunkã€‚ä¸»åˆ†åŒºä¸Šï¼Œå¦‚æœåˆ†é…çš„å†…å­˜å°äºåˆ†é…é˜€å€¼ï¼ˆé»˜è®¤128Kï¼‰ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ brk åˆ†é…ä¸€å—å†…å­˜ï¼›å¦‚æœåˆ†é…çš„å†…å­˜å¤§äºåˆ†é…é˜€å€¼ï¼Œåˆ™éœ€è¦ mmap æ¥åˆ†é…ã€‚\néä¸»åˆ†åŒºä¸Šï¼Œåˆ™ç›´æ¥ä½¿ç”¨ mmap æ¥åˆ†é…ä¸€å—å†…å­˜ã€‚é€šè¿‡ mmap åˆ†é…çš„å†…å­˜ï¼Œå°±ä¼šæ”¾å…¥ mmaped chunk ä¸Šï¼Œmmaped chunk ä¸Šçš„å†…å­˜ä¼šç›´æ¥å›æ”¶ç»™æ“ä½œç³»ç»Ÿã€‚\nâœï¸ å†…å­˜é‡Šæ”¾ free() çš„æµç¨‹\nè·å–åˆ†é…åŒºçš„é”ï¼Œä¿è¯çº¿ç¨‹å®‰å…¨ï¼›\nå¦‚æœ free çš„æ˜¯ç©ºæŒ‡é’ˆï¼Œåˆ™è¿”å›ï¼Œä»€ä¹ˆéƒ½ä¸åšï¼›\nåˆ¤æ–­å½“å‰ chunk æ˜¯å¦æ˜¯ mmap æ˜ å°„åŒºåŸŸæ˜ å°„çš„å†…å­˜ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç›´æ¥ munmap é‡Šæ”¾è¿™å—å†…å­˜ã€‚å·²ä½¿ç”¨ chunk çš„æ•°æ®ç»“æ„ä¸­ï¼Œæœ‰å¯¹åº”çš„æ ‡è¯†åˆ¤æ–­æ˜¯å¦æ˜¯ mmap æ˜ å°„çš„å†…å­˜ï¼›\nåˆ¤æ–­ chunk æ˜¯å¦ä¸ top chunk ç›¸é‚»ï¼Œå¦‚æœç›¸é‚»ï¼Œåˆ™ç›´æ¥å’Œ top chunk åˆå¹¶ï¼ˆå’Œ top chunk ç›¸é‚»ç›¸å½“äºå’Œåˆ†é…åŒºä¸­çš„ç©ºé—²å†…å­˜å—ç›¸é‚»ï¼‰ï¼Œè½¬åˆ°æ­¥éª¤8ï¼›\nå¦‚æœ chunk çš„å¤§å°å¤§äº max_fastï¼ˆ64Bï¼‰ï¼Œåˆ™æ”¾å…¥ unsorted binï¼Œå¹¶ä¸”æ£€æŸ¥æ˜¯å¦æœ‰åˆå¹¶ï¼Œæœ‰åˆå¹¶æƒ…å†µå¹¶ä¸”å’Œ top chunk ç›¸é‚»ï¼Œåˆ™è½¬åˆ°æ­¥éª¤8ï¼›æ²¡æœ‰åˆå¹¶æƒ…å†µåˆ™ freeï¼›\nå¦‚æœ chunk çš„å¤§å°å°äº max_fastï¼ˆ64Bï¼‰ï¼Œåˆ™ç›´æ¥æ”¾å…¥ fast binï¼Œfast bin å¹¶æ²¡æœ‰æ”¹å˜ chunk çš„çŠ¶æ€ã€‚æ²¡æœ‰åˆå¹¶æƒ…å†µï¼Œåˆ™ freeï¼›æœ‰åˆå¹¶æƒ…å†µï¼Œè½¬åˆ°æ­¥éª¤7ï¼›\nåœ¨ fast binï¼Œå¦‚æœå½“å‰ chunk çš„ä¸‹ä¸€ä¸ª chunk ä¹Ÿæ˜¯ç©ºé—²çš„ï¼Œåˆ™å°†è¿™ä¸¤ä¸ª chunk åˆå¹¶ï¼Œæ”¾å…¥ unsorted bin ä¸Šé¢ã€‚åˆå¹¶åçš„å¤§å°å¦‚æœå¤§äº64KBï¼Œä¼šè§¦å‘è¿›è¡Œ fast bins çš„åˆå¹¶æ“ä½œï¼Œfast bins ä¸­çš„ chunk å°†è¢«éå†ï¼Œå¹¶ä¸ç›¸é‚»çš„ç©ºé—² chunk è¿›è¡Œåˆå¹¶ï¼Œåˆå¹¶åçš„ chunk ä¼šè¢«æ”¾åˆ° unsorted bin ä¸­ï¼Œfast bin ä¼šå˜ä¸ºç©ºã€‚åˆå¹¶åçš„ chunk å’Œ top chunk ç›¸é‚»ï¼Œåˆ™ä¼šåˆå¹¶åˆ° top chunk ä¸­ã€‚è½¬åˆ°æ­¥éª¤8ï¼›\nåˆ¤æ–­ top chunk çš„å¤§å°æ˜¯å¦å¤§äº mmap æ”¶ç¼©é˜ˆå€¼ï¼ˆé»˜è®¤ä¸º128KBï¼‰ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œå¯¹äºä¸»åˆ†é…åŒºï¼Œåˆ™ä¼šè¯•å›¾å½’è¿˜ top chunk ä¸­çš„ä¸€éƒ¨åˆ†ç»™æ“ä½œç³»ç»Ÿã€‚free ç»“æŸã€‚\nâœï¸ ptmalloc çš„é—®é¢˜\nptmalloc çš„ä¸»è¦é—®é¢˜å…¶å®æ˜¯å†…å­˜æµªè´¹ã€å†…å­˜ç¢ç‰‡ã€ä»¥åŠåŠ é”å¯¼è‡´çš„æ€§èƒ½é—®é¢˜ã€‚\nå†…å­˜æµªè´¹ï¼š\næ¯ä¸ª chunk æœ¬èº«è‡³å°‘8å­—èŠ‚çš„å¼€é”€å¾ˆå¤§ï¼›\nååˆ†é…çš„å†…å­˜å…ˆé‡Šæ”¾ï¼Œå¯èƒ½æ— æ³•åŠæ—¶å½’è¿˜ç³»ç»Ÿã€‚å› ä¸º ptmalloc æ”¶ç¼©å†…å­˜æ˜¯ä» top chunk å¼€å§‹,å¦‚æœä¸ top chunk ç›¸é‚»çš„ chunk ä¸èƒ½é‡Šæ”¾ï¼Œtop chunk ä»¥ä¸‹çš„ chunk éƒ½æ— æ³•é‡Šæ”¾ï¼›\nå†…å­˜ä¸èƒ½åœ¨çº¿ç¨‹é—´ç§»åŠ¨ï¼Œå¤šçº¿ç¨‹ä½¿ç”¨å†…å­˜ä¸å‡è¡¡å°†å¯¼è‡´å†…å­˜æµªè´¹ã€‚\nå†…å­˜ç¢ç‰‡ï¼šä¸å®šæœŸåˆ†é…é•¿ç”Ÿå‘½å‘¨æœŸçš„å†…å­˜å®¹æ˜“é€ æˆå†…å­˜ç¢ç‰‡ï¼Œä¸åˆ©äºå›æ”¶ã€‚\nåŠ é”å¯¼è‡´çš„æ€§èƒ½é—®é¢˜ï¼šåŠ é”è€—æ—¶ï¼Œæ— è®ºå½“å‰åˆ†åŒºæœ‰æ— è€—æ—¶ï¼Œåœ¨å†…å­˜åˆ†é…å’Œé‡Šæ”¾æ—¶ï¼Œä¼šé¦–å…ˆåŠ é”ã€‚\ntcmalloc tcmalloc æ˜¯ Google å¼€æºçš„ä¸€ä¸ªå†…å­˜ç®¡ç†åº“ï¼Œ ä½œä¸º glibc malloc çš„æ›¿ä»£å“ã€‚ç›®å‰å·²ç»åœ¨ chromeã€safari ç­‰çŸ¥åè½¯ä»¶ä¸­è¿ç”¨ã€‚\nğŸ”° å¯¹è±¡åˆ†é…\ntcmalloc ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…äº†ä¸€ä¸ªçº¿ç¨‹æœ¬åœ° ThreadCacheï¼Œå°å†…å­˜ä» ThreadCache åˆ†é…ï¼Œæ­¤å¤–è¿˜æœ‰ä¸ªä¸­å¤®å †ï¼ˆCentralCacheï¼‰ï¼ŒThreadCache ä¸å¤Ÿç”¨çš„æ—¶å€™ï¼Œä¼šä» CentralCacheä¸­ è·å–ç©ºé—´æ”¾åˆ° ThreadCache ä¸­ã€‚ å°å¯¹è±¡ï¼ˆ$\\leq32KB$ï¼‰ä» ThreadCache åˆ†é…ï¼Œå¤§å¯¹è±¡ä» CentralCache åˆ†é…ã€‚å¤§å¯¹è±¡åˆ†é…çš„ç©ºé—´éƒ½æ˜¯4Ké¡µé¢å¯¹é½çš„ï¼Œå¤šä¸ª pages ä¹Ÿèƒ½åˆ‡å‰²æˆå¤šä¸ªå°å¯¹è±¡åˆ’åˆ†åˆ° ThreadCache ä¸­ã€‚ âœï¸ tcmallocçš„ä¼˜åŠ¿\nå°å†…å­˜å¯ä»¥åœ¨ ThreadCache ä¸­ä¸åŠ é”åˆ†é…ï¼ˆåŠ é”çš„ä»£ä»·å¤§çº¦100nsï¼‰ å¤§å†…å­˜å¯ä»¥ç›´æ¥æŒ‰ç…§å¤§å°åˆ†é…ä¸éœ€è¦å†åƒ ptmalloc ä¸€æ ·è¿›è¡ŒæŸ¥æ‰¾ å¤§å†…å­˜åŠ é”ä½¿ç”¨æ›´é«˜æ•ˆçš„è‡ªæ—‹é” å‡å°‘äº†å†…å­˜ç¢ç‰‡ å†…å­˜å¯¹é½ ä»€ä¹ˆäº‹å†…å­˜å¯¹é½ï¼Ÿ ç°ä»£è®¡ç®—æœºä¸­å†…å­˜ç©ºé—´éƒ½æ˜¯æŒ‰ç…§å­—èŠ‚ï¼ˆbyteï¼‰åˆ’åˆ†çš„ï¼Œä»ç†è®ºä¸Šè®²ä¼¼ä¹å¯¹ä»»ä½•ç±»å‹çš„å˜é‡çš„è®¿é—®å¯ä»¥ä»ä»»ä½•åœ°å€å¼€å§‹ï¼Œä½†æ˜¯å®é™…çš„è®¡ç®—æœºç³»ç»Ÿå¯¹åŸºæœ¬ç±»å‹æ•°æ®åœ¨å†…å­˜ä¸­å­˜æ”¾çš„ä½ç½®æœ‰é™åˆ¶ï¼Œå®ƒä»¬ä¼šè¦æ±‚è¿™äº›æ•°æ®çš„é¦–åœ°å€çš„å€¼æ˜¯æŸä¸ªæ•°kï¼ˆé€šå¸¸å®ƒä¸º4æˆ–8ï¼‰çš„å€æ•°ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„å†…å­˜å¯¹é½ã€‚\nä¸ºä»€ä¹ˆå†…å­˜å¯¹é½ï¼Ÿ ä¸»è¦æ˜¯ç”±äº CPU çš„è®¿é—®å†…å­˜çš„ç‰¹æ€§å†³å®šï¼ŒCPU è®¿é—®å†…å­˜æ—¶å¹¶ä¸æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½æ¥è¯»å–å†…å­˜ï¼Œè€Œæ˜¯ä»¥æœºå™¨å­—é•¿ä¸ºå•ä½ï¼Œå®é™…æœºå™¨å­—é•¿ç”± CPU æ•°æ®æ€»çº¿å®½åº¦å†³å®šçš„ã€‚å®é™… CPU è¿è¡Œæ—¶ï¼Œæ¯ä¸€æ¬¡æ§åˆ¶å†…å­˜è¯»å†™ä¿¡å·å‘ç”Ÿæ—¶ï¼ŒCPU å¯ä»¥ä»å†…å­˜ä¸­è¯»å–æ•°æ®æ€»çº¿å®½åº¦çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†™å…¥åˆ° CPU çš„é€šç”¨å¯„å­˜å™¨ä¸­ã€‚å†…å­˜å¯¹é½çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†å‡å°‘ CPU è®¿é—®å†…å­˜çš„æ¬¡æ•°ã€‚å‡è®¾è¯»å–8ä¸ªå­—èŠ‚çš„æ•°æ®ï¼ŒæŒ‰ç…§æ¯æ¬¡è¯»å–4ä¸ªå­—èŠ‚çš„é€Ÿåº¦ï¼Œåˆ™8ä¸ªå­—èŠ‚éœ€è¦ CPU è€—è´¹2æ¬¡è¯»å–æ“ä½œã€‚CPU å§‹ç»ˆä»¥å­—é•¿è®¿é—®å†…å­˜ï¼Œå¦‚æœä¸è¿›è¡Œå†…å­˜å¯¹é½ï¼Œå¾ˆå¯èƒ½å¢åŠ  CPU è®¿é—®å†…å­˜çš„æ¬¡æ•°ã€‚\næ€ä¹ˆä½¿ç”¨å†…å­˜å¯¹é½ï¼Ÿ æˆ‘ä»¬å¯ä»¥ç”¨#progma pack(x)æŒ‡å®šç»“æ„ä½“ä»¥xä¸ºå•ä½è¿›è¡Œå¯¹é½ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 #pragma pack(push) /* push current alignment to stack */ #pragma pack(1) /* set alignment to 1 byte boundary */ struct MyPackedData { char Data1; // 1 byte long Data2; // 8 byte(64ä½ç¯å¢ƒ) char Data3; // 1 byte }; #pragma pack(pop) /* restore original alignment from stack */ int main() { cout \u0026lt;\u0026lt; alignof(MyPackedData) \u0026lt;\u0026lt; endl; // 1 cout \u0026lt;\u0026lt; sizeof(MyPackedData) \u0026lt;\u0026lt; endl; // 10 return 0; } C++11ä¹‹åæä¾›äº†alignaså…³é”®å­—ï¼Œå…è®¸å¾€æ›´å¤§çš„å­—èŠ‚æ•°å»å¯¹é½ï¼ˆæœ‰çš„å¹³å°ä¸æ”¯æŒæœªå¯¹é½å†…å­˜è®¿é—®ï¼Œalignas çš„ç›®çš„æ˜¯å…è®¸ä½ å¾€æ›´å¤§çš„å­—èŠ‚æ•°å»å¯¹é½ï¼Œæ¯”å¦‚ char å¯¹é½åˆ°32ä½ä¾› SIMD loadï¼‰ã€‚\nå³ pack æ˜¯å˜å°ï¼Œalignas æ˜¯å˜å¤§ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 struct alignas(1) Point // ä½¿ç”¨g++èƒ½æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯åœ¨CLionä¸­ä¼šæŠ¥é”™ï¼Œå› ä¸ºè¿™æ ·åšæ˜¯ä¸åˆè§„èŒƒï¼ˆill-formedï¼‰çš„ { int a; char b; }p; cout \u0026lt;\u0026lt; alignof(p) \u0026lt;\u0026lt; endl; // 4 cout \u0026lt;\u0026lt; sizeof(p) \u0026lt;\u0026lt; endl; // 8 #pragma pack(push) #pragma pack(1) struct Point2 { int a; char b; }p2; #pragma pop(pop) cout \u0026lt;\u0026lt; alignof(p2) \u0026lt;\u0026lt; endl; // 1 cout \u0026lt;\u0026lt; sizeof(p2) \u0026lt;\u0026lt; endl; // 4 ç”¨æˆ·æ€ä¸å†…æ ¸æ€ ç”¨æˆ·æ€/å†…æ ¸æ€çš„æ¦‚å¿µ CPU æŒ‡ä»¤å¯ä»¥ç›´æ¥æ“ä½œç¡¬ä»¶ï¼Œè€Œå¯¹äºç¡¬ä»¶çš„æ“ä½œæ˜¯éå¸¸å¤æ‚çš„ï¼Œå‡ºé—®é¢˜çš„å‡ ç‡ç›¸å½“å¤§ï¼Œæ‰€ä»¥æ“ä½œç³»ç»Ÿå†…æ ¸ç›´æ¥å±è”½äº†ä¸ªäººå¼€å‘è€…å¯¹äºç¡¬ä»¶æ“ä½œçš„å¯èƒ½ã€‚å› ä¸ºè¿™ä¸ªéœ€æ±‚ï¼Œç¡¬ä»¶è®¾å¤‡å•†ç›´æ¥æä¾›äº†ç¡¬ä»¶çº§åˆ«çš„æ”¯æŒï¼Œåšæ³•å°±æ˜¯å¯¹ CPU æŒ‡ä»¤è®¾ç½®äº†æƒé™ï¼Œä¸åŒçº§åˆ«çš„æƒé™å¯ä»¥ä½¿ç”¨çš„ CPU æŒ‡ä»¤æ˜¯æœ‰é™åˆ¶çš„ã€‚\nä»¥ Intel CPU ä¸ºä¾‹ï¼ŒCPU æŒ‡ä»¤æ“ä½œçš„æƒé™åˆ’ä¸º4çº§ï¼šring 0ã€ring 1ã€ring 2ã€ring 3ã€‚å…¶ä¸­ring 0æƒé™æœ€é«˜ï¼Œå¯ä»¥ä½¿ç”¨æ‰€æœ‰ CPU æŒ‡ä»¤ï¼Œring 3 æƒé™æœ€ä½ï¼Œä»…èƒ½ä½¿ç”¨å¸¸è§„ CPU æŒ‡ä»¤ï¼Œä¸èƒ½ä½¿ç”¨è®¿é—®ç¡¬ä»¶èµ„æºçš„æŒ‡ä»¤ï¼Œæ¯”å¦‚ I/Oè¯»å†™ã€ç½‘å¡è®¿é—®ã€ç”³è¯·å†…å­˜ç­‰ã€‚\nLinux ç³»ç»Ÿå†…æ ¸é‡‡ç”¨äº†ï¼šring 0 å’Œ ring 3 è¿™2ä¸ªæƒé™\nring 0 è¢«å«åš å†…æ ¸æ€ï¼Œå®Œå…¨åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­è¿è¡Œï¼Œç”±ä¸“é—¨çš„å†…æ ¸çº¿ç¨‹æ‰§è¡Œå…¶ä»»åŠ¡ï¼› ring 3 è¢«å«åš ç”¨æˆ·æ€ï¼Œåœ¨åº”ç”¨ç¨‹åºä¸­è¿è¡Œï¼Œç”±ç”¨æˆ·çº¿ç¨‹æ‰§è¡Œå…¶ä»»åŠ¡ã€‚ åˆ‡æ¢æ–¹å¼ ä»ç”¨æˆ·æ€åˆ°å†…æ ¸æ€åˆ‡æ¢å¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼ï¼Œæˆ–è€…è¯´ä¼šå¯¼è‡´ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€çš„æ“ä½œï¼š\nç³»ç»Ÿè°ƒç”¨ï¼šç³»ç»Ÿè°ƒç”¨æœ¬èº«å°±æ˜¯ä¸­æ–­ï¼Œå±äºè½¯ä»¶ä¸­æ–­ï¼Œè·Ÿç¡¬ä»¶ä¸­æ–­ä¸åŒã€‚ç³»ç»Ÿè°ƒç”¨æœºåˆ¶æ˜¯ä½¿ç”¨äº†æ“ä½œç³»ç»Ÿä¸ºç”¨æˆ·ç‰¹åˆ«å¼€æ”¾çš„ä¸€ä¸ªä¸­æ–­æ¥å®ç°ï¼Œå¦‚ Linux çš„ int 80h ä¸­æ–­ã€‚æ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨åº“å‡½æ•° fopen æ‰“å¼€æ–‡ä»¶ï¼Œå°±ä¼šè§¦å‘ open ç³»ç»Ÿè°ƒç”¨ã€‚ å¼‚å¸¸ï¼šå¦‚æœå½“å‰è¿›ç¨‹è¿è¡Œåœ¨ç”¨æˆ·æ€ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™å‘ç”Ÿäº†å¼‚å¸¸äº‹ä»¶ï¼Œä¼šè§¦å‘ç”±å½“å‰è¿è¡Œè¿›ç¨‹åˆ‡æ¢åˆ°å¤„ç†æ­¤å¼‚å¸¸çš„å†…æ ¸ç›¸å…³è¿›ç¨‹ä¸­ã€‚ å¤–å›´è®¾å¤‡ä¸­æ–­ï¼šç¡¬ä»¶ä¸­æ–­ï¼Œå¤–å›´è®¾å¤‡å®Œæˆç”¨æˆ·è¯·æ±‚çš„æ“ä½œä¹‹åï¼Œä¼šå‘ CPU å‘å‡ºä¸­æ–­ä¿¡å·ï¼Œè¿™æ—¶ CPU ä¼šè½¬å»å¤„ç†å¯¹åº”çš„ä¸­æ–­å¤„ç†ç¨‹åºã€‚ åˆ‡æ¢è¿‡ç¨‹ å½“å‘ç”Ÿç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„åˆ‡æ¢æ—¶ï¼Œä¼šå‘ç”Ÿå¦‚ä¸‹è¿‡ç¨‹ï¼ˆæœ¬è´¨ä¸Šæ˜¯ä»â€œç”¨æˆ·ç¨‹åºâ€åˆ‡æ¢åˆ°â€œå†…æ ¸ç¨‹åºâ€ï¼‰\nè®¾ç½®å¤„ç†å™¨è‡³å†…æ ¸æ€ï¼›\nä¿å­˜å½“å‰ç¨‹åºçš„å¯„å­˜å™¨ï¼ˆæ ˆæŒ‡é’ˆã€ç¨‹åºè®¡æ•°å™¨ã€é€šç”¨å¯„å­˜å™¨ï¼‰ï¼›\nå°†æ ˆæŒ‡é’ˆè®¾ç½®æŒ‡å‘å†…æ ¸æ ˆåœ°å€ï¼›\næ‰§è¡Œä¸­æ–­å¤„ç†ç¨‹åºï¼›\næ¢å¤ä¹‹å‰ä¿å­˜çš„å¯„å­˜å™¨ï¼Œä»ä¸­æ–­å¤„ç†ç¨‹åºè¿”å›ã€‚\nå…·ä½“æµç¨‹å‚è€ƒï¼šä¸­æ–­ï¼ˆç³»ç»Ÿè°ƒç”¨ï¼‰çš„å…·ä½“è¿‡ç¨‹\nä¸­æ–­ï¼ˆç³»ç»Ÿè°ƒç”¨ï¼‰çš„å…·ä½“è¿‡ç¨‹ æ€»ç»“ï¼š ç”¨æˆ·è¿è¡Œåº“å‡½æ•°ï¼ˆç³»ç»Ÿè°ƒç”¨çš„å°è£…ï¼‰ï¼Œå‡½æ•°é‡Œé¢å…¶å®æ˜¯æ‰§è¡Œçš„ int 0x80 æŒ‡ä»¤ã€‚ç³»ç»Ÿè°ƒç”¨å…ˆæŠŠç³»ç»Ÿè°ƒç”¨å·ä¿å­˜åœ¨ eax å¯„å­˜å™¨ä¸­ï¼Œç„¶åæ‰§è¡Œ int 0x80 æŒ‡ä»¤ã€‚int 0x80 æŒ‡ä»¤å…ˆè¿›è¡Œåˆ‡æ¢å †æ ˆï¼ˆæ‰¾åˆ°è¿›ç¨‹çš„å †æ ˆï¼Œå°†å¯„å­˜å™¨å€¼å‹å…¥åˆ°å†…æ ¸æ ˆä¸­ï¼Œå°† espï¼Œss è®¾ç½®æˆå¯¹åº”å†…æ ¸æ ˆçš„å€¼ï¼‰ï¼ŒæŸ¥æ‰¾ç›¸åº”ä¸­æ–­å‘é‡çš„ä¸­æ–­å¤„ç†ç¨‹åº(system_call)å¹¶è°ƒç”¨ï¼Œéšå system_call ä»ç³»ç»Ÿè°ƒç”¨è¡¨ä¸­æ‰¾åˆ°ç›¸åº”çš„ç³»ç»Ÿè°ƒç”¨è¿›è¡Œè°ƒç”¨ï¼Œè°ƒç”¨ç»“æŸåä» system_call ä¸­è¿”å›ã€‚\nä¸­æ–­ä¸€èˆ¬æœ‰ä¸¤ä¸ªå±æ€§ï¼Œä¸­æ–­å·å’Œä¸­æ–­å¤„ç†ç¨‹åºï¼ˆISRï¼ŒInterrupt Service Routineï¼‰ã€‚åœ¨å†…æ ¸ä¸­ï¼Œæœ‰ä¸€ä¸ªæ•°ç»„ç§°ä¸ºä¸­æ–­å‘é‡è¡¨ï¼ŒåŒ…å«äº†ä¸­æ–­å·åŠå…¶å¯¹åº”ä¸­æ–­å¤„ç†ç¨‹åºçš„æŒ‡é’ˆã€‚ä¸­æ–­åˆ°æ¥æ—¶ï¼ŒCPU æš‚åœå½“å‰æ‰§è¡Œçš„ä»£ç ï¼Œæ ¹æ®ä¸­æ–­çš„ä¸­æ–­å·ï¼Œåœ¨ä¸­æ–­å‘é‡è¡¨ä¸­æ‰¾åˆ°å¯¹åº”çš„ä¸­æ–­å¤„ç†ç¨‹åºï¼Œå¹¶è°ƒç”¨å®ƒã€‚ä¸­æ–­å¤„ç†ç¨‹åºæ‰§è¡Œå®Œæˆä¹‹åï¼ŒCPU ä¼šç»§ç»­æ‰§è¡Œä¹‹å‰çš„ä»£ç ã€‚\nç”±äºä¸­æ–­å·æ˜¯æœ‰é™çš„ï¼Œæ“ä½œç³»ç»Ÿä¸èˆå¾—æ¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨å¯¹åº”ä¸€ä¸ªä¸­æ–­å·ï¼Œè€Œæ›´å€¾å‘äºç”¨ä¸€ä¸ªæˆ–å°‘æ•°å‡ ä¸ªä¸­æ–­å·æ¥å¯¹åº”æ‰€æœ‰çš„ç³»ç»Ÿè°ƒç”¨ã€‚Linux åˆ™ä½¿ç”¨ int 0x80 æ¥è§¦å‘æ‰€æœ‰ç³»ç»Ÿè°ƒç”¨ã€‚æ¯ä¸ªç³»ç»Ÿè°ƒç”¨å¯¹åº”ä¸€ä»½ç³»ç»Ÿè°ƒç”¨å·ï¼Œè¿™ä¸ªç³»ç»Ÿè°ƒç”¨å·åœ¨æ‰§è¡Œ int 0x80 æŒ‡ä»¤å‰ä¼šæ”¾ç½®åœ¨æŸä¸ªå›ºå®šçš„å¯„å­˜å™¨é‡Œï¼ˆeax)ï¼Œå¯¹åº”çš„ä¸­æ–­ä»£ç ä¼šå–å¾—è¿™ä¸ªç³»ç»Ÿè°ƒç”¨å·ï¼Œå¹¶ä¸”è°ƒç”¨æ­£ç¡®çš„å‡½æ•°ã€‚\nç³»ç»Ÿè°ƒç”¨çš„è¯¦ç»†è¿‡ç¨‹ è§¦å‘ä¸­æ–­ ç”¨æˆ·ç¨‹åºåœ¨ä»£ç ä¸­è°ƒç”¨ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰§è¡Œ int æŒ‡ä»¤å‰å°†ç³»ç»Ÿè°ƒç”¨å·æ”¾å…¥ eax å¯„å­˜å™¨ä¸­ï¼Œæ‰§è¡Œ int 0x80 æŒ‡ä»¤ï¼ˆint æŒ‡ä»¤æœ€ç»ˆæ‰§è¡Œçš„å‡½æ•°æ˜¯ system_callï¼Œè¯¥å‡½æ•°éªŒè¯ç³»ç»Ÿè°ƒç”¨å·çš„æœ‰æ•ˆæ€§ï¼ŒæŸ¥æ‰¾ç³»ç»Ÿè°ƒç”¨å‡½æ•°å¹¶æ‰§è¡Œï¼Œæœ€åé€šè¿‡ itret æŒ‡ä»¤ä»ä¸­æ–­å¤„ç†ç¨‹åºè¿”å›ï¼‰ã€‚\nåˆ‡æ¢å †æ ˆï¼ˆæ­¤æ­¥åœ¨ int æŒ‡ä»¤ä¸­å®Œæˆï¼‰ åœ¨å®é™…æ‰§è¡Œ 0x80 å·ä¸­æ–­å‘é‡æ‰€å¯¹åº”çš„ä¸­æ–­å¤„ç†ç¨‹åºï¼ˆsystem_callï¼‰ä¹‹å‰ï¼ŒCPU é¦–å…ˆè¦è¿›è¡Œå †æ ˆåˆ‡æ¢ï¼Œå³ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ã€‚æ‰€è°“çš„å½“å‰æ ˆï¼ŒæŒ‡å¾—æ˜¯ espï¼ˆæ ˆæŒ‡é’ˆï¼‰çš„å€¼æ‰€åœ¨çš„æ ˆç©ºé—´ã€‚å¦‚æœ esp çš„å€¼ä½äºç”¨æˆ·æ ˆçš„èŒƒå›´å†…ï¼Œé‚£ä¹ˆç¨‹åºçš„å½“å‰æ ˆå°±æ˜¯ç”¨æˆ·æ ˆï¼Œåä¹‹äº¦ç„¶ã€‚æ­¤å¤–ï¼Œå¯„å­˜å™¨ ss çš„å€¼è¿˜åº”è¯¥æŒ‡å‘å½“å‰æ ˆæ‰€åœ¨çš„é¡µã€‚\næ‰€ä»¥ï¼Œå°†å½“å‰æ ˆç”±ç”¨æˆ·æ ˆåˆ‡æ¢ä¸ºå†…æ ¸æ ˆï¼ˆç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼‰çš„å®é™…è¡Œä¸ºå°±æ˜¯ï¼šä¿å­˜å½“å‰çš„ espï¼Œss çš„å€¼ï¼ˆä¿è¯å­˜åœ¨å†…æ ¸æ ˆä¸Šï¼Œint æŒ‡ä»¤å‘é€åè‡ªåŠ¨åœ°ç”±ç¡¬ä»¶å®Œæˆï¼‰ï¼Œå¹¶å°† espï¼Œss çš„å€¼è®¾ç½®ä¸ºå†…æ ¸æ ˆçš„ç›¸åº”å€¼\nå½“ 0x80 å·ä¸­æ–­å‘ç”Ÿçš„æ—¶å€™ï¼Œcpu é™¤äº†åˆ‡å…¥å†…æ ¸æ€ä¹‹å¤–ï¼Œè¿˜ä¼šè‡ªåŠ¨å®Œæˆä¸‹åˆ—å‡ ä»¶äº‹ï¼š\nï¼ˆ1ï¼‰æ‰¾åˆ°å½“å‰è¿›ç¨‹çš„å†…æ ¸æ ˆï¼ˆæ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„å†…æ ¸æ ˆï¼‰\nï¼ˆ2ï¼‰åœ¨å†…æ ¸æ ˆä¸­ä¸€æ¬¡å‹å…¥ç”¨æˆ·æ€çš„å¯„å­˜å™¨ ssã€espã€eflagsã€csã€eip\nè€Œå½“å†…æ ¸ä»ç³»ç»Ÿè°ƒç”¨è¿”å›çš„æ—¶å€™ï¼Œé¡»è¦è°ƒç”¨ iret æŒ‡ä»¤æ¥å›åˆ°ç”¨æˆ·æ€ï¼Œiret æŒ‡ä»¤åˆ™ä¼šä»å†…æ ¸æ ˆé‡Œå¼¹å‡ºå¯„å­˜å™¨ ssã€espã€eflagsã€csã€eip çš„å€¼ï¼Œä½¿å¾—æ ˆæ¢å¤åˆ°ç”¨æˆ·æ€çš„çŠ¶æ€ã€‚\nä¸­æ–­æ—¶å†…æ ¸æ ˆå’Œç”¨æˆ·æ ˆçš„åˆ‡æ¢ ä¸­æ–­å¤„ç†ç¨‹åº åœ¨ int æŒ‡ä»¤åˆ‡æ¢å†…æ ¸æ ˆä¹‹åï¼Œç¨‹åºå°±åˆ‡æ¢åˆ°äº†ä¸­æ–­å‘é‡è¡¨ä¸­çš„ 0x80 å·ä¸­æ–­å¤„ç†ç¨‹åºã€‚Linux ä¸­ 0x80 å‘é‡å¯¹åº”çš„ä¸­æ–­å¤„ç†ç¨‹åºæ˜¯ system_callã€‚\nsystem_call ä¸­æ–­æœåŠ¡ç¨‹åºé¦–å…ˆæ£€æŸ¥ç³»ç»Ÿè°ƒç”¨å·çš„æœ‰æ•ˆæ€§ï¼Œå†æ ¹æ® eax å¯„å­˜å™¨å­˜å‚¨çš„ç³»ç»Ÿè°ƒç”¨å·ä»ç³»ç»Ÿè°ƒç”¨è¡¨ä¸Šæ‰¾åˆ°ç›¸åº”çš„ç³»ç»Ÿè°ƒç”¨å¹¶è°ƒç”¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 // system_callçš„å¼€å¤´éƒ¨åˆ† ...... SAVE_ALL // ä¿å­˜å¯„å­˜å™¨çš„å€¼åˆ°æ ˆä¸­ï¼Œä»¥å…è¢«è¦†ç›– ...... cmpl $(nr_syscalls), %eax // æ¯”è¾ƒeaxå¯„å­˜å™¨ä¸­çš„å€¼å’Œç³»ç»Ÿè°ƒç”¨å·å¤§1çš„å€¼ï¼ˆéªŒè¯ç³»ç»Ÿè°ƒç”¨å·çš„æœ‰æ•ˆæ€§ï¼‰ jae syscall_badsys\t// å¦‚æœç³»ç»Ÿè°ƒç”¨æ— æ•ˆï¼ŒæŒ‡å‘syscall_badsys // å¦‚æœç³»ç»Ÿè°ƒç”¨å·æœ‰æ•ˆï¼Œåˆ™ä¼šæ‰§è¡Œä»¥ä¸‹ä»£ç  syscall_call: call *sys_call_table(0, %eax, 4) // æŸ¥æ‰¾ä¸­æ–­æœåŠ¡ç¨‹åºå¹¶æ‰§è¡Œï¼Œ sys_call_tableå…¶å®å°±æ˜¯ç³»ç»Ÿè°ƒç”¨è¡¨ ..... RESTORE_REGS // æ¢å¤ä¹‹å‰ä¿å­˜çš„å¯„å­˜å™¨ ...... iret // ä»ä¸­æ–­ç¨‹åºè¿”å› æ¢å¤ä¹‹å‰ä¿å­˜çš„å¯„å­˜å™¨ï¼Œä»ä¸­æ–­å¤„ç†ç¨‹åºè¿”å›ï¼Œä»å†…æ ¸æ€åˆ‡æ¢å›ç”¨æˆ·æ€ ç¼ºé¡µä¸­æ–­ åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œç¨‹åºæ‰§è¡Œæ—¶éœ€è¦è®¿é—®çš„å†…å­˜åœ¨è™šæ‹Ÿå†…å­˜ä¸­ï¼Œä¸åœ¨ç‰©ç†å†…å­˜ä¸­ï¼Œæ­¤æ—¶å°±ä¼šå‘ç”Ÿç¼ºé¡µä¸­æ–­ï¼ˆè¯¥æƒ…å†µä¸ºç¡¬ä»¶é¡µç¼ºå¤±ï¼‰ã€‚\nç¼ºé¡µä¸­æ–­çš„åˆ†ç±» è½¯æ€§é¡µç¼ºå¤±ï¼šæŒ‡é¡µç¼ºå¤±å‘ç”Ÿæ—¶ï¼Œç›¸å…³çš„é¡µå·²ç»è¢«åŠ è½½è¿›å†…å­˜ï¼Œä½†æ˜¯æ²¡æœ‰å‘ MMUï¼ˆå†…å­˜ç®¡ç†å•å…ƒï¼‰æ³¨å†Œçš„æƒ…å†µã€‚æ“ä½œç³»ç»Ÿåªéœ€è¦åœ¨ MMU ä¸­æ³¨å†Œç›¸å…³é¡µå¯¹åº”çš„ç‰©ç†åœ°å€å³å¯ã€‚ ç¡¬æ€§é¡µç¼ºå¤±ï¼šç¡¬æ€§é¡µç¼ºå¤±æ˜¯æŒ‡ç›¸å…³çš„é¡µåœ¨é¡µç¼ºå¤±å‘ç”Ÿæ—¶æœªè¢«åŠ è½½è¿›å†…å­˜çš„æƒ…å†µã€‚ æ— æ•ˆé¡µç¼ºå¤±ï¼šå½“ç¨‹åºè®¿é—®çš„è™šæ‹Ÿåœ°å€æ˜¯ä¸å­˜åœ¨äºè™šæ‹Ÿåœ°å€ç©ºé—´å†…çš„æ—¶å€™ï¼Œåˆ™å‘ç”Ÿæ— æ•ˆé¡µç¼ºå¤±ã€‚\næŸ¥çœ‹è¿›ç¨‹å‘ç”Ÿç¼ºé¡µä¸­æ–­çš„æ¬¡æ•° ps -o majflt,minflt -C \u0026lt;program_name\u0026gt;\nps -o majflt,minflt -p \u0026lt;pid\u0026gt; majflt ä»£è¡¨ major faultï¼Œä¸­æ–‡åå«å¤§é”™è¯¯ï¼Œminflt ä»£è¡¨ minor faultï¼Œä¸­æ–‡åå«å°é”™è¯¯ã€‚ majflt è¡¨ç¤ºéœ€è¦è¯»å†™ç£ç›˜ï¼Œå¯èƒ½æ˜¯å†…å­˜å¯¹åº”é¡µé¢åœ¨ç£ç›˜ä¸­éœ€è¦loadåˆ°ç‰©ç†å†…å­˜ä¸­ï¼Œä¹Ÿå¯èƒ½æ˜¯æ­¤æ—¶ç‰©ç†å†…å­˜ä¸è¶³ï¼Œéœ€è¦æ·˜æ±°éƒ¨åˆ†ç‰©ç†é¡µé¢è‡³ç£ç›˜ä¸­ã€‚ è¿™ä¸¤ä¸ªæ•°å€¼è¡¨ç¤ºä¸€ä¸ªè¿›ç¨‹è‡ªå¯åŠ¨ä»¥æ¥æ‰€å‘ç”Ÿçš„ç¼ºé¡µä¸­æ–­çš„æ¬¡æ•°ã€‚\nç¼ºé¡µä¸­æ–­è¿‡ç¨‹ å½“ç¨‹åºè®¿é—®ä¸€ä¸ªè™šæ‹Ÿåœ°å€æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šæ£€æŸ¥è¯¥åœ°å€æ˜¯å¦è¢«æ˜ å°„åˆ°ç‰©ç†å†…å­˜ä¸­ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™è§¦å‘ç¼ºé¡µä¸­æ–­ï¼š\nç¼ºé¡µä¸­æ–­ä¼šæš‚åœç¨‹åºæ‰§è¡Œï¼Œå°†æ§åˆ¶æƒäº¤ç»™æ“ä½œç³»ç»Ÿå†…æ ¸ï¼ˆè¿›ç¨‹ä¼šé™·å…¥å†…æ ¸æ€ï¼‰ï¼Œä¿æŠ¤ç¨‹åºç°åœºï¼Œä»¥å…è¢«æ“ä½œç³»ç»Ÿç ´åã€‚\nå†…æ ¸ä¼šæ£€æŸ¥å‘ç”Ÿç¼ºé¡µä¸­æ–­çš„è™šæ‹Ÿåœ°å€æ˜¯å¦æœ‰æ•ˆï¼š\nå¦‚æœè™šæ‹Ÿåœ°å€æœ‰æ•ˆï¼Œæ“ä½œç³»ç»Ÿå°†ä¼šåˆ†é…ä¸€ä¸ªç©ºé—²ç‰©ç†é¡µé¢ï¼Œå¹¶æŠŠæœªè¢«è¯»å–çš„æ•°æ®ä»ç£ç›˜æ‹·è´åˆ°ç‰©ç†å†…å­˜æ‰€åˆ†é…çš„é¡µé¢ä¸­ï¼ˆæ²¡æœ‰ç©ºé—²ç‰©ç†é¡µé¢ä¼šè§¦å‘é¡µé¢ç½®æ¢ç®—æ³•ï¼‰ï¼Œå¹¶æ›´æ–°é¡µè¡¨ä¿¡æ¯ã€‚ å¦‚æœè™šæ‹Ÿåœ°å€æ— æ•ˆï¼Œåˆ™æ“ä½œç³»ç»Ÿä¼šå‘è¿›ç¨‹å‘å‡ºä¸€ä¸ªä¿¡å·æˆ–æ€æ‰è¯¥è¿›ç¨‹ã€‚ å½“æ“ä½œç³»ç»Ÿå¤„ç†å®Œç¼ºé¡µä¸­æ–­åï¼Œç¨‹åºä¼šæ¢å¤è‡³å‘ç”Ÿç¼ºé¡µä¸­æ–­æŒ‡ä»¤ä»¥å‰çš„çŠ¶æ€ï¼Œç¨‹åºè®¡æ•°å™¨é‡æ–°æŒ‡å‘è¿™æ¡æŒ‡ä»¤ã€‚ ç¼ºé¡µä¸­æ–­å’Œç¼ºé¡µå¼‚å¸¸ ç¼ºé¡µä¸­æ–­æ˜¯æŒ‡å½“ç¨‹åºè®¿é—®ä¸€ä¸ªè™šæ‹Ÿå†…å­˜åœ°å€æ—¶ï¼Œå¯¹åº”çš„ç‰©ç†å†…å­˜é¡µä¸åœ¨ä¸»å­˜ä¸­ï¼Œéœ€è¦ä»ç£ç›˜ä¸­åŠ è½½åˆ°ä¸»å­˜ä¸­ï¼Œæ­¤æ—¶ CPU å°±ä¼šå‘å‡ºä¸€ä¸ªä¸­æ–­è¯·æ±‚ï¼Œæ“ä½œç³»ç»Ÿä¼šå“åº”ä¸­æ–­è¯·æ±‚ï¼Œå°†å¯¹åº”çš„ç‰©ç†é¡µåŠ è½½åˆ°ä¸»å­˜ä¸­ï¼Œå¹¶é‡æ–°æ‰§è¡Œäº§ç”Ÿç¼ºé¡µä¸­æ–­çš„æŒ‡ä»¤ã€‚ç¼ºé¡µä¸­æ–­æ˜¯ä¸€ç§åŒæ­¥äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºéœ€è¦ç­‰å¾…æ“ä½œç³»ç»Ÿå®Œæˆé¡µçš„åŠ è½½æ“ä½œåæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚\nç¼ºé¡µå¼‚å¸¸æ˜¯æŒ‡å½“ç¨‹åºè®¿é—®ä¸€ä¸ªè™šæ‹Ÿå†…å­˜åœ°å€æ—¶ï¼Œå¯¹åº”çš„ç‰©ç†å†…å­˜é¡µä¸åœ¨ä¸»å­˜ä¸­ï¼Œéœ€è¦ä»ç£ç›˜ä¸­åŠ è½½åˆ°ä¸»å­˜ä¸­ï¼Œä½†æ˜¯æ­¤æ—¶ CPU ä¸ä¼šå‘å‡ºä¸­æ–­è¯·æ±‚ï¼Œè€Œæ˜¯å°†æ§åˆ¶æƒäº¤ç»™æ“ä½œç³»ç»Ÿï¼Œè®©æ“ä½œç³»ç»Ÿå¤„ç†ç¼ºé¡µå¼‚å¸¸ã€‚ç¼ºé¡µå¼‚å¸¸æ˜¯ä¸€ç§å¼‚æ­¥äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºä¸éœ€è¦ç­‰å¾…æ“ä½œç³»ç»Ÿå®Œæˆé¡µçš„åŠ è½½æ“ä½œå°±å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚\nå› æ­¤ï¼Œç¼ºé¡µä¸­æ–­å’Œç¼ºé¡µå¼‚å¸¸çš„ä¸»è¦åŒºåˆ«åœ¨äºå®ƒä»¬æ˜¯åŒæ­¥äº‹ä»¶è¿˜æ˜¯å¼‚æ­¥äº‹ä»¶ã€‚ç¼ºé¡µä¸­æ–­æ˜¯åŒæ­¥äº‹ä»¶ï¼Œç¨‹åºéœ€è¦ç­‰å¾…æ“ä½œç³»ç»Ÿå®Œæˆé¡µçš„åŠ è½½æ“ä½œåæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼›è€Œç¼ºé¡µå¼‚å¸¸æ˜¯å¼‚æ­¥äº‹ä»¶ï¼Œç¨‹åºä¸éœ€è¦ç­‰å¾…æ“ä½œç³»ç»Ÿå®Œæˆé¡µçš„åŠ è½½æ“ä½œå°±å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚\nè™šè¡¨/è™šè¡¨æŒ‡é’ˆ ä¸ºäº†å®ç° C++ çš„å¤šæ€ï¼ŒC++ ä½¿ç”¨äº†ä¸€ç§åŠ¨æ€ç»‘å®šçš„æŠ€æœ¯ï¼Œè¿™ä¸ªæŠ€æœ¯çš„æ ¸å¿ƒæ˜¯è™šå‡½æ•°è¡¨ã€‚\nè™šè¡¨ æ¯ä¸ªåŒ…å«äº†è™šå‡½æ•°çš„ç±»éƒ½åŒ…å«ä¸€ä¸ªè™šè¡¨ï¼› ä¸€ä¸ªç±»ç»§æ‰¿äº†åŒ…å«è™šå‡½æ•°çš„åŸºç±»ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»ä¹Ÿä¼šæ‹¥æœ‰è‡ªå·±çš„è™šè¡¨ï¼› è™šè¡¨æ˜¯ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ï¼Œå…¶å…ƒç´ æ˜¯è™šå‡½æ•°çš„æŒ‡é’ˆï¼Œå³è™šè¡¨ä¸­æ¯ä¸ªå…ƒç´ å¯¹åº”ä¸€ä¸ªè™šå‡½æ•°çš„å‡½æ•°æŒ‡é’ˆï¼› è™šå‡½æ•°çš„çš„è°ƒç”¨éƒ½éœ€è¦ç»è¿‡è™šè¡¨ï¼Œæ™®é€šå‡½æ•°å³éè™šå‡½æ•°ï¼Œå…¶è°ƒç”¨å¹¶ä¸éœ€è¦ç»è¿‡è™šè¡¨ï¼› è™šè¡¨å†…çš„æ¡ç›®ï¼Œå³è™šå‡½æ•°æŒ‡é’ˆçš„èµ‹å€¼å‘ç”Ÿåœ¨ç¼–è¯‘å™¨çš„ç¼–è¯‘é˜¶æ®µï¼› è™šè¡¨æ˜¯å±äºç±»çš„ï¼Œè€Œä¸å±äºæŸä¸ªå…·ä½“çš„å¯¹è±¡ï¼Œä¸€ä¸ªç±»åªéœ€è¦ä¸€ä¸ªè™šè¡¨å³å¯ã€‚åŒä¸€ä¸ªç±»çš„æ‰€æœ‰å¯¹è±¡éƒ½ä½¿ç”¨åŒä¸€ä¸ªè™šè¡¨ã€‚ è™šè¡¨æŒ‡é’ˆ å¦‚æœ‰ç±»ä¸­åŒ…å«è™šå‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨åœ¨ç±»ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡é’ˆï¼š*__vptrï¼Œç”¨æ¥æŒ‡å‘è¯¥ç±»çš„è™šè¡¨ï¼› ç±»çš„å¯¹è±¡åœ¨åˆ›å»ºæ—¶ä¾¿æ‹¥æœ‰è™šè¡¨æŒ‡é’ˆï¼Œä¸”è¿™ä¸ªæŒ‡é’ˆçš„å€¼ä¼šè‡ªåŠ¨è¢«è®¾ç½®ä¸ºæŒ‡å‘ç±»çš„å”¯ä¸€è™šè¡¨ã€‚ ç±»Açš„å®šä¹‰å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 class A { public: virtual void vfunc1(); virtual void vfunc2(); void func1(); void func2(); private: int m_data1, m_data2; }; å› ä¸ºç±»Aä¸­å­˜åœ¨ï¼ˆä¸€ä¸ªæˆ–å¤šä¸ªï¼‰è™šå‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç»™ç±»AåŠ ä¸Šä¸€ä¸ªè™šè¡¨æŒ‡é’ˆï¼ˆå 8å­—èŠ‚ç©ºé—´ï¼‰ï¼Œæ‰€ä»¥sizeof(A)=16ã€‚ ç±»Açš„è™šè¡¨å’Œè™šè¡¨æŒ‡é’ˆï¼ˆ__vptrï¼‰å…³ç³»å¦‚ä¸‹ï¼š\nè™šè¡¨å’Œè™šè¡¨æŒ‡é’ˆ å¤šæ€ç›¸å…³ ä¸€ä¸ªç±»çš„åŸºç±»å¦‚æœåŒ…å«è™šå‡½æ•°ï¼Œé‚£ä¸ªè¿™ä¸ªç»§æ‰¿ç±»ä¹Ÿæœ‰æ‹¥æœ‰è‡ªå·±çš„è™šè¡¨ï¼Œæ•…è¿™ä¸ªç»§æ‰¿ç±»çš„å¯¹è±¡ä¹ŸåŒ…å«ä¸€ä¸ªè™šè¡¨æŒ‡é’ˆï¼Œç”¨æ¥æŒ‡å‘å®ƒçš„è™šè¡¨ï¼› ä¸€æ—¦ç»§æ‰¿ç±»é‡å†™äº†åŸºç±»çš„æŸä¸ªè™šå‡½æ•°ï¼Œé‚£ä¹ˆå®ƒçš„è™šè¡¨é¡¹ä¹Ÿä¼šåŒæ­¥æ›´æ–°ï¼ŒæŒ‡å‘ç»§æ‰¿ç±»é‡å†™çš„å‡½æ•°ï¼Œå¦åˆ™æŒ‡å‘å®ƒåŸºç±»çš„åŒåå‡½æ•°ã€‚ é€šè¿‡åŸºç±»çš„æŒ‡é’ˆè°ƒç”¨æ´¾ç”Ÿç±»ä¸­çš„å‡½æ•°ç§°ä¸ºï¼ˆè¿è¡Œæ—¶ï¼‰å¤šæ€ï¼Œç»è¿‡è™šè¡¨è°ƒç”¨è™šå‡½æ•°çš„è¿‡ç¨‹ç§°ä¸ºåŠ¨æ€ç»‘å®šï¼› è™šè¡¨å’Œè™šè¡¨æŒ‡é’ˆçš„åˆ›å»ºæ—¶æœºï¼š åœ¨ç¼–è¯‘çš„è¿‡ç¨‹ä¸­ç¼–è¯‘å™¨å°±ä¸ºå«æœ‰è™šå‡½æ•°çš„ç±»åˆ›å»ºäº†è™šè¡¨ï¼Œå¹¶ä¸”ç¼–è¯‘å™¨ä¼šåœ¨æ„é€ å‡½æ•°ä¸­æ’å…¥ä¸€æ®µä»£ç ï¼Œè¿™æ®µä»£ç ç”¨æ¥ç»™è™šæŒ‡é’ˆèµ‹å€¼ã€‚å› æ­¤è™šè¡¨æ˜¯åœ¨ç¼–è¯‘çš„è¿‡ç¨‹ä¸­åˆ›å»ºã€‚ ç”±äºè™šæŒ‡é’ˆæ˜¯åŸºäºå¯¹è±¡çš„ï¼Œæ‰€ä»¥å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œè™šæŒ‡é’ˆå°±ä¼šåˆ›å»ºï¼Œæ‰€ä»¥è™šæŒ‡é’ˆæ˜¯åœ¨è¿è¡Œæ—¶åˆ›å»ºã€‚ æ­¤å¤–ï¼Œç¼–è¯‘å™¨è§„å®šä¸€ä¸ªæ¨¡ç‰ˆå‡½æ•°ä¸èƒ½ä¸ºè™šå‡½æ•°ã€‚å› ä¸ºæ¨¡ç‰ˆæœºåˆ¶éœ€è¦åœ¨ç¼–è¯‘æœŸé—´è¯†åˆ«æ¨¡ç‰ˆæ”¯æŒç±»å‹ï¼Œå¯¹äºæ¯ä¸€ç§ç±»å‹æˆ‘ä»¬éƒ½è¦ç”Ÿæˆå¯¹åº”ç±»å‹çš„å‡½æ•°ä½“ã€‚å¦‚æœè¿™ä¸ªæ¨¡ç‰ˆå‡½æ•°ä¸ºè™šå‡½æ•°ï¼Œæˆ‘ä»¬ä¸çŸ¥é“è¿™ä¸ªæ¨¡ç‰ˆå‡½æ•°è¢«ç”Ÿæˆäº†å¤šå°‘ä»½å¯¹åº”ç±»å‹çš„è™šå‡½æ•°ï¼Œä¹Ÿå°±ä¸å¥½ç¡®å®šè™šè¡¨çš„å¤§å°ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨ç¦æ­¢è¿™ä¸€è¡Œä¸ºã€‚\næ›´è¯¦ç»†çš„å†…å®¹å‚è€ƒï¼šçŸ¥ä¹ï¼šC++ä¸­è™šå‡½æ•°ã€è™šç»§æ‰¿å†…å­˜æ¨¡å‹\n","permalink":"https://kdjlyy.cn/posts/tech/cs-basic-os/","summary":"å†…å­˜æ¨¡å‹, Linuxç”¨æˆ·ç©ºé—´å†…å­˜åˆ†å¸ƒ, ç¨‹åºå†…å­˜ç©ºé—´, è™šæ‹Ÿå†…å­˜, new, delete, malloc, free, brk, mmap, ptmalloc, tcmalloc, å†…å­˜å¯¹æ•Œ, ç”¨æˆ·æ€, å†…æ ¸æ€, ä¸­æ–­, ç³»ç»Ÿè°ƒç”¨, ç¼ºé¡µä¸­æ–­, è™šè¡¨, è™šè¡¨æŒ‡é’ˆ","title":"è®¡ç®—æœºåŸºç¡€çŸ¥è¯†æ€»ç»“ï¼ˆç³»ç»Ÿç¯‡ï¼‰"},{"content":" å¸¸è§çš„Markdownè¯­æ³•ï¼Œä¾‹å¦‚å¼•ç”¨ã€æ ‡é¢˜ã€æ®µè½ã€æ— åºåˆ—è¡¨ã€æœ‰åºåˆ—è¡¨ç­‰ä¸åšè®¨è®ºã€‚\nå‚è€ƒï¼šSulvâ€™s Blogã€è·æˆŸç‹¬å½·å¾¨ã€Memoryã€3rd\u0026rsquo;s Blogã€Doitã€‚\nå­—ä½“ç§ç±» åœ¨Markdownä¸­ï¼Œä½¿ç”¨\u0026lt;font\u0026gt;æ ‡ç­¾çš„faceå±æ€§ä¿®æ”¹æ–‡å­—å­—ä½“ï¼š\n1 2 3 \u0026lt;font face=\u0026#39;SimHei\u0026#39;\u0026gt;è¿™æ˜¯é»‘ä½“\u0026lt;/font\u0026gt; \u0026lt;font face=\u0026#39;KaiTi\u0026#39;\u0026gt;è¿™æ˜¯æ¥·ä½“\u0026lt;/font\u0026gt; \u0026lt;font face=\u0026#39;Fangsong_GB2312\u0026#39;\u0026gt;è¿™æ˜¯ä»¿å®‹_GB2312å­—ä½“\u0026lt;/font\u0026gt; è¿™æ˜¯é»‘ä½“Â è¿™æ˜¯æ¥·ä½“Â è¿™æ˜¯ä»¿å®‹_GB2312å­—ä½“\nå­—ä½“åç§° å­—ä½“å†™æ³• é»‘ä½“ SimHei å®‹ä½“ SimSun æ–°å®‹ä½“ NSimSun ä»¿å®‹ FangSong æ¥·ä½“ KaiTi ä»¿å®‹_GB2312 FangSong_GB2312 æ¥·ä½“_GB2312 KaiTi_GB2312 å¾®è½¯é›…é»‘ Microsoft YaHei è½éœæ–‡æ¥· LXGW WenKai è½éœæ–‡æ¥· Lite LXGW WenKai Lite è½éœæ–‡æ¥· Screen LXGW WenKai Screen è½éœæ–‡æ¥· TC LXGW WenKai TC å­—å· 1 2 3 4 5 6 7 \u0026lt;font size=\u0026#34;1\u0026#34;\u0026gt;è¿™æ˜¯1å·å­—ä½“\u0026lt;/font\u0026gt; \u0026lt;font size=\u0026#34;2\u0026#34;\u0026gt;è¿™æ˜¯2å·å­—ä½“\u0026lt;/font\u0026gt; \u0026lt;font size=\u0026#34;3\u0026#34;\u0026gt;è¿™æ˜¯3å·å­—ä½“\u0026lt;/font\u0026gt; \u0026lt;font size=\u0026#34;4\u0026#34;\u0026gt;è¿™æ˜¯4å·å­—ä½“\u0026lt;/font\u0026gt; \u0026lt;font size=\u0026#34;5\u0026#34;\u0026gt;è¿™æ˜¯5å·å­—ä½“\u0026lt;/font\u0026gt; \u0026lt;font size=\u0026#34;6\u0026#34;\u0026gt;è¿™æ˜¯6å·å­—ä½“\u0026lt;/font\u0026gt; \u0026lt;font size=\u0026#34;7\u0026#34;\u0026gt;è¿™æ˜¯7å·å­—ä½“\u0026lt;/font\u0026gt; è¿™æ˜¯1å·å­—ä½“\nè¿™æ˜¯2å·å­—ä½“Â è¿™æ˜¯3å·å­—ä½“ è¿™æ˜¯4å·å­—ä½“Â è¿™æ˜¯5å·å­—ä½“Â è¿™æ˜¯6å·å­—ä½“Â è¿™æ˜¯7å·å­—ä½“Â å­—ä½“é¢œè‰² 1 2 3 4 \u0026lt;font color=\u0026#39;red\u0026#39;\u0026gt;è¿™æ˜¯çº¢è‰²å­—ä½“\u0026lt;/font\u0026gt; \u0026lt;font color=\u0026#39;rgb(200, 100, 100)\u0026#39;\u0026gt;è¿™æ˜¯rgb(200, 100, 100)é¢œè‰²å­—ä½“\u0026lt;/font\u0026gt; \u0026lt;font color=\u0026#39;#FF00BB\u0026#39;\u0026gt;è¿™æ˜¯#FF00BBé¢œè‰²å­—ä½“\u0026lt;/font\u0026gt; \u0026lt;font style=\u0026#34;background: linear-gradient(to right, #ff1616, #36c945, #10a5ce, #0f0096, #a51eff, #ff1616);\u0026#34;\u0026gt;è¿™æ˜¯7è‰²æ¸å˜é¢œè‰²\u0026lt;/font\u0026gt; è¿™æ˜¯çº¢è‰²å­—ä½“Â è¿™æ˜¯rgb(200, 100, 100)é¢œè‰²å­—ä½“Â è¿™æ˜¯#FF00BBé¢œè‰²å­—ä½“\nè¿™æ˜¯7è‰²æ¸å˜é¢œè‰²\nå¾…åŠåˆ—è¡¨ ä½¿ç”¨-[]è¡¨ç¤ºä¸€é¡¹å¾…åŠï¼Œå½“å®Œæˆå¾…åŠåç»™ä¸­æ‹¬å·ä¸­æ·»åŠ xï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼Œæ³¨æ„ç©ºæ ¼ä¸å¯çœç•¥ï¼‰å³å¯ï¼Œä¾‹å¦‚ï¼š\n1 2 3 - [x] åƒé¥­ - [x] ç¡è§‰ - [ ] å†™ä½œä¸š åƒé¥­ ç¡è§‰ å†™ä½œä¸š è„šæ³¨å’Œé¡µå†…è·³è½¬ è„šæ³¨ 1 2 3 è¿™æ˜¯ä¸€ä¸ªç®€å•çš„è„šæ³¨[^1]ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªè„šæ³¨[^bignote]ã€‚ [^1]:è¿™æ˜¯ç¬¬ä¸€ä¸ªè„šæ³¨ [^bignote]:è¿™æ˜¯ç¬¬äºŒè„šæ³¨ è¿™æ˜¯ä¸€ä¸ªç®€å•çš„è„šæ³¨1ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªè„šæ³¨2ã€‚\né¡µå†…è·³è½¬ 1 2 3 4 5 6 7 // 1. é¦–å…ˆå®šä¹‰ä¸€ä¸ªé”šç‚¹ï¼š \u0026lt;span id=\u0026#34;jump\u0026#34;\u0026gt;**\u0026lt;u\u0026gt;ã€Šå¡å°”è¾¾ä¼ è¯´ ç‹å›½ä¹‹æ³ªã€‹\u0026lt;/u\u0026gt;**\u0026lt;/span\u0026gt;ï¼ˆæ—¥è¯­ï¼šã‚¼ãƒ«ãƒ€ã®ä¼èª¬ ãƒ†ã‚£ã‚¢ãƒ¼ã‚º ã‚ªãƒ– ã‚¶ ã‚­ãƒ³ã‚°ãƒ€ãƒ ï¼Œè‹±è¯­ï¼šThe Legend of Zelda: Tears of the Kingdomï¼‰æ˜¯ä¸€æ¬¾ç”±ä»»å¤©å ‚ä¼åˆ’åˆ¶ä½œæœ¬éƒ¨å¼€å‘ï¼Œä»»å¤©å ‚å‘è¡Œçš„ä¸€æ¬¾å¼€æ”¾ä¸–ç•ŒåŠ¨ä½œå†’é™©æ¸¸æˆã€‚æœ¬ä½œä¸º2017å¹´å‘å”®çš„ã€Šå¡å°”è¾¾ä¼ è¯´ æ—·é‡ä¹‹æ¯ã€‹çš„ç»­ä½œï¼Œä¹Ÿæ˜¯å¡å°”è¾¾ä¼ è¯´ç³»åˆ—çš„ç¬¬äºŒåéƒ¨ä½œå“ï¼Œäº2023å¹´5æœˆ12æ—¥åœ¨ä»»å¤©å ‚Switchä¸Šå‘å”®ã€‚ // 2. ç”¨markdownçš„è¯­æ³•å†™è¶…é“¾ ç‚¹å‡»æŸ¥çœ‹[ç‹å›½ä¹‹æ³ªçš„ä»‹ç»](#jump) // 3. ç‚¹å‡»è¶…é“¾æ–‡å­—å°±å¯ä»¥å®šä½åˆ°è·³è½¬å†…å®¹äº† ç‚¹å‡»æŸ¥çœ‹ç‹å›½ä¹‹æ³ªçš„ä»‹ç»\nã€Šå¡å°”è¾¾ä¼ è¯´ ç‹å›½ä¹‹æ³ªã€‹ï¼ˆæ—¥è¯­ï¼šã‚¼ãƒ«ãƒ€ã®ä¼èª¬ ãƒ†ã‚£ã‚¢ãƒ¼ã‚º ã‚ªãƒ– ã‚¶ ã‚­ãƒ³ã‚°ãƒ€ãƒ ï¼Œè‹±è¯­ï¼šThe Legend of Zelda: Tears of the Kingdomï¼‰æ˜¯ä¸€æ¬¾ç”±ä»»å¤©å ‚ä¼åˆ’åˆ¶ä½œæœ¬éƒ¨å¼€å‘ï¼Œä»»å¤©å ‚å‘è¡Œçš„ä¸€æ¬¾å¼€æ”¾ä¸–ç•ŒåŠ¨ä½œå†’é™©æ¸¸æˆã€‚æœ¬ä½œä¸º2017å¹´å‘å”®çš„ã€Šå¡å°”è¾¾ä¼ è¯´ æ—·é‡ä¹‹æ¯ã€‹çš„ç»­ä½œï¼Œä¹Ÿæ˜¯å¡å°”è¾¾ä¼ è¯´ç³»åˆ—çš„ç¬¬äºŒåéƒ¨ä½œå“ï¼Œäº2023å¹´5æœˆ12æ—¥åœ¨ä»»å¤©å ‚Switchä¸Šå‘å”®ã€‚\nå¦å¤–ï¼Œä¹Ÿå¯ä»¥ç”¨ä¸Šæ ‡çš„æ–¹å¼è¿›è¡Œé¡µå†…è·³è½¬ï¼š\n1 ç‹å›½ä¹‹æ³ª\u0026lt;sup\u0026gt;[[å¡å°”è¾¾ä¼ è¯´ ç‹å›½ä¹‹æ³ª]](#jump)\u0026lt;/sup\u0026gt;æ˜¯ä»€ä¹ˆæ¸¸æˆï¼Ÿ ç‹å›½ä¹‹æ³ª[å¡å°”è¾¾ä¼ è¯´ ç‹å›½ä¹‹æ³ª]æ˜¯ä»€ä¹ˆæ¸¸æˆï¼Ÿ\né¼ æ ‡æ‚¬æµ®æ•ˆæœ 1 \u0026lt;abbr title=\u0026#34;ğŸ™ƒğŸ™ƒğŸ™ƒ\u0026#34;\u0026gt;é¼ æ ‡æ‚¬æµ®è¿™é‡Œ\u0026lt;/abbr\u0026gt;å¯ä»¥çœ‹åˆ°è¯¦ç»†çš„è§£é‡Šã€‚ é¼ æ ‡æ‚¬æµ®è¿™é‡Œ å¯ä»¥çœ‹åˆ°è¯¦ç»†çš„è§£é‡Šã€‚\nè‡ªå®šä¹‰shortcodes Hugoåšå®¢é€šè¿‡ç®€ç æ–¹å¼æ’å…¥pdfã€bilibiliä»¥åŠåšå®¢æ–‡ç« å†…é“¾ç­‰åŠŸèƒ½ã€‚\nä¸ºäº†é˜²æ­¢è¢«è¯†åˆ«ç”Ÿæ•ˆï¼Œè°ƒç”¨æ ·å¼å‡è¡¨ç¤ºä¸º{.{\u0026lt; xxx \u0026gt;}}ï¼Œå®é™…ä½¿ç”¨æ—¶å»æ‰å¤§æ‹¬å·ä¸­é—´çš„.å³å¯ã€‚\næ’å…¥pdf 1 {.{\u0026lt; ppt src=\u0026#34;https://www.africau.edu/images/default/sample.pdf\u0026#34; \u0026gt;}} æ’å…¥bilibiliè§†é¢‘ 1 2 {.{\u0026lt; bilibili BV1WZ4y1a7MF \u0026gt;}} # å¦‚æœæœ‰é›†æ•°ï¼ˆé»˜è®¤ç¬¬ä¸€é›†ï¼‰ï¼Œä¾‹å¦‚è¦æ’­æ”¾ç¬¬5é›†ï¼Œåˆ™è¿™æ ·ä½¿ç”¨ï¼š{.{\u0026lt; bilibili BV1WZ4y1a7MF 5 \u0026gt;}} \u003c!DOCTYPE HTML\u003e æ’å…¥åšå®¢æ–‡ç« å†…é“¾ 1 2 {.{\u0026lt; innerlink src=\u0026#34;posts/tech/cs-basic-grammar.md\u0026#34; \u0026gt;}} # å¡ç‰‡è·å–çš„æ–‡ç« é•¿åº¦é»˜è®¤æ˜¯70ï¼Œéœ€è¦åœ¨config.yamlé…ç½®æ–‡ä»¶æ·»åŠ  summaryLength: 90ï¼Œå³è®¾ç½®ä¸º90 è®¡ç®—æœºåŸºç¡€çŸ¥è¯†æ€»ç»“ï¼ˆè¯­æ³•ç¯‡ï¼‰ æ—¥æœŸ: 2023-05-09 \u0026nbsp; æ ‡ç­¾: #C\u0026#43;\u0026#43;\u0026nbsp; #åŸºç¡€çŸ¥è¯†\u0026nbsp; æˆå‘˜å˜é‡åˆå§‹åŒ– æ„é€ å‡½æ•°å†…éƒ¨åˆå§‹åŒ–å’Œåˆå§‹åŒ–åˆ—è¡¨ åˆå§‹åŒ–ç±»çš„æˆå‘˜æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€æ˜¯ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ï¼ŒäºŒæ˜¯åœ¨æ„é€ å‡½æ•°ä½“å†…è¿›è¡Œèµ‹å€¼æ“ä½œã€‚ å¯¹äºå†…ç½®ç±»å‹ï¼Œå¦‚int, floatç­‰ï¼Œä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨å’Œåœ¨æ„ ...... ä»£ç æŠ˜å  1 2 3 4 5 6 7 8 9 {.{% code %}} ```cpp #include \u0026lt;iostream\u0026gt; int main() { std::cout \u0026lt;\u0026lt; \u0026#34;Hello World!\u0026#34; \u0026lt;\u0026lt; std::endl; return 0; } ``` {.{% /code %}} ä»£ç  1 2 3 4 5 #include \u0026lt;iostream\u0026gt; int main() { std::cout \u0026lt;\u0026lt; \u0026#34;Hello World!\u0026#34; \u0026lt;\u0026lt; std::endl; return 0; } æ–‡å­—ä½ç½® 1 2 3 {.{\u0026lt; align left \u0026#34;æ–‡å­—å±…å·¦\u0026#34; \u0026gt;}} {.{\u0026lt; align center \u0026#34;æ–‡å­—å±…ä¸­\u0026#34; \u0026gt;}} {.{\u0026lt; align right \u0026#34;æ–‡å­—å±…ä¸­\u0026#34; \u0026gt;}} æ–‡å­—å±…å·¦\næ–‡å­—å±…ä¸­\næ–‡å­—å±…ä¸­\nå›¾ç‰‡ figureæ ‡ç­¾æ˜¯PaperModä¸»é¢˜è‡ªå¸¦çš„\n1 2 {.{\u0026lt; figure src=\u0026#34;https://kdjlyy.github.io/img/logo.ico\u0026#34; caption=\u0026#34;å›¾ç‰‡æè¿°\u0026#34; width=\u0026#34;50%\u0026#34; height=\u0026#34;50%\u0026#34; align=\u0026#34;center\u0026#34; \u0026gt;}} {.{\u0026lt; figure src=\u0026#34;https://kdjlyy.github.io/img/logo.ico\u0026#34; title=\u0026#34;xxx\u0026#34; caption=\u0026#34;å›¾ç‰‡æè¿°\u0026#34; width=\u0026#34;200\u0026#34; height=\u0026#34;200\u0026#34; \u0026gt;}} å›¾ç‰‡æè¿°\næˆ–è€…ï¼š\n1 2 3 4 \u0026lt;div style=\u0026#34;text-align:center;\u0026#34;\u0026gt; \u0026lt;img style=\u0026#34;display: block; margin: 0 auto;\u0026#34; src=\u0026#34;\u0026#34; width=\u0026#34;100%\u0026#34; height=\u0026#34;100%\u0026#34; \u0026gt; \u0026lt;span style=\u0026#34;font-size: 14px; color: grey;\u0026#34;\u0026gt;å›¾ç‰‡æè¿°\u0026lt;/span\u0026gt; \u0026lt;/div\u0026gt;\u0026lt;br\u0026gt; å¤´åƒ Githubå¡ç‰‡ 1 {.{\u0026lt; github title=\u0026#34;kdjlyy/fastRPC\u0026#34; \u0026gt;}} Mermaidä½œå›¾ 1 2 3 4 5 6 7 8 \u0026lt;div align=center\u0026gt; \u0026lt;!-- å¯ä»¥ç”¨htmlä»£ç åŒ…è£¹è¯¥ä»£ç å®ç°å±…ä¸­æˆ–å…¶ä»–æ’ç‰ˆ --\u0026gt; {.{\u0026lt;mermaid\u0026gt;}} flowchart LR a --\u0026gt; b \u0026amp; c --\u0026gt; d {.{\u0026lt;/mermaid\u0026gt;}} \u0026lt;/div\u0026gt; flowchart LR a --\u003e b \u0026 c --\u003e d æµç¨‹å›¾ ä»£ç  1 2 3 4 5 6 {.{\u0026lt; mermaid \u0026gt;}}graph LR; A[Hard edge] --\u0026gt;|Link text| B(Round edge) B --\u0026gt; C{Decision} C --\u0026gt;|One| D[Result one] C --\u0026gt;|Two| E[Result two] {.{\u0026lt; /mermaid \u0026gt;}} graph LR; A[Hard edge] --\u003e|Link text| B(Round edge) B --\u003e C{Decision} C --\u003e|One| D[Result one] C --\u003e|Two| E[Result two] æ—¶åºå›¾ ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 {.{\u0026lt; mermaid \u0026gt;}}sequenceDiagram participant Alice participant Bob Alice-\u0026gt;\u0026gt;John: Hello John, how are you? loop Healthcheck John-\u0026gt;John: Fight against hypochondria end Note right of John: Rational thoughts \u0026lt;br/\u0026gt;prevail... John--\u0026gt;Alice: Great! John-\u0026gt;Bob: How about you? Bob--\u0026gt;John: Jolly good! {.{\u0026lt; /mermaid \u0026gt;}} sequenceDiagram participant Alice participant Bob Alice-\u003e\u003eJohn: Hello John, how are you? loop Healthcheck John-\u003eJohn: Fight against hypochondria end Note right of John: Rational thoughts prevail... John--\u003eAlice: Great! John-\u003eBob: How about you? Bob--\u003eJohn: Jolly good! ç”˜ç‰¹å›¾ ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 { {\u0026lt; mermaid \u0026gt;}}gantt dateFormat YYYY-MM-DD title Adding GANTT diagram functionality to mermaid section A section Completed task :done, des1, 2014-01-06,2014-01-08 Active task :active, des2, 2014-01-09, 3d Future task : des3, after des2, 5d Future task2 : des4, after des3, 5d section Critical tasks Completed task in the critical line :crit, done, 2014-01-06,24h Implement parser and jison :crit, done, after des1, 2d Create tests for parser :crit, active, 3d Future task in critical line :crit, 5d Create tests for renderer :2d Add to mermaid :1d { {\u0026lt; /mermaid \u0026gt;}} gantt dateFormat YYYY-MM-DD title Adding GANTT diagram functionality to mermaid section A section Completed task :done, des1, 2014-01-06,2014-01-08 Active task :active, des2, 2014-01-09, 3d Future task : des3, after des2, 5d Future task2 : des4, after des3, 5d section Critical tasks Completed task in the critical line :crit, done, 2014-01-06,24h Implement parser and jison :crit, done, after des1, 2d Create tests for parser :crit, active, 3d Future task in critical line :crit, 5d Create tests for renderer :2d Add to mermaid :1d ç±»å›¾ ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 { {\u0026lt; mermaid \u0026gt;}}classDiagram Class01 \u0026lt;|-- AveryLongClass : Cool Class03 *-- Class04 Class05 o-- Class06 Class07 .. Class08 Class09 --\u0026gt; C2 : Where am i? Class09 --* C3 Class09 --|\u0026gt; Class07 Class07 : equals() Class07 : Object[] elementData Class01 : size() Class01 : int chimp Class01 : int gorilla Class08 \u0026lt;--\u0026gt; C2: Cool label { {\u0026lt; /mermaid \u0026gt;}} classDiagram Class01 \u003c|-- AveryLongClass : Cool Class03 *-- Class04 Class05 o-- Class06 Class07 .. Class08 Class09 --\u003e C2 : Where am i? Class09 --* C3 Class09 --|\u003e Class07 Class07 : equals() Class07 : Object[] elementData Class01 : size() Class01 : int chimp Class01 : int gorilla Class08 \u003c--\u003e C2: Cool label çŠ¶æ€å›¾ ä»£ç  1 2 3 4 5 6 7 8 {.{\u0026lt; mermaid \u0026gt;}}stateDiagram [*] --\u0026gt; Still Still --\u0026gt; [*] Still --\u0026gt; Moving Moving --\u0026gt; Still Moving --\u0026gt; Crash Crash --\u0026gt; [*] {.{\u0026lt; /mermaid \u0026gt;}} stateDiagram [*] --\u003e Still Still --\u003e [*] Still --\u003e Moving Moving --\u003e Still Moving --\u003e Crash Crash --\u003e [*] Gitå›¾ ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 { {\u0026lt; mermaid \u0026gt;}} gitGraph commit branch hotfix checkout hotfix commit branch develop checkout develop commit id:\u0026#34;ash\u0026#34; tag:\u0026#34;abc\u0026#34; branch featureB checkout featureB commit type:HIGHLIGHT checkout main checkout hotfix commit type:NORMAL checkout develop commit type:REVERSE checkout featureB commit checkout main merge hotfix checkout featureB commit checkout develop branch featureA commit checkout develop merge hotfix checkout featureA commit checkout featureB commit checkout develop merge featureA branch release checkout release commit checkout main commit checkout release merge main checkout develop merge release { {\u0026lt; /mermaid \u0026gt;}} gitGraph commit branch hotfix checkout hotfix commit branch develop checkout develop commit id:\"ash\" tag:\"abc\" branch featureB checkout featureB commit type:HIGHLIGHT checkout main checkout hotfix commit type:NORMAL checkout develop commit type:REVERSE checkout featureB commit checkout main merge hotfix checkout featureB commit checkout develop branch featureA commit checkout develop merge hotfix checkout featureA commit checkout featureB commit checkout develop merge featureA branch release checkout release commit checkout main commit checkout release merge main checkout develop merge release é¥¼å›¾ ä»£ç  1 2 3 4 5 6 7 \u0026lt;div class=\u0026#34;mermaid\u0026#34;\u0026gt; pie \u0026#34;Dogs\u0026#34; : 386 \u0026#34;Cats\u0026#34; : 85 \u0026#34;Rats\u0026#34; : 15 \u0026lt;/div\u0026gt; pie \"Dogs\" : 386 \"Cats\" : 85 \"Rats\" : 15 Echartsä½œå›¾ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 \u0026lt;div id=\u0026#34;echarts\u0026#34; style=\u0026#34;width: 600px;height:400px;\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.bootcdn.net/ajax/libs/echarts/5.1.1/echarts.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; var myChart = echarts.init(document.getElementById(\u0026#39;echarts\u0026#39;)); myChart.setOption({ title: { text: \u0026#39;ECharts ç¤ºä¾‹\u0026#39; }, tooltip: {}, xAxis: { data: [\u0026#39;å‘¨ä¸€\u0026#39;, \u0026#39;å‘¨äºŒ\u0026#39;, \u0026#39;å‘¨ä¸‰\u0026#39;, \u0026#39;å‘¨å››\u0026#39;, \u0026#39;å‘¨äº”\u0026#39;, \u0026#39;å‘¨å…­\u0026#39;, \u0026#39;å‘¨æ—¥\u0026#39;] }, yAxis: {}, series: [{ name: \u0026#39;é”€é‡\u0026#39;, type: \u0026#39;bar\u0026#39;, data: [5, 20, 36, 10, 10, 20, 5] }] }); \u0026lt;/script\u0026gt; å…¶ä»– ä¸Šæ ‡å’Œä¸‹æ ‡ 1 2 3 H\u0026lt;sub\u0026gt;2\u0026lt;/sub\u0026gt;O C\u0026lt;sub\u0026gt;6\u0026lt;/sub\u0026gt;H\u0026lt;sub\u0026gt;12\u0026lt;/sub\u0026gt;O\u0026lt;sub\u0026gt;6\u0026lt;/sub\u0026gt; X\u0026lt;sup\u0026gt;n\u0026lt;/sup\u0026gt; + Y\u0026lt;sup\u0026gt;n\u0026lt;/sup\u0026gt; = Z\u0026lt;sup\u0026gt;n\u0026lt;/sup\u0026gt; H2O\nC6H12O6Â Xn + Yn = ZnÂ å…¬å¼ 1 $$0.414213562373095048\\approx6\\*16^{-1}+a\\*16^{-2}+0\\*16^{-3}+\\cdots$$ $$0.414213562373095048\\approx6*16^{-1}+a*16^{-2}+0*16^{-3}+\\cdots$$\né«˜äº® 1 \u0026lt;mark\u0026gt;é«˜äº®æ ‡è®°è¯­è¨€\u0026lt;/mark\u0026gt;æ˜¾ç¤ºæ®µè½ä¸­çš„é‡è¦æ–‡å­—éƒ¨åˆ†ã€‚ é«˜äº®æ ‡è®°è¯­è¨€æ˜¾ç¤ºæ®µè½ä¸­çš„é‡è¦æ–‡å­—éƒ¨åˆ†ã€‚\nè¿™æ˜¯ç¬¬ä¸€ä¸ªè„šæ³¨\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nè¿™æ˜¯ç¬¬äºŒä¸ªè„šæ³¨\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","permalink":"https://kdjlyy.cn/posts/tech/markdown-note/","summary":"ä¸»è¦å±•ç¤º PaperMod ä¸»é¢˜ä¸­ Markdown è¯­æ³•çš„é¡µé¢æ•ˆæœ","title":"PaperModä¸»é¢˜Markdownç¤ºä¾‹"},{"content":"æˆå‘˜å˜é‡åˆå§‹åŒ– æ„é€ å‡½æ•°å†…éƒ¨åˆå§‹åŒ–å’Œåˆå§‹åŒ–åˆ—è¡¨ åˆå§‹åŒ–ç±»çš„æˆå‘˜æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€æ˜¯ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ï¼ŒäºŒæ˜¯åœ¨æ„é€ å‡½æ•°ä½“å†…è¿›è¡Œèµ‹å€¼æ“ä½œã€‚\nå¯¹äºå†…ç½®ç±»å‹ï¼Œå¦‚int, floatç­‰ï¼Œä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨å’Œåœ¨æ„é€ å‡½æ•°ä½“å†…åˆå§‹åŒ–å·®åˆ«ä¸å¤§ï¼› å¯¹äºç±»ç±»å‹æ¥è¯´ï¼Œä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ä¼šå‡å°‘è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°çš„æ¬¡æ•°ï¼Œæ›´åŠ é«˜æ•ˆã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 class A { public: A() { cout \u0026lt;\u0026lt; \u0026#34;A()\u0026#34; \u0026lt;\u0026lt; endl; } A(int _a) { a = _a; cout \u0026lt;\u0026lt; \u0026#34;A(_a)\u0026#34; \u0026lt;\u0026lt; endl; } private: int a; }; class B { public: B() { cout \u0026lt;\u0026lt; \u0026#34;B()\u0026#34; \u0026lt;\u0026lt; endl; } B(int _b) : b(_b), m_a(_b) { // åˆå§‹åŒ–åˆ—è¡¨åˆå§‹åŒ– // b = _b, m_a = A(_b); // æ„é€ å‡½æ•°å†…éƒ¨èµ‹å€¼æ“ä½œ cout \u0026lt;\u0026lt; \u0026#34;B(_b)\u0026#34; \u0026lt;\u0026lt; endl; } private: int b; A m_a; }; int main(int argc, char** argv) { B b(100); } è¿™æ®µä»£ç è¾“å‡ºï¼š\n1 2 A(_a) B(_b) å¦‚æœä¸ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ï¼Œä½¿ç”¨17è¡Œæ„é€ å‡½æ•°å†…éƒ¨èµ‹å€¼çš„æ–¹å¼ï¼Œä¼šè¾“å‡ºï¼š\n1 2 3 A() A(_a) B(_b) é™¤äº†æ€§èƒ½é—®é¢˜ä¹‹å¤–ï¼Œæœ‰æ—¶å€™åˆå§‹åŒ–åˆ—è¡¨æ˜¯ä¸å¯æˆ–ç¼ºçš„ï¼Œä»¥ä¸‹å‡ ç§æƒ…å†µå¿…é¡»ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ï¼š\nç±»çš„constæˆå‘˜\nå¼•ç”¨ç±»å‹\nconstå¯¹è±¡æˆ–å¼•ç”¨åªèƒ½åˆå§‹åŒ–ä½†æ˜¯ä¸èƒ½èµ‹å€¼ï¼Œæ„é€ å‡½æ•°çš„å‡½æ•°ä½“å†…åªèƒ½åšèµ‹å€¼è€Œä¸æ˜¯åˆå§‹åŒ–ã€‚å› æ­¤åˆå§‹åŒ–constå¯¹è±¡æˆ–å¼•ç”¨çš„å”¯ä¸€æœºä¼šæ˜¯æ„é€ å‡½æ•°å‡½æ•°ä½“ä¹‹å‰çš„åˆå§‹åŒ–åˆ—è¡¨ä¸­ã€‚\næ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°çš„ç±»ç±»å‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 class A { public: A(int a): i(a) {} int i; }; class B { public: A a ; B(const A\u0026amp; a1) { a = a1; // error: ç±»Aä¸å­˜åœ¨é»˜è®¤æ„é€ å‡½æ•° } }; class C: public A { public: C(int _x): x(_x) {} // error: ç±»Aä¸å­˜åœ¨é»˜è®¤æ„é€ å‡½æ•° private: int x; } ä»¥ä¸Šä»£ç æ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œå› ä¸ºBçš„æ„é€ å‡½æ•°ä¸­a=a1è¿™ä¸€è¡Œä¼šå…ˆè°ƒç”¨Açš„é»˜è®¤æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–a1ï¼Œç”±äºAæ²¡æœ‰é»˜è®¤çš„æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥æ— æ³•æ‰§è¡Œï¼Œæ•…è€Œç¼–è¯‘é”™è¯¯ã€‚\nå¦‚æœåŸºç±»æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°ï¼Œæ´¾ç”Ÿç±»å¿…é¡»åœ¨å…¶åˆå§‹åŒ–åˆ—è¡¨ä¸­æ˜¾ç¤ºè°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°ã€‚\næ„é€ å‡½æ•°è°ƒç”¨é¡ºåº è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°ï¼Œè°ƒç”¨é¡ºåºæŒ‰ç…§ä»–ä»¬çš„ç»§æ‰¿æ—¶å£°æ˜çš„é¡ºåºã€‚ è°ƒç”¨å†…åµŒæˆå‘˜å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œè°ƒç”¨é¡ºåºæŒ‰ç…§ä»–ä»¬åœ¨ç±»ä¸­å£°æ˜çš„é¡ºåºã€‚ è°ƒç”¨æ´¾ç”Ÿç±»è‡ªå·±çš„æ„é€ å‡½æ•°ä½“ä¸­çš„å†…å®¹ã€‚ ææ„å‡½æ•°çš„è°ƒç”¨é¡ºåºç›¸åã€‚\næ›´è¯¦ç»†çš„ï¼šæ„é€ å‡½æ•°çš„æ‰§è¡Œå¯ä»¥åˆ†æˆä¸¤ä¸ªé˜¶æ®µï¼Œåˆå§‹åŒ–é˜¶æ®µå’Œè®¡ç®—é˜¶æ®µï¼Œåˆå§‹åŒ–é˜¶æ®µå…ˆäºè®¡ç®—é˜¶æ®µã€‚\nåˆå§‹åŒ–é˜¶æ®µï¼šæ‰€æœ‰ç±»ç±»å‹ï¼ˆclass typeï¼‰çš„æˆå‘˜éƒ½ä¼šåœ¨åˆå§‹åŒ–é˜¶æ®µåˆå§‹åŒ–ï¼Œå³ä½¿è¯¥æˆå‘˜æ²¡æœ‰å‡ºç°åœ¨æ„é€ å‡½æ•°çš„åˆå§‹åŒ–åˆ—è¡¨ä¸­ã€‚ è®¡ç®—é˜¶æ®µï¼šä¸€èˆ¬ç”¨äºæ‰§è¡Œæ„é€ å‡½æ•°ä½“å†…çš„èµ‹å€¼æ“ä½œã€‚ æ‰€ä»¥ï¼Œåˆå§‹åŒ–åˆ—è¡¨æ€»æ˜¯å…ˆäºæ„é€ å‡½æ•°ä½“æ‰§è¡Œï¼šåŸºç±»åˆå§‹åŒ–åˆ—è¡¨ â†’ åŸºç±»çš„æ„é€ å‡½æ•° â†’ æ´¾ç”Ÿç±»åˆå§‹åŒ–åˆ—è¡¨ â†’ æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°ã€‚\næˆå‘˜å˜é‡åˆå§‹åŒ–é¡ºåº æˆå‘˜æ˜¯æŒ‰ç…§ä»–ä»¬åœ¨ç±»ä¸­å‡ºç°çš„é¡ºåºè¿›è¡Œåˆå§‹åŒ–çš„ï¼Œè€Œä¸æ˜¯æŒ‰ç…§ä»–ä»¬åœ¨åˆå§‹åŒ–åˆ—è¡¨å‡ºç°çš„é¡ºåºåˆå§‹åŒ–çš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 class A { private: int n1; int n2; public: A(): n2(0), n1(n2+1) {} void Print(){ cout \u0026lt;\u0026lt; \u0026#34;n1: \u0026#34; \u0026lt;\u0026lt; n1 \u0026lt;\u0026lt; \u0026#34;, n2: \u0026#34; \u0026lt;\u0026lt; n2 \u0026lt;\u0026lt;endl; } }; int main() { A a; a.Print(); // è¾“å‡ºæ˜¯ï¼š`n1: 18749281, n2: 0`ï¼Œè€Œä¸æ˜¯`n1: 1, n2: 0` return 0; } constå’Œconstexpr constexprå…³é”®å­—æ˜¯C++11æ–°å¢çš„ï¼Œå…¶ä½œç”¨åŒ…æ‹¬ï¼š\nå®šä¹‰ç¼–è¯‘æœŸå¸¸é‡[ç¼–è¯‘æœŸå¸¸é‡]ï¼› å®šä¹‰å¸¸é‡è¡¨è¾¾å¼å‡½æ•°[å¸¸é‡è¡¨è¾¾å¼å‡½æ•°]ï¼› å®šä¹‰ç¼–è¯‘æœŸå¸¸é‡å¯¹è±¡[ç¼–è¯‘æœŸå¸¸é‡å¯¹è±¡]ã€‚ å¸¸é‡åˆ†ä¸ºç¼–è¯‘æœŸå¸¸é‡ã€è¿è¡ŒæœŸå¸¸é‡ã€‚ ç¼–è¯‘æœŸå¸¸é‡åœ¨ç¼–è¯‘é˜¶æ®µå°±å¯ä»¥ç¡®å®šå…¶å€¼ï¼Œå¹¶å°†å…¶ç»“æœå±•å¼€åˆ°ä½¿ç”¨çš„åœ°æ–¹ï¼Œä¸€èˆ¬å­˜æ”¾åœ¨rodataæ®µã€‚ è¿è¡ŒæœŸå¸¸é‡æœ¬è´¨ä¸Šæ˜¯åªè¯»çš„å˜é‡ï¼ˆå­˜æ”¾åœ¨æ ˆåŒºï¼‰ï¼Œç¼–è¯‘æ—¶æ— æ³•ç¡®å®šå…¶å€¼ï¼›è¿è¡Œæ—¶ï¼Œæ— æ³•ä¿®æ”¹å…¶å€¼ã€‚\nconst å¯ä»¥å®šä¹‰ç¼–è¯‘æœŸå¸¸é‡ï¼Œä¹Ÿå¯ä»¥å®šä¹‰è¿è¡ŒæœŸå¸¸é‡ï¼› constexpr åªèƒ½å®šä¹‰ç¼–è¯‘æœŸå¸¸é‡ã€‚ 1 2 3 4 5 6 7 const int a = 10; // ç¼–è¯‘æœŸå¸¸é‡ï¼Œå­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒºçš„rodataæ®µ int main() { int b = 20; // æ ˆ const int c = b; // æ ˆï¼ˆè¿è¡ŒæœŸå¸¸é‡ï¼‰ // constexpr int c = b; Error: å› ä¸ºbæ˜¯ä¸€ä¸ªæ™®é€šå˜é‡ï¼Œå¿…é¡»åˆ°è¿è¡ŒæœŸæ‰èƒ½ç¡®å®šï¼Œconstexpræ— æ³•ä¿®é¥°è¿è¡ŒæœŸå¸¸é‡ã€‚ } æ™®é€šå‡½æ•°å¿…é¡»åœ¨è¿è¡Œæ—¶æ‰èƒ½æ‰§è¡Œï¼Œè¿›è€Œè®¡ç®—å‡ºç»“æœã€‚è€Œå¸¸é‡è¡¨è¾¾å¼å‡½æ•°è¦æ±‚å‡½æ•°åœ¨ç¼–è¯‘æœŸå°±è®¡ç®—å‡ºç»“æœï¼Œè¿è¡Œæ—¶ç›´æ¥ä½¿ç”¨ç»“æœã€‚ä¹Ÿå°±æ˜¯è¯´å°†å‡½æ•°çš„æ‰§è¡Œä»è¿è¡Œé˜¶æ®µè½¬ç§»åˆ°ç¼–è¯‘é˜¶æ®µï¼Œæå‡ç¨‹åºè¿è¡Œæ•ˆç‡ã€‚ åªéœ€è¦åœ¨å‡½æ•°è¿”å›å€¼ç±»å‹å‰é¢åŠ ä¸Šconstexprå…³é”®å­—å³å¯å®šä¹‰å¸¸é‡è¡¨è¾¾å¼å‡½æ•°ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨constexprä¿®é¥°çš„ç¼–è¯‘æœŸå¸¸é‡æ¥ä¿å­˜å¸¸é‡è¡¨è¾¾å¼å‡½æ•°çš„ç»“æœï¼Œå¦åˆ™å¸¸é‡è¡¨è¾¾å¼å‡½æ•°ä»ç„¶ä¼šåœ¨è¿è¡ŒæœŸæ‰§è¡Œã€‚\n1 2 3 4 5 6 7 8 constexpr int my_sum(int n) { if (n == 1) return 1; return n + my_sum(n - 1); } void test() { constexpr int a = my_sum(3); } ç¼–è¯‘æœŸå¸¸é‡å¯¹è±¡çš„ä»»ä½•è®¡ç®—éƒ½åœ¨ç¼–è¯‘æœŸå®Œæˆã€‚å®šä¹‰ç¼–è¯‘æœŸå¸¸é‡å¯¹è±¡ï¼Œæœ‰ä»¥ä¸‹å‡ ç‚¹è¦æ±‚ï¼š\næ„é€ å‡½æ•°ä½¿ç”¨constexprä¿®é¥°ï¼Œå¿…é¡»ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨å¯¹æˆå‘˜è¿›è¡Œåˆå§‹åŒ–ï¼› å¯¹è±¡è°ƒç”¨çš„æˆå‘˜å‡½æ•°å¿…é¡»ä½¿ç”¨constexprä¿®é¥°ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 class Box { public: // æ„é€ å‡½æ•°ä½¿ç”¨constexpträ¿®é¥°ï¼Œå¹¶ä¸”ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨å¯¹æˆå‘˜è¿›è¡Œåˆå§‹åŒ–ã€‚è¿™å°±ä¿è¯äº†å¯¹è±¡æˆå‘˜m_lã€m_wã€m_håœ¨ç¼–è¯‘æœŸç¡®å®šå…¶å€¼ã€‚ constexpr Box(int l, int w, int h) : m_l(l), m_w(w), m_h(h) {} // get_volumeå‡½æ•°è¢«å®šä¹‰ä¸ºäº†å¸¸é‡è¡¨è¾¾å¼æˆå‘˜å‡½æ•°ï¼Œè°ƒç”¨è¯¥å‡½æ•°åˆ™ä¼šåœ¨ç¼–è¯‘é˜¶æ®µè®¡ç®—å‡ºç»“æœã€‚ constexpr int get_volume() const { return m_l * m_w * m_h; } // get_sumå‡½æ•°åˆ™æ˜¯æ™®é€šå‡½æ•°ï¼Œè¯¥å‡½æ•°å¿…é¡»å£°æ˜ä¸ºconstå‡½æ•°ï¼Œå¦åˆ™æ— æ³•è¢«å¸¸é‡å¯¹è±¡è°ƒç”¨ int get_sum() const { return (m_l + m_w + m_h); } public: int m_l, m_w, m_h; }; void test() { constexpr Box box(10, 20, 30); // ç¨‹åºç¼–è¯‘æœŸé—´è°ƒç”¨å¸¸é‡è¡¨è¾¾å¼æ„é€ å‡½æ•° constexpr int volume = box.get_volume(); // åœ¨ç¼–è¯‘æœŸè®¡ç®—å‡ºå‡½æ•°çš„æ‰§è¡Œç»“æœï¼Œå¹¶èµ‹å€¼ç»™ç¼–è¯‘æœŸå¸¸é‡volume int my_sum = box.get_sum(); // åœ¨è¿è¡ŒæœŸè¿›è¡Œæ‰§è¡Œ } å•ä¾‹æ¨¡å¼ å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå®ƒç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹æ¥è®¿é—®å®ƒã€‚ å•ä¾‹æ¨¡å¼çš„å®ç°ä¸€èˆ¬éœ€è¦å°†æ„é€ å‡½æ•°ã€ææ„å‡½æ•°ç§æœ‰åŒ–ï¼Œç¦ç”¨æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ï¼Œå°†æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°éƒ½è®¾ç½®æˆé™æ€ç±»å‹ã€‚\næ‡’æ±‰å•ä¾‹æ¨¡å¼å®ç° æœ€ç®€å•çš„æ‡’æ±‰æ¨¡å¼ï¼ˆåœ¨å…¨å±€è®¿é—®å…¥å£ä¸­å£°æ˜é™æ€å˜é‡ã€‚å±€éƒ¨é™æ€å˜é‡åœ¨C++11åä¹Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 class Singleton { private: Singleton(); ~Singleton(); Singleton(const Singleton\u0026amp;) = delete; Singleton\u0026amp; operator=(const Singleton\u0026amp;) = delete; public: static Singleton* getInstance() { static Singleton instance; return \u0026amp;instance; } }; åŠ é”ç‰ˆæœ¬çš„æ‡’æ±‰å•ä¾‹æ¨¡å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 class Singleton { private: Singleton(); ~Singleton(); Singleton(const Singleton\u0026amp;) = delete; Singleton\u0026amp; operator=(const Singleton\u0026amp;) = delete; static Singleton* instance; static pthread_mutex_t mutex; public: static Singleton* getInstance() { if (instance == nullptr) { pthread_mutex_lock(\u0026amp;mutex); instance = new Singleton(); pthread_mutex_unlock(\u0026amp;mutex); } return instance; } }; Singleton* Singleton::instance = nullptr; pthread_mutex_t Singleton::mutex = PTHREAD_MUTEX_INITIALIZER; é¥¿æ±‰å•ä¾‹æ¨¡å¼å®ç° é¥¿æ±‰å•ä¾‹æ¨¡å¼å¤©ç”Ÿçº¿ç¨‹å®‰å…¨ï¼Œå› ä¸ºåœ¨mainå‡½æ•°å‰å·²ç»åˆå§‹åŒ–\n1 2 3 4 5 6 7 8 9 10 11 12 13 class Singleton { private: Singleton(); ~Singleton(); Singleton(const Singleton\u0026amp;) = delete; Singleton\u0026amp; operator=(const Singleton\u0026amp;) = delete; static Singleton* instance; public: static Singleton* getInstance() { return instance; } }; Singleton* Singleton::instance = new Singleton(); ","permalink":"https://kdjlyy.cn/posts/tech/cs-basic-grammar/","summary":"æˆå‘˜å˜é‡åˆå§‹åŒ– æ„é€ å‡½æ•°å†…éƒ¨åˆå§‹åŒ–å’Œåˆå§‹åŒ–åˆ—è¡¨ åˆå§‹åŒ–ç±»çš„æˆå‘˜æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€æ˜¯ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ï¼ŒäºŒæ˜¯åœ¨æ„é€ å‡½æ•°ä½“å†…è¿›è¡Œèµ‹å€¼æ“ä½œã€‚ å¯¹äºå†…ç½®ç±»å‹ï¼Œå¦‚int, floatç­‰ï¼Œä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨å’Œåœ¨æ„","title":"è®¡ç®—æœºåŸºç¡€çŸ¥è¯†æ€»ç»“ï¼ˆè¯­æ³•ç¯‡ï¼‰"}]